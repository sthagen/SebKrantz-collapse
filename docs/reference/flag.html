<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fast Lags and Leads for Time Series and Panel Data — flag • collapse</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fast Lags and Leads for Time Series and Panel Data — flag"><meta property="og:description" content="flag is an S3 generic to compute (sequences of) lags and leads. L and F are wrappers around flag representing the lag- and lead-operators, such that L(x,-1) = F(x,1) = F(x) and L(x,-3:3) = F(x,3:-3). L and F provide more flexibility than flag when applied to data frames (i.e.  column subsetting, formula input and id-variable-preservation capabilities...), but are otherwise identical.
(flag is more of a programmers function in style of the Fast Statistical Functions while L and F are more practical to use in regression formulas or for computations on data frames.)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" class="external-link">Blog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/collapse_R" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast Lags and Leads for Time Series and Panel Data</h1>
    
    <div class="hidden name"><code>flag.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>flag</code> is an S3 generic to compute (sequences of) lags and leads. <code>L</code> and <code>F</code> are wrappers around <code>flag</code> representing the lag- and lead-operators, such that <code>L(x,-1) = F(x,1) = F(x)</code> and <code>L(x,-3:3) = F(x,3:-3)</code>. <code>L</code> and <code>F</code> provide more flexibility than <code>flag</code> when applied to data frames (i.e.  column subsetting, formula input and id-variable-preservation capabilities...), but are otherwise identical.</p>
<p>(<code>flag</code> is more of a programmers function in style of the <a href="fast-statistical-functions.html">Fast Statistical Functions</a> while <code>L</code> and <code>F</code> are more practical to use in regression formulas or for computations on data frames.)</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">flag</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>
   <span class="fu">L</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>
   <span class="fu">F</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">flag</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, g <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for default</span>
<span class="fu">L</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, g <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for default</span>
<span class="fu">F</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, g <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for matrix</span>
<span class="fu">flag</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, g <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1L</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for matrix</span>
<span class="fu">L</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, g <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for matrix</span>
<span class="fu">F</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, g <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for data.frame</span>
<span class="fu">flag</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, g <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1L</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for data.frame</span>
<span class="fu">L</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, cols <span class="op">=</span> <span class="va">is.numeric</span>,
  fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, keep.ids <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for data.frame</span>
<span class="fu">F</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="cn">NULL</span>, t <span class="op">=</span> <span class="cn">NULL</span>, cols <span class="op">=</span> <span class="va">is.numeric</span>,
  fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, keep.ids <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># Methods for compatibility with plm:</span>

<span class="co"># S3 method for pseries</span>
<span class="fu">flag</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for pseries</span>
<span class="fu">L</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for pseries</span>
<span class="fu">F</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for pdata.frame</span>
<span class="fu">flag</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1L</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for pdata.frame</span>
<span class="fu">L</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="va">is.numeric</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>,
  keep.ids <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for pdata.frame</span>
<span class="fu">F</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="va">is.numeric</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>,
  keep.ids <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># Methods for grouped data frame / compatibility with dplyr:</span>

<span class="co"># S3 method for grouped_df</span>
<span class="fu">flag</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1L</span>, keep.ids <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for grouped_df</span>
<span class="fu">L</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, keep.ids <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for grouped_df</span>
<span class="fu">F</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span>, t <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NA</span>, stubs <span class="op">=</span> <span class="cn">TRUE</span>, keep.ids <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a vector / time series, (time series) matrix, data frame, panel series (<code><a href="https://rdrr.io/pkg/plm/man/pseries.html" class="external-link">plm::pseries</a></code>), panel data frame (<code><a href="https://rdrr.io/pkg/plm/man/pdata.frame.html" class="external-link">plm::pdata.frame</a></code>) or grouped data frame (class 'grouped_df'). Data must not be numeric i.e you can also lag a date variable, character data etc...</p></dd>
<dt>n</dt>
<dd><p>integer. A vector indicating the lags / leads to compute (passing negative integers to <code>flag</code> or <code>L</code> computes leads, passing negative integers to <code>F</code> computes lags).</p></dd>
<dt>g</dt>
<dd><p>a factor, <code><a href="GRP.html">GRP</a></code> object, atomic vector (internally converted to factor) or a list of vectors / factors (internally converted to a <code><a href="GRP.html">GRP</a></code> object) used to group <code>x</code>.</p></dd>
<dt>by</dt>
<dd><p><em>data.frame method</em>: Same as <code>g</code>, but also allows one- or two-sided formulas i.e. <code>~ group1</code> or <code>var1 + var2 ~ group1 + group2</code>. See Examples.</p></dd>
<dt>t</dt>
<dd><p>same input as <code>g/by</code>, to indicate the time-variable(s). For safe computation of differences on unordered time series and panels. Data Frame method also allows one-sided formula i.e. <code>~time</code>. grouped_df method supports lazy-evaluation i.e. <code>time</code> (no quotes).</p></dd>
<dt>cols</dt>
<dd><p><em>data.frame method</em>: Select columns to difference using a function, column names, indices or a logical vector. Default: All numeric variables. <em>Note</em>: <code>cols</code> is ignored if a two-sided formula is passed to <code>by</code>.</p></dd>
<dt>fill</dt>
<dd><p>value to insert when vectors are shifted. Default is <code>NA</code>.</p></dd>
<dt>stubs</dt>
<dd><p>logical. <code>TRUE</code> will rename all lagged / leaded columns by adding a stub or prefix "L<code>n</code>." / "F<code>n</code>.".</p></dd>
<dt>keep.ids</dt>
<dd><p><em>data.frame / pdata.frame / grouped_df methods</em>: Logical. Drop all panel-identifiers from the output (which includes all variables passed to <code>by</code> or <code>t</code>). <em>Note</em>: For grouped / panel data frames identifiers are dropped, but the 'groups' / 'index' attributes are kept.</p></dd>
<dt>...</dt>
<dd><p>arguments to be passed to or from other methods.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If a single integer is passed to <code>n</code>, and <code>g/by</code> and <code>t</code> are left empty, <code>flag/L/F</code> just returns <code>x</code> with all columns lagged / leaded by <code>n</code>. If <code>length(n)&gt;1</code>, and <code>x</code> is an atomic vector (time series), <code>flag/L/F</code> returns a (time series) matrix with lags / leads computed in the same order as passed to <code>n</code>. If instead <code>x</code> is a matrix / data frame, a matrix / data frame with <code>ncol(x)*length(n)</code> columns is returned where columns are sorted first by variable and then by lag (so all lags computed on a variable are grouped together). <code>x</code> can be of any standard data type.</p>
<p>With groups/panel-identifiers supplied to <code>g/by</code>, <code>flag/L/F</code> efficiently computes a panel-lag/lead by shifting the entire vector(s) but inserting <code>fill</code> elements in the right places. If <code>t</code> is left empty, the data needs to be ordered such that all values belonging to a group are consecutive and in the right order. It is not necessary that the groups themselves occur in the right order. If a time-variable is supplied to <code>t</code> (or a list of time-variables uniquely identifying the time-dimension), the panel is fully identified and lags / leads can be securely computed even if the data is unordered.</p>
<p>It is also possible to lag unordered or irregular time series utilizing only the <code>t</code> argument to identify the temporal dimension of the data.</p>
<p>Since v1.5.0 <code>flag/L/F</code> provide full built-in support for irregular time series and unbalanced panels. The suggested workaround using the <code><a href="seqid.html">seqid</a></code> function is therefore no longer necessary.
<!-- %\code{flag/L/F} supports balanced panels and unbalanced panels where various individuals are observed for different time-sequences (both start, end and duration of observation can differ for each individual). \code{flag/L/F} does not natively support irregularly spaced time series and panels, that is situations where there are either gaps in time and/or repeated observations in the same time-period for some individual (see also computational details below). For such cases the function \code{\link{seqid}} can be used to generate an appropriate panel-identifier (i.e. splitting individuals with an irregular time-sequence into multiple individuals with regular time-sequences before applying \code{flag/L/F}). --></p>
<p><!-- %(in that case data is shifted around and \code{fill} values are inserted in such a way that if the data were sorted afterwards the result would be identical to computing lags / leads on sorted data). Internally this works by using the grouping- and time-variable(s) to create an ordering and then accessing the panel-vector(s) through this ordering. If the data is just a bit unordered, such computations are nearly as fast as computations on ordered data (without \code{t}), however, if the data is very unordered, it can take significantly longer. Since most panel data come perfectly or pretty ordered, I recommend always supplying \code{t} to be on the safe-side. --></p>
<p><!-- % It is also possible to compute lags / leads on unordered time series (thus utilizing \code{t} but leaving \code{g/by} empty), although this is probably more rare to encounter than unordered panels. Irregularly spaced time series can also be lagged using a panel- identifier generated with \code{\link{seqid}}. --></p>
<p>Computationally, if both <code>g/by</code> and <code>t</code> are supplied, <code>flag/L/F</code> uses two initial passes to create an ordering through which the data are accessed. First-pass: Calculate minimum and maximum time-value for each individual. Second-pass: Generate the ordering by placing the current element index into the vector slot obtained by adding the cumulative group size and the current time-value subtracted its individual-minimum together. This method of computation is faster than any sort-based method and delivers optimal performance if the panel-id supplied to <code>g/by</code> is already a factor variable, and if <code>t</code> is either an integer or factor variable. If <code>t</code> is not factor or integer but instead <code>is.double(t) &amp;&amp; !is.object(t)</code>, it is assumed to be integer represented by double and converted using <code>as.integer(t)</code>. For other objects such as dates, <code>t</code> is grouped using <code><a href="qF.html">qG</a></code> or <code><a href="GRP.html">GRP</a></code> (for multiple time identifiers). Similarly, if <code>g/by</code> is not factor or 'GRP' object, <code><a href="qF.html">qG</a></code> or <code><a href="GRP.html">GRP</a></code> will be called to group the respective identifier. Since grouping is more expensive than computing lags, prepare the data for optimal performance (or use <em>plm</em> classes). See also the Note.</p>
<p><!-- %A caveat of not using sort-based methods is that gaps or repeated values in time are only recognized towards the end of the second pass where they cannot be rectified anymore, and thus \code{flag/L/F} does not natively support irregular panels but throws an error. --></p>

<p>The methods applying to <em>plm</em> objects (panel series and panel data frames) automatically utilize the factor panel-identifiers attached to these objects and thus securely and efficiently compute fully identified panel-lags. If these objects have &gt; 2 panel-identifiers attached to them, the last identifier is assumed to be the time-variable, and the others are taken as grouping-variables and interacted. Note that <code>flag/L/F</code> is significantly faster than <code>plm::lag/plm::lead</code> since the latter is written in R and based on a Split-Apply-Combine logic.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>x</code> lagged / leaded <code>n</code>-times, grouped by <code>g/by</code>, ordered by <code>t</code>. See Details and Examples.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Since v1.7.0, if <code>is.double(t) &amp;&amp; !is.object(t)</code>, it is coerced to integer using <code>as.integer(t)</code>. This is to avoid the inefficiency of ordered grouping, and owes to the fact that in most data imported into R, the time (year) variables are coded as double although they should be integer.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="fdiff.html">fdiff</a></code>, <code><a href="fgrowth.html">fgrowth</a></code>, <a href="time-series-panel-series.html">Time Series and Panel Series</a>, <a href="index.html">Collapse Overview</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## Simple Time Series: AirPassengers</span></span>
<span class="r-in"><span class="fu">L</span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span>                      <span class="co"># 1 lag</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1949  NA 112 118 132 129 121 135 148 148 136 119 104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1950 118 115 126 141 135 125 149 170 170 158 133 114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1951 140 145 150 178 163 172 178 199 199 184 162 146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1952 166 171 180 193 181 183 218 230 242 209 191 172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1953 194 196 196 236 235 229 243 264 272 237 211 180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1954 201 204 188 235 227 234 264 302 293 259 229 203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1955 229 242 233 267 269 270 315 364 347 312 274 237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1956 278 284 277 317 313 318 374 413 405 355 306 271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1957 306 315 301 356 348 355 422 465 467 404 347 305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1958 336 340 318 362 348 363 435 491 505 404 359 310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1959 337 360 342 406 396 420 472 548 559 463 407 362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1960 405 417 391 419 461 472 535 622 606 508 461 390</span>
<span class="r-in"><span class="fu">F</span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span>                      <span class="co"># 1 lead</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1949 118 132 129 121 135 148 148 136 119 104 118 115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1950 126 141 135 125 149 170 170 158 133 114 140 145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1951 150 178 163 172 178 199 199 184 162 146 166 171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1952 180 193 181 183 218 230 242 209 191 172 194 196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1953 196 236 235 229 243 264 272 237 211 180 201 204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1954 188 235 227 234 264 302 293 259 229 203 229 242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1955 233 267 269 270 315 364 347 312 274 237 278 284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1956 277 317 313 318 374 413 405 355 306 271 306 315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1957 301 356 348 355 422 465 467 404 347 305 336 340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1958 318 362 348 363 435 491 505 404 359 310 337 360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1959 342 406 396 420 472 548 559 463 407 362 405 417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1960 391 419 461 472 535 622 606 508 461 390 432  NA</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="small-helper.html">all_identical</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span>,       <span class="co"># 3 identical ways of computing 1 lag</span></span>
<span class="r-in">              <span class="fu">flag</span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span>,</span>
<span class="r-in">              <span class="fu">F</span><span class="op">(</span><span class="va">AirPassengers</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">AirPassengers</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>          <span class="co"># 1 lead and 3 lags - output as matrix</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       F1  --  L1  L2  L3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 118 112  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 132 118 112  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 129 132 118 112  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 121 129 132 118 112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 135 121 129 132 118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 148 135 121 129 132</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Time Series Matrix of 4 EU Stock Market Indicators, 1991-1998</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/tsp.html" class="external-link">tsp</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span>                                     <span class="co"># Data is recorded on 260 days per year</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1991.496 1998.646  260.000</span>
<span class="r-in"><span class="va">freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">frequency</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/stl.html" class="external-link">stl</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">[</span>,<span class="st">"DAX"</span><span class="op">]</span>, <span class="va">freq</span><span class="op">)</span><span class="op">)</span>                 <span class="co"># There is some obvious seasonality</span></span>
<span class="r-plt img"><img src="flag-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">EuStockMarkets</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span> <span class="op">*</span> <span class="va">freq</span><span class="op">)</span><span class="op">)</span>                    <span class="co"># 1 annual lead and 3 annual lags</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      F260.DAX     DAX L260.DAX L520.DAX L780.DAX F260.SMI    SMI L260.SMI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1755.98 1628.75       NA       NA       NA   1846.6 1678.1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  1754.95 1613.63       NA       NA       NA   1854.8 1688.5       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  1759.90 1606.51       NA       NA       NA   1845.3 1678.6       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  1759.84 1621.04       NA       NA       NA   1854.5 1684.1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  1776.50 1618.16       NA       NA       NA   1870.5 1686.6       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  1769.98 1610.61       NA       NA       NA   1862.6 1671.6       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      L520.SMI L780.SMI F260.CAC    CAC L260.CAC L520.CAC L780.CAC F260.FTSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       NA       NA   1907.3 1772.8       NA       NA       NA    2515.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       NA       NA   1900.6 1750.5       NA       NA       NA    2521.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       NA       NA   1880.9 1718.0       NA       NA       NA    2493.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]       NA       NA   1873.5 1708.1       NA       NA       NA    2476.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]       NA       NA   1883.6 1723.1       NA       NA       NA    2497.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]       NA       NA   1868.5 1714.3       NA       NA       NA    2469.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        FTSE L260.FTSE L520.FTSE L780.FTSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2443.6        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2460.2        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 2448.2        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 2470.4        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 2484.7        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 2466.8        NA        NA        NA</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">DAX</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="fu">L</span><span class="op">(</span><span class="va">EuStockMarkets</span>,<span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">*</span><span class="va">freq</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># DAX regressed on it's own annual lead,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = DAX ~ ., data = L(EuStockMarkets, -1:3 * freq))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -158.092  -30.174    1.355   28.741  211.844 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -1.030e+03  1.016e+02 -10.141  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F260.DAX     1.037e-01  2.621e-02   3.957 8.25e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L260.DAX    -3.544e-01  4.394e-02  -8.066 2.65e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L520.DAX    -2.232e-01  4.116e-02  -5.423 7.75e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L780.DAX     9.451e-02  4.484e-02   2.107 0.035391 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F260.SMI     4.968e-02  1.554e-02   3.198 0.001441 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SMI          2.616e-01  2.301e-02  11.366  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L260.SMI     6.138e-02  2.740e-02   2.240 0.025342 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L520.SMI    -2.153e-01  2.707e-02  -7.954 6.15e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L780.SMI    -2.208e-01  3.091e-02  -7.144 2.04e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F260.CAC    -1.392e-01  3.583e-02  -3.884 0.000111 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CAC          7.165e-01  3.189e-02  22.470  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L260.CAC    -5.482e-02  3.874e-02  -1.415 0.157455    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L520.CAC     2.326e-01  4.570e-02   5.090 4.46e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L780.CAC    -7.636e-02  3.966e-02  -1.925 0.054583 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F260.FTSE   -9.505e-02  2.174e-02  -4.372 1.39e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FTSE         3.158e-01  3.103e-02  10.176  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L260.FTSE    1.745e-01  3.104e-02   5.621 2.63e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L520.FTSE    2.809e-01  3.381e-02   8.308 4.14e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L780.FTSE    1.535e-01  3.014e-02   5.092 4.42e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 49.64 on 800 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (1040 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9926,	Adjusted R-squared:  0.9925 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic:  5668 on 19 and 800 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">                                                        <span class="co"># lags and the lead/lags of the other series</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## World Development Panel Data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">flag</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">1</span>, <span class="va">wlddev</span><span class="op">$</span><span class="va">iso3c</span>, <span class="va">wlddev</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>        <span class="co"># This lags all variables,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date year decade     region     income  OECD PCGDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;   NA     NA       &lt;NA&gt;       &lt;NA&gt;    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 1963-01-01 1962   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 1964-01-01 1963   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   AFG 1965-01-01 1964   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   LIFEEX GINI       ODA     POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     NA   NA        NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 32.446   NA 116769997 8996973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 32.962   NA 232080002 9169410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 33.471   NA 112839996 9351441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 33.971   NA 237720001 9543205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 34.463   NA 295920013 9744781</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">1</span>, <span class="op">~</span><span class="va">iso3c</span>, <span class="op">~</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>                       <span class="co"># This lags all numeric variables</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iso3c year L1.decade L1.PCGDP L1.LIFEEX L1.GINI    L1.ODA  L1.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   AFG 1960        NA       NA        NA      NA        NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   AFG 1961      1960       NA    32.446      NA 116769997 8996973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   AFG 1962      1960       NA    32.962      NA 232080002 9169410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   AFG 1963      1960       NA    33.471      NA 112839996 9351441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   AFG 1964      1960       NA    33.971      NA 237720001 9543205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   AFG 1965      1960       NA    34.463      NA 295920013 9744781</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">1</span>, <span class="op">~</span><span class="va">iso3c</span><span class="op">)</span><span class="op">)</span>                              <span class="co"># Without t: Works because data is ordered</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iso3c L1.year L1.decade L1.PCGDP L1.LIFEEX L1.GINI    L1.ODA  L1.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   AFG      NA        NA       NA        NA      NA        NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   AFG    1960      1960       NA    32.446      NA 116769997 8996973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   AFG    1961      1960       NA    32.962      NA 232080002 9169410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   AFG    1962      1960       NA    33.471      NA 112839996 9351441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   AFG    1963      1960       NA    33.971      NA 237720001 9543205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   AFG    1964      1960       NA    34.463      NA 295920013 9744781</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">1</span>, <span class="va">PCGDP</span> <span class="op">+</span> <span class="va">LIFEEX</span> <span class="op">~</span> <span class="va">iso3c</span>, <span class="op">~</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>       <span class="co"># This lags GDP per Capita &amp; Life Expectancy</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iso3c year L1.PCGDP L1.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   AFG 1960       NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   AFG 1961       NA    32.446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   AFG 1962       NA    32.962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   AFG 1963       NA    33.471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   AFG 1964       NA    33.971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   AFG 1965       NA    34.463</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="op">~</span> <span class="va">iso3c</span>, <span class="op">~</span><span class="va">year</span>, cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Same, also retaining original series</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iso3c year PCGDP L1.PCGDP L2.PCGDP LIFEEX L1.LIFEEX L2.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   AFG 1960    NA       NA       NA 32.446        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   AFG 1961    NA       NA       NA 32.962    32.446        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   AFG 1962    NA       NA       NA 33.471    32.962    32.446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   AFG 1963    NA       NA       NA 33.971    33.471    32.962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   AFG 1964    NA       NA       NA 34.463    33.971    33.471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   AFG 1965    NA       NA       NA 34.948    34.463    33.971</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">PCGDP</span> <span class="op">+</span> <span class="va">LIFEEX</span> <span class="op">~</span> <span class="va">iso3c</span>, <span class="op">~</span><span class="va">year</span>,      <span class="co"># Two lags, dropping id columns</span></span>
<span class="r-in">       keep.ids <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L1.PCGDP L2.PCGDP L1.LIFEEX L2.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       NA       NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       NA       NA    32.446        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       NA       NA    32.962    32.446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       NA       NA    33.471    32.962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       NA       NA    33.971    33.471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       NA       NA    34.463    33.971</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Different ways of regressing GDP on its's lags and life-Expectancy and it's lags</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">PCGDP</span> <span class="op">~</span> <span class="va">.</span>, <span class="fu">L</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="op">~</span><span class="va">iso3c</span>, <span class="op">~</span><span class="va">year</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">10</span>, keep.ids <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>     <span class="co"># 1 - Precomputing</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = PCGDP ~ ., data = L(wlddev, 0:2, ~iso3c, ~year, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     9:10, keep.ids = FALSE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -16776.5   -102.2    -17.2     91.5  12277.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -333.93994   61.04617  -5.470 4.62e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L1.PCGDP       1.31959    0.01021 129.270  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L2.PCGDP      -0.31707    0.01029 -30.815  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LIFEEX       -17.77368   35.47772  -0.501    0.616    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L1.LIFEEX     45.76286   65.87124   0.695    0.487    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L2.LIFEEX    -21.43005   34.98964  -0.612    0.540    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 787.3 on 8609 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (4561 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9976,	Adjusted R-squared:  0.9976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 7.26e+05 on 5 and 8609 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">PCGDP</span> <span class="op">~</span> <span class="fu">L</span><span class="op">(</span><span class="va">PCGDP</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">iso3c</span>,<span class="va">year</span><span class="op">)</span> <span class="op">+</span> <span class="fu">L</span><span class="op">(</span><span class="va">LIFEEX</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">2</span>,<span class="va">iso3c</span>,<span class="va">year</span><span class="op">)</span>, <span class="va">wlddev</span><span class="op">)</span><span class="op">)</span>   <span class="co"># 2 - Ad-hoc</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = PCGDP ~ L(PCGDP, 1:2, iso3c, year) + L(LIFEEX, 0:2, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     iso3c, year), data = wlddev)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -16776.5   -102.2    -17.2     91.5  12277.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                   -333.93994   61.04617  -5.470 4.62e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2, iso3c, year)L1     1.31959    0.01021 129.270  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2, iso3c, year)L2    -0.31707    0.01029 -30.815  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, iso3c, year)--  -17.77368   35.47772  -0.501    0.616    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, iso3c, year)L1   45.76286   65.87124   0.695    0.487    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, iso3c, year)L2  -21.43005   34.98964  -0.612    0.540    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 787.3 on 8609 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (4561 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9976,	Adjusted R-squared:  0.9976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 7.26e+05 on 5 and 8609 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">PCGDP</span> <span class="op">~</span> <span class="fu">L</span><span class="op">(</span><span class="va">PCGDP</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">iso3c</span><span class="op">)</span> <span class="op">+</span> <span class="fu">L</span><span class="op">(</span><span class="va">LIFEEX</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">2</span>,<span class="va">iso3c</span><span class="op">)</span>, <span class="va">wlddev</span><span class="op">)</span><span class="op">)</span>             <span class="co"># 3 - same no year</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = PCGDP ~ L(PCGDP, 1:2, iso3c) + L(LIFEEX, 0:2, iso3c), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = wlddev)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -16776.5   -102.2    -17.2     91.5  12277.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)             -333.93994   61.04617  -5.470 4.62e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2, iso3c)L1     1.31959    0.01021 129.270  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2, iso3c)L2    -0.31707    0.01029 -30.815  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, iso3c)--  -17.77368   35.47772  -0.501    0.616    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, iso3c)L1   45.76286   65.87124   0.695    0.487    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, iso3c)L2  -21.43005   34.98964  -0.612    0.540    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 787.3 on 8609 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (4561 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9976,	Adjusted R-squared:  0.9976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 7.26e+05 on 5 and 8609 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="qF.html">qF</a></span><span class="op">(</span><span class="va">wlddev</span><span class="op">$</span><span class="va">iso3c</span><span class="op">)</span>; <span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="qF.html">qF</a></span><span class="op">(</span><span class="va">wlddev</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>                                         <span class="co"># 4- Precomputing</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">PCGDP</span> <span class="op">~</span> <span class="fu">L</span><span class="op">(</span><span class="va">PCGDP</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">g</span>,<span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fu">L</span><span class="op">(</span><span class="va">LIFEEX</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">2</span>,<span class="va">g</span>,<span class="va">t</span><span class="op">)</span>, <span class="va">wlddev</span><span class="op">)</span><span class="op">)</span>                 <span class="co"># panel-id's</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = PCGDP ~ L(PCGDP, 1:2, g, t) + L(LIFEEX, 0:2, g, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     t), data = wlddev)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -16776.5   -102.2    -17.2     91.5  12277.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)            -333.93994   61.04617  -5.470 4.62e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2, g, t)L1     1.31959    0.01021 129.270  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2, g, t)L2    -0.31707    0.01029 -30.815  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, g, t)--  -17.77368   35.47772  -0.501    0.616    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, g, t)L1   45.76286   65.87124   0.695    0.487    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2, g, t)L2  -21.43005   34.98964  -0.612    0.540    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 787.3 on 8609 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (4561 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9976,	Adjusted R-squared:  0.9976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 7.26e+05 on 5 and 8609 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"> </span>
<span class="r-in"><span class="co">## Using plm:</span></span>
<span class="r-in"><span class="va">pwlddev</span> <span class="op">&lt;-</span> <span class="fu">plm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pdata.frame.html" class="external-link">pdata.frame</a></span><span class="op">(</span><span class="va">wlddev</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iso3c"</span>,<span class="st">"year"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">pwlddev</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>                                     <span class="co"># Again 2 lags of GDP and LIFEEX</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          iso3c year PCGDP L1.PCGDP L2.PCGDP LIFEEX L1.LIFEEX L2.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1960   ABW 1960    NA       NA       NA 65.662        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1961   ABW 1961    NA       NA       NA 66.074    65.662        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1962   ABW 1962    NA       NA       NA 66.444    66.074    65.662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1963   ABW 1963    NA       NA       NA 66.787    66.444    66.074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1964   ABW 1964    NA       NA       NA 67.113    66.787    66.444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1965   ABW 1965    NA       NA       NA 67.435    67.113    66.787</span>
<span class="r-in"><span class="va">PCGDP</span> <span class="op">&lt;-</span> <span class="va">pwlddev</span><span class="op">$</span><span class="va">PCGDP</span>                                          <span class="co"># A panel-Series of GDP per Capita</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">L</span><span class="op">(</span><span class="va">PCGDP</span><span class="op">)</span><span class="op">)</span>                                                  <span class="co"># Lagging the panel series</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1960 ABW-1961 ABW-1962 ABW-1963 ABW-1964 ABW-1965 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA       NA       NA       NA       NA       NA </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">PCGDP</span> <span class="op">~</span> <span class="va">.</span>, <span class="fu">L</span><span class="op">(</span><span class="va">pwlddev</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">10</span>, keep.ids <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># Running the lm again</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = PCGDP ~ ., data = L(pwlddev, 0:2, 9:10, keep.ids = FALSE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -16776.5   -102.2    -17.2     91.5  12277.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -333.93994   61.04617  -5.470 4.62e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L1.PCGDP       1.31959    0.01021 129.270  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L2.PCGDP      -0.31707    0.01029 -30.815  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LIFEEX       -17.77368   35.47772  -0.501    0.616    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L1.LIFEEX     45.76286   65.87124   0.695    0.487    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L2.LIFEEX    -21.43005   34.98964  -0.612    0.540    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 787.3 on 8609 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (4561 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9976,	Adjusted R-squared:  0.9976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 7.26e+05 on 5 and 8609 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># THIS DOES NOT WORK: -&gt; a pseries is only created when subsetting the pdata.frame using $ or [[</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">PCGDP</span> <span class="op">~</span> <span class="fu">L</span><span class="op">(</span><span class="va">PCGDP</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">L</span><span class="op">(</span><span class="va">LIFEEX</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="va">pwlddev</span><span class="op">)</span><span class="op">)</span>      <span class="co"># ..so L.default is used here..</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = PCGDP ~ L(PCGDP, 1:2) + L(LIFEEX, 0:2), data = pwlddev)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -16776.5   -102.2    -17.2     91.5  12277.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      -333.93994   61.04617  -5.470 4.62e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2)L1     1.31959    0.01021 129.270  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2)L2    -0.31707    0.01029 -30.815  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2)--  -17.77368   35.47772  -0.501    0.616    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2)L1   45.76286   65.87124   0.695    0.487    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2)L2  -21.43005   34.98964  -0.612    0.540    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 787.3 on 8609 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (4561 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9976,	Adjusted R-squared:  0.9976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 7.26e+05 on 5 and 8609 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="va">LIFEEX</span> <span class="op">&lt;-</span> <span class="va">pwlddev</span><span class="op">$</span><span class="va">LIFEEX</span>                                        <span class="co"># To make it work, create pseries</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">PCGDP</span> <span class="op">~</span> <span class="fu">L</span><span class="op">(</span><span class="va">PCGDP</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">L</span><span class="op">(</span><span class="va">LIFEEX</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>               <span class="co"># THIS WORKS !</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = PCGDP ~ L(PCGDP, 1:2) + L(LIFEEX, 0:2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -16776.5   -102.2    -17.2     91.5  12277.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      -333.93994   61.04617  -5.470 4.62e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2)L1     1.31959    0.01021 129.270  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(PCGDP, 1:2)L2    -0.31707    0.01029 -30.815  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2)--  -17.77368   35.47772  -0.501    0.616    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2)L1   45.76286   65.87124   0.695    0.487    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(LIFEEX, 0:2)L2  -21.43005   34.98964  -0.612    0.540    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 787.3 on 8609 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (4561 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9976,	Adjusted R-squared:  0.9976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 7.26e+05 on 5 and 8609 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Using dplyr:</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">wlddev</span> |&gt; <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">iso3c</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">PCGDP</span>,<span class="va">LIFEEX</span><span class="op">)</span> |&gt; <span class="fu">L</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding missing grouping variables: `iso3c`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 13,176 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   iso3c [216]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    iso3c PCGDP L1.PCGDP L2.PCGDP LIFEEX L1.LIFEEX L2.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   32.4      <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   33.0      32.4      <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   33.5      33.0      32.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   34.0      33.5      33.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   34.5      34.0      33.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   34.9      34.5      34.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   35.4      34.9      34.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   35.9      35.4      34.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   36.4      35.9      35.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AFG      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   36.9      36.4      35.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 13,166 more rows</span></span>
<span class="r-in"><span class="va">wlddev</span> |&gt; <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">iso3c</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">year</span>,<span class="va">PCGDP</span>,<span class="va">LIFEEX</span><span class="op">)</span> |&gt; <span class="fu">L</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span>,<span class="va">year</span><span class="op">)</span> <span class="co"># Also using t (safer)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding missing grouping variables: `iso3c`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 13,176 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   iso3c [216]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    iso3c  year PCGDP L1.PCGDP L2.PCGDP LIFEEX L1.LIFEEX L2.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AFG    <span style="text-decoration: underline;">1</span>960    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   32.4      <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AFG    <span style="text-decoration: underline;">1</span>961    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   33.0      32.4      <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AFG    <span style="text-decoration: underline;">1</span>962    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   33.5      33.0      32.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AFG    <span style="text-decoration: underline;">1</span>963    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   34.0      33.5      33.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AFG    <span style="text-decoration: underline;">1</span>964    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   34.5      34.0      33.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AFG    <span style="text-decoration: underline;">1</span>965    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   34.9      34.5      34.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AFG    <span style="text-decoration: underline;">1</span>966    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   35.4      34.9      34.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AFG    <span style="text-decoration: underline;">1</span>967    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   35.9      35.4      34.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AFG    <span style="text-decoration: underline;">1</span>968    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   36.4      35.9      35.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AFG    <span style="text-decoration: underline;">1</span>969    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   36.9      36.4      35.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 13,166 more rows</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

