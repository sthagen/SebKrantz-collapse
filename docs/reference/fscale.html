<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fast (Grouped, Weighted) Scaling and Centering of Matrix-like Objects — fscale • collapse</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fast (Grouped, Weighted) Scaling and Centering of Matrix-like Objects — fscale"><meta property="og:description" content="fscale is a generic function to efficiently standardize (scale and center) data. STD is a wrapper around fscale representing the 'standardization operator', with more options than fscale when applied to matrices and data frames.  Standardization can be simple or groupwise, ordinary or weighted. Arbitrary target means and standard deviations can be set, with special options for grouped scaling and centering. It is also possible to scale data without centering i.e. perform mean-preserving scaling.
Note: For centering without scaling see fwithin/W. For simple not mean-preserving scaling use fsd(..., TRA = &quot;/&quot;). To sweep pre-computed means and scale-factors out of data see TRA."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" class="external-link">Blog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/collapse_R" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast (Grouped, Weighted) Scaling and Centering of Matrix-like Objects</h1>
    
    <div class="hidden name"><code>fscale.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>fscale</code> is a generic function to efficiently standardize (scale and center) data. <code>STD</code> is a wrapper around <code>fscale</code> representing the 'standardization operator', with more options than <code>fscale</code> when applied to matrices and data frames.  Standardization can be simple or groupwise, ordinary or weighted. Arbitrary target means and standard deviations can be set, with special options for grouped scaling and centering. It is also possible to scale data without centering i.e. perform mean-preserving scaling.</p>
<p><em>Note</em>: For centering without scaling see <code><a href="fbetween_fwithin.html">fwithin/W</a></code>. For simple not mean-preserving scaling use <code><a href="fvar_fsd.html">fsd(..., TRA = "/")</a></code>. To sweep pre-computed means and scale-factors out of data see <code><a href="TRA.html">TRA</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">fscale</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
   <span class="fu">STD</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">fscale</span><span class="op">(</span><span class="va">x</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for default</span>
<span class="fu">STD</span><span class="op">(</span><span class="va">x</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for matrix</span>
<span class="fu">fscale</span><span class="op">(</span><span class="va">x</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for matrix</span>
<span class="fu">STD</span><span class="op">(</span><span class="va">x</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>,
    stub <span class="op">=</span> <span class="st">"STD."</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for data.frame</span>
<span class="fu">fscale</span><span class="op">(</span><span class="va">x</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for data.frame</span>
<span class="fu">STD</span><span class="op">(</span><span class="va">x</span>, by <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, cols <span class="op">=</span> <span class="va">is.numeric</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>,
    mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, stub <span class="op">=</span> <span class="st">"STD."</span>, keep.by <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># Methods for compatibility with plm:</span>

<span class="co"># S3 method for pseries</span>
<span class="fu">fscale</span><span class="op">(</span><span class="va">x</span>, effect <span class="op">=</span> <span class="fl">1L</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for pseries</span>
<span class="fu">STD</span><span class="op">(</span><span class="va">x</span>, effect <span class="op">=</span> <span class="fl">1L</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for pdata.frame</span>
<span class="fu">fscale</span><span class="op">(</span><span class="va">x</span>, effect <span class="op">=</span> <span class="fl">1L</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for pdata.frame</span>
<span class="fu">STD</span><span class="op">(</span><span class="va">x</span>, effect <span class="op">=</span> <span class="fl">1L</span>, w <span class="op">=</span> <span class="cn">NULL</span>, cols <span class="op">=</span> <span class="va">is.numeric</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>,
    mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, stub <span class="op">=</span> <span class="st">"STD."</span>, keep.ids <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># Methods for grouped data frame / compatibility with dplyr:</span>

<span class="co"># S3 method for grouped_df</span>
<span class="fu">fscale</span><span class="op">(</span><span class="va">x</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>,
       keep.group_vars <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for grouped_df</span>
<span class="fu">STD</span><span class="op">(</span><span class="va">x</span>, w <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>,
    stub <span class="op">=</span> <span class="st">"STD."</span>, keep.group_vars <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector, matrix, data frame, panel series (<code><a href="https://rdrr.io/pkg/plm/man/pseries.html" class="external-link">plm::pseries</a></code>), panel data frame (<code><a href="https://rdrr.io/pkg/plm/man/pdata.frame.html" class="external-link">plm::pdata.frame</a></code>) or grouped data frame (class 'grouped_df').</p></dd>
<dt>g</dt>
<dd><p>a factor, <code><a href="GRP.html">GRP</a></code> object, atomic vector (internally converted to factor) or a list of vectors / factors (internally converted to a <code><a href="GRP.html">GRP</a></code> object) used to group <code>x</code>.</p></dd>
<dt>by</dt>
<dd><p><em>STD data.frame method</em>: Same as <code>g</code>, but also allows one- or two-sided formulas i.e. <code>~ group1</code> or <code>var1 + var2 ~ group1 + group2</code>. See Examples.</p></dd>
<dt>cols</dt>
<dd><p><em>data.frame method</em>: Select columns to scale using a function, column names, indices or a logical vector. Default: All numeric variables. <em>Note</em>: <code>cols</code> is ignored if a two-sided formula is passed to <code>by</code>.</p></dd>
<dt>w</dt>
<dd><p>a numeric vector of (non-negative) weights. <code>STD</code> data frame and <code>pdata.frame</code> methods also allow a one-sided formula i.e. <code>~ weightcol</code>. The <code>grouped_df</code> (<em>dplyr</em>) method supports lazy-evaluation. See Examples.</p></dd>
<dt>na.rm</dt>
<dd><p>logical. Skip missing values in <code>x</code> or <code>w</code> when computing means and sd's.</p></dd>
<dt>effect</dt>
<dd><p><em>plm</em> methods: Select which panel identifier should be used as group-id. 1L takes the first variable in the <code><a href="https://rdrr.io/pkg/plm/man/index.plm.html" class="external-link">plm::index</a></code>, 2L the second etc.. Index variables can also be called by name using a character string. More than one variable can be supplied.</p></dd>
<dt>stub</dt>
<dd><p>a prefix or stub to rename all transformed columns. <code>FALSE</code> will not rename columns.</p></dd>
<dt>mean</dt>
<dd><p>the mean to center on (default is 0). If <code>mean = FALSE</code>, no centering will be performed. In that case the scaling is mean-preserving. A numeric value different from 0 (i.e. <code>mean = 5</code>) will be added to the data after subtracting out the mean(s), such that the data will have a mean of 5. A special option when performing grouped scaling and centering is <code>mean = "overall.mean"</code>. In that case the overall mean of the data will be added after subtracting out group means.</p></dd>
<dt>sd</dt>
<dd><p>the standard deviation to scale the data to (default is 1). A numeric value different from 0 (i.e. <code>sd = 3</code>) will scale the data to have a standard deviation  of 3. A special option when performing grouped scaling is <code>sd = "within.sd"</code>. In that case the within standard deviation (= the standard deviation of the group-centered series) will be calculated and applied to each group. The results is that the variance of the data within each group is harmonized without forcing a certain variance (such as 1).</p></dd>
<dt>keep.by, keep.ids, keep.group_vars</dt>
<dd><p><em>data.frame, pdata.frame and grouped_df methods</em>: Logical. Retain grouping / panel-identifier columns in the output. For <code>STD.data.frame</code> this only works if grouping variables were passed in a formula.</p></dd>
<dt>keep.w</dt>
<dd><p><em>data.frame, pdata.frame and grouped_df methods</em>: Logical. Retain column containing the weights in the output. Only works if <code>w</code> is passed as formula / lazy-expression.</p></dd>
<dt>...</dt>
<dd><p>arguments to be passed to or from other methods.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>g = NULL</code>, <code>fscale</code> by default (column-wise) subtracts the mean or weighted mean (if <code>w</code> is supplied) from all data points in <code>x</code>, and then divides this difference by the standard deviation or frequency-weighted standard deviation (if <code>w</code> is supplied). The result is that all columns in <code>x</code> will have mean 0 and standard deviation 1. Alternatively, data can be scaled to have a mean of <code>mean</code> and a standard deviation of <code>sd</code>. If <code>mean = FALSE</code> the data is only scaled (not centered) such that the mean of the data is preserved. <br></p>
<p>Means and standard deviations are computed using Welford's numerically stable online algorithm.</p>
<p>With groups supplied to <code>g</code>, this standardizing becomes groupwise, so that in each group (in each column) the data points will have mean <code>mean</code> and standard deviation <code>sd</code>. Naturally if <code>mean = FALSE</code> then each group is just scaled and the mean is preserved. For centering without scaling see <code><a href="fbetween_fwithin.html">fwithin</a></code>.</p>
<p>If <code>na.rm = FALSE</code> and a <code>NA</code> or <code>NaN</code> is encountered, the mean and sd for that group will be <code>NA</code>, and all data points belonging to that group will also be <code>NA</code> in the output.</p>
<p>If <code>na.rm = TRUE</code>, means and sd's are computed (column-wise) on the available data points, and also the weight vector can have missing values. In that case, the weighted mean an sd are computed on (column-wise) <code>complete.cases(x, w)</code>, and <code>x</code> is scaled using these statistics. <em>Note</em> that <code>fscale</code> will not insert a missing value in <code>x</code> if the weight for that value is missing, rather, that value will be scaled using a weighted mean and standard-deviated computed without itself! (The intention here is that a few (randomly) missing weights shouldn't break the computation when <code>na.rm = TRUE</code>, but it is not meant for weight vectors with many missing values. If you don't like this behavior, you should prepare your data using <code>x[is.na(w), ] &lt;- NA</code>, or impute your weight vector for non-missing <code>x</code>).</p>
<p>Special options for grouped scaling are <code>mean = "overall.mean"</code> and <code>sd = "within.sd"</code>. The former group-centers vectors on the overall mean of the data (see <code><a href="fbetween_fwithin.html">fwithin</a></code> for more details) and the latter scales the data in each group to have the within-group standard deviation (= the standard deviation of the group-centered data). Thus scaling a grouped vector with options <code>mean = "overall.mean"</code> and <code>sd = "within.sd"</code> amounts to removing all differences in the mean and standard deviations between these groups. In weighted computations, <code>mean = "overall.mean"</code> will subtract weighted group-means from the data and add the overall weighted mean of the data, whereas <code>sd = "within.sd"</code> will compute the weighted within- standard deviation and apply it to each group.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>x</code> standardized (mean = mean, standard deviation = sd), grouped by <code>g/by</code>, weighted with <code>w</code>. See Details.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="fbetween_fwithin.html">fwithin</a></code>, <code><a href="fvar_fsd.html">fsd</a></code>, <code><a href="TRA.html">TRA</a></code>, <a href="fast-statistical-functions.html">Fast Statistical Functions</a>, <a href="data-transformations.html">Data Transformations</a>, <a href="index.html">Collapse Overview</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## Simple Scaling &amp; Centering / Standardizing</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fscale</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span>               <span class="co"># Doesn't rename columns</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          mpg        cyl        disp         hp       drat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4          0.1508848 -0.1049878 -0.57061982 -0.5350928  0.5675137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag      0.1508848 -0.1049878 -0.57061982 -0.5350928  0.5675137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         0.4495434 -1.2248578 -0.99018209 -0.7830405  0.4739996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive     0.2172534 -0.1049878  0.22009369 -0.5350928 -0.9661175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -0.2307345  1.0148821  1.04308123  0.4129422 -0.8351978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -0.3302874 -0.1049878 -0.04616698 -0.6080186 -1.5646078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             wt       qsec         vs         am       gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         -0.610399567 -0.7771651 -0.8680278  1.1899014  0.4235542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     -0.349785269 -0.4637808 -0.8680278  1.1899014  0.4235542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        -0.917004624  0.4260068  1.1160357  1.1899014  0.4235542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    -0.002299538  0.8904872  1.1160357 -0.8141431 -0.9318192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout  0.227654255 -0.4637808 -0.8680278 -0.8141431 -0.9318192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant            0.248094592  1.3269868  1.1160357 -0.8141431 -0.9318192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         carb           X</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4          0.7352031 -0.61370839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag      0.7352031  0.04306156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        -1.1221521  1.47418477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    -1.1221521 -0.50775555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -0.5030337 -0.13396616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -1.1221521  0.41020490</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">STD</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span>                  <span class="co"># By default adds a prefix</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      STD.mpg    STD.cyl    STD.disp     STD.hp   STD.drat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4          0.1508848 -0.1049878 -0.57061982 -0.5350928  0.5675137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag      0.1508848 -0.1049878 -0.57061982 -0.5350928  0.5675137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         0.4495434 -1.2248578 -0.99018209 -0.7830405  0.4739996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive     0.2172534 -0.1049878  0.22009369 -0.5350928 -0.9661175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -0.2307345  1.0148821  1.04308123  0.4129422 -0.8351978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -0.3302874 -0.1049878 -0.04616698 -0.6080186 -1.5646078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         STD.wt   STD.qsec     STD.vs     STD.am   STD.gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         -0.610399567 -0.7771651 -0.8680278  1.1899014  0.4235542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     -0.349785269 -0.4637808 -0.8680278  1.1899014  0.4235542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        -0.917004624  0.4260068  1.1160357  1.1899014  0.4235542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    -0.002299538  0.8904872  1.1160357 -0.8141431 -0.9318192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout  0.227654255 -0.4637808 -0.8680278 -0.8141431 -0.9318192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant            0.248094592  1.3269868  1.1160357 -0.8141431 -0.9318192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     STD.carb       STD.X</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4          0.7352031 -0.61370839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag      0.7352031  0.04306156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        -1.1221521  1.47418477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    -1.1221521 -0.50775555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -0.5030337 -0.13396616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -1.1221521  0.41020490</span>
<span class="r-in"><span class="fu"><a href="qsu.html">qsu</a></span><span class="op">(</span><span class="fu">STD</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span>                   <span class="co"># See that is works</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N  Mean  SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.mpg   32    -0   1  -1.6079  2.2913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.cyl   32     0   1  -1.2249  1.0149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.disp  32    -0   1  -1.2879  1.9468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.hp    32     0   1   -1.381  2.7466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.drat  32    -0   1  -1.5646  2.4939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.wt    32    -0   1  -1.7418  2.2553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.qsec  32     0   1   -1.874  2.8268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.vs    32     0   1   -0.868   1.116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.am    32    -0   1  -0.8141  1.1899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.gear  32     0   1  -0.9318  1.7789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.carb  32    -0   1  -1.1222  3.2117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.X     32    -0   1  -1.9596  2.0035</span>
<span class="r-in"><span class="fu"><a href="qsu.html">qsu</a></span><span class="op">(</span><span class="fu">STD</span><span class="op">(</span><span class="va">mtcars</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Assigning a mean of 5 and a standard deviation of 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N  Mean  SD      Min      Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.mpg   32     5   3   0.1764  11.8738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.cyl   32     5   3   1.3254   8.0446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.disp  32     5   3   1.1363  10.8403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.hp    32     5   3   0.8569  13.2397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.drat  32     5   3   0.3062  12.4817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.wt    32     5   3  -0.2253   11.766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.qsec  32     5   3   -0.622  13.4803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.vs    32     5   3   2.3959   8.3481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.am    32     5   3   2.5576   8.5697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.gear  32     5   3   2.2045  10.3368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.carb  32     5   3   1.6335   14.635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.X     32     5   3  -0.8787  11.0104</span>
<span class="r-in"><span class="fu"><a href="qsu.html">qsu</a></span><span class="op">(</span><span class="fu">STD</span><span class="op">(</span><span class="va">mtcars</span>, mean <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>     <span class="co"># No centering: Scaling is mean-preserving</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N      Mean  SD       Min       Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.mpg   32   20.0906   1   18.4827   22.3819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.cyl   32    6.1875   1    4.9626    7.2024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.disp  32  230.7219   1   229.434  232.6686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.hp    32  146.6875   1  145.3065  149.4341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.drat  32    3.5966   1     2.032    6.0905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.wt    32    3.2172   1    1.4755    5.4726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.qsec  32   17.8487   1   15.9747   20.6755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.vs    32    0.4375   1   -0.4305    1.5535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.am    32    0.4062   1   -0.4079    1.5962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.gear  32    3.6875   1    2.7557    5.4664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.carb  32    2.8125   1    1.6903    6.0242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STD.X     32   -0.1308   1   -2.0903    1.8727</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Panel Data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fscale</span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">wlddev</span>,<span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, <span class="va">wlddev</span><span class="op">$</span><span class="va">iso3c</span><span class="op">)</span><span class="op">)</span>   <span class="co"># Standardizing 4 series within each country</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PCGDP    LIFEEX GINI        ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    NA -1.653181   NA -0.6498451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    NA -1.602256   NA -0.5951801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    NA -1.552023   NA -0.6517082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    NA -1.502678   NA -0.5925063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA -1.454122   NA -0.5649154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    NA -1.406257   NA -0.5431461</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">STD</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span><span class="va">iso3c</span>, cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span>              <span class="co"># Same thing using STD, id's added</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iso3c STD.PCGDP STD.LIFEEX STD.GINI    STD.ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   AFG        NA  -1.653181       NA -0.6498451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   AFG        NA  -1.602256       NA -0.5951801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   AFG        NA  -1.552023       NA -0.6517082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   AFG        NA  -1.502678       NA -0.5925063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   AFG        NA  -1.454122       NA -0.5649154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   AFG        NA  -1.406257       NA -0.5431461</span>
<span class="r-in"><span class="fu"><a href="pwcor_pwcov_pwnobs.html">pwcor</a></span><span class="op">(</span><span class="fu">fscale</span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">wlddev</span>,<span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, <span class="va">wlddev</span><span class="op">$</span><span class="va">iso3c</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Correlaing panel series after standardizing</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PCGDP LIFEEX  GINI   ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCGDP     1     .62  -.20   .09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LIFEEX   .62     1   -.12   .32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GINI    -.20   -.12    1   -.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ODA      .09    .32  -.09    1 </span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="fmean.html">fmean</a></span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span>                       <span class="co"># This calculates the overall means</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PCGDP       LIFEEX         GINI          ODA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.204878e+04 6.429630e+01 3.853412e+01 4.547201e+08 </span>
<span class="r-in"><span class="fu"><a href="fvar_fsd.html">fsd</a></span><span class="op">(</span><span class="fu"><a href="fbetween_fwithin.html">fwithin</a></span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, <span class="va">wlddev</span><span class="op">$</span><span class="va">iso3c</span><span class="op">)</span><span class="op">)</span>  <span class="co"># This calculates the within standard deviations</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PCGDP       LIFEEX         GINI          ODA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.723681e+03 6.084205e+00 2.927700e+00 6.507096e+08 </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="qsu.html">qsu</a></span><span class="op">(</span><span class="fu">fscale</span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">wlddev</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>,             <span class="co"># This group-centers on the overall mean and</span></span>
<span class="r-in">    <span class="va">wlddev</span><span class="op">$</span><span class="va">iso3c</span>,                                   <span class="co"># group-scales to the within standard deviation</span></span>
<span class="r-in">    mean <span class="op">=</span> <span class="st">"overall.mean"</span>, sd <span class="op">=</span> <span class="st">"within.sd"</span><span class="op">)</span>,       <span class="co"># -&gt; data harmonized in the first 2 moments</span></span>
<span class="r-in">    by <span class="op">=</span> <span class="va">wlddev</span><span class="op">$</span><span class="va">iso3c</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , PCGDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N       Mean         SD          Min         Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW  32  12048.778  6723.6808  -13032.4333  19779.7812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AFG  18  12048.778  6723.6808    2023.3142   18822.252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGO  40  12048.778  6723.6808   -1027.1433  22877.0816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALB  40  12048.778  6723.6808    3212.4503  25460.2799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AND  50  12048.778  6723.6808    -111.8716  24171.0081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARE  45  12048.778  6723.6808    3206.3558  26904.4271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N     Mean      SD      Min      Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW  60  64.2963  6.0842  49.8607  72.6147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AFG  60  64.2963  6.0842   54.238  73.6849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGO  60  64.2963  6.0842  55.6648  77.7463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALB  60  64.2963  6.0842  50.8542  74.1559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AND   0        0       -        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARE  60  64.2963  6.0842  49.6668  71.3434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , GINI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      N     Mean      SD      Min      Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW  0        0       -        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AFG  0        0       -        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGO  3  38.5341  2.9277  35.1612  40.4184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALB  9  38.5341  2.9277  33.3068  42.3131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AND  0        0       -        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARE  2  38.5341  2.9277  36.4639  40.6043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N        Mean          SD           Min             Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW  20  454'720131  650'709624   -640'020213  1.95305466e+09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AFG  60  454'720131  650'709624  -2'329374.87  2.03702336e+09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"> </span>
<span class="r-in"><span class="co">## Using plm</span></span>
<span class="r-in"><span class="va">pwlddev</span> <span class="op">&lt;-</span> <span class="fu">plm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pdata.frame.html" class="external-link">pdata.frame</a></span><span class="op">(</span><span class="va">wlddev</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iso3c"</span>,<span class="st">"year"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">STD</span><span class="op">(</span><span class="va">pwlddev</span><span class="op">)</span><span class="op">)</span>                                  <span class="co"># Standardizing all numeric variables by country</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          iso3c year STD.decade STD.PCGDP STD.LIFEEX STD.GINI STD.ODA    STD.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1960   ABW 1960  -1.448413        NA  -2.372636       NA      NA -1.1452149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1961   ABW 1961  -1.448413        NA  -2.227700       NA      NA -1.0815100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1962   ABW 1962  -1.448413        NA  -2.097539       NA      NA -1.0406496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1963   ABW 1963  -1.448413        NA  -1.976876       NA      NA -1.0162476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1964   ABW 1964  -1.448413        NA  -1.862193       NA      NA -0.9987508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1965   ABW 1965  -1.448413        NA  -1.748918       NA      NA -0.9817213</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">STD</span><span class="op">(</span><span class="va">pwlddev</span>, effect <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>                     <span class="co"># Standardizing all numeric variables by year</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          iso3c year STD.decade STD.PCGDP STD.LIFEEX STD.GINI STD.ODA    STD.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1960   ABW 1960        NaN        NA  0.9609854       NA      NA -0.2421282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1961   ABW 1961        NaN        NA  0.9485730       NA      NA -0.2450170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1962   ABW 1962        NaN        NA  0.9585105       NA      NA -0.2461106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1963   ABW 1963        NaN        NA  0.9669638       NA      NA -0.2456728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1964   ABW 1964        NaN        NA  0.9579477       NA      NA -0.2453528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW-1965   ABW 1965        NaN        NA  0.9556529       NA      NA -0.2449471</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Weighted Standardizing</span></span>
<span class="r-in"><span class="va">weights</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">wlddev</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fscale</span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">wlddev</span>,<span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, <span class="va">wlddev</span><span class="op">$</span><span class="va">iso3c</span>, <span class="va">weights</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PCGDP    LIFEEX GINI        ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    NA -1.610365   NA -0.6615821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    NA -1.560728   NA -0.6016605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    NA -1.511764   NA -0.6636243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    NA -1.463666   NA -0.5987297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA -1.416337   NA -0.5684857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    NA -1.369682   NA -0.5446231</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">STD</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span><span class="va">iso3c</span>, <span class="va">weights</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iso3c STD.PCGDP STD.LIFEEX STD.GINI    STD.ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   AFG        NA  -1.610365       NA -0.6615821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   AFG        NA  -1.560728       NA -0.6016605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   AFG        NA  -1.511764       NA -0.6636243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   AFG        NA  -1.463666       NA -0.5987297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   AFG        NA  -1.416337       NA -0.5684857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   AFG        NA  -1.369682       NA -0.5446231</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Using dplyr</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">wlddev</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">iso3c</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">PCGDP</span>,<span class="va">LIFEEX</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">STD</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding missing grouping variables: `iso3c`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 13,176 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   iso3c [216]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    iso3c STD.PCGDP STD.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.65</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.60</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.55</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.50</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.45</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.41</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.36</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.31</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.26</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.21</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 13,166 more rows</span></span>
<span class="r-in"><span class="va">wlddev</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">iso3c</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">PCGDP</span>,<span class="va">LIFEEX</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">STD</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span> <span class="co"># weighted standardizing</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding missing grouping variables: `iso3c`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 13,176 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   iso3c [216]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    iso3c STD.PCGDP STD.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.61</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.56</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.51</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.46</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.42</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.37</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.32</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.28</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.23</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AFG          <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.18</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 13,166 more rows</span></span>
<span class="r-in"><span class="va">wlddev</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">iso3c</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">PCGDP</span>,<span class="va">LIFEEX</span>,<span class="va">POP</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">STD</span><span class="op">(</span><span class="va">POP</span><span class="op">)</span> <span class="co"># weighting by POP -&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding missing grouping variables: `iso3c`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 13,176 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   iso3c [216]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    iso3c      POP STD.PCGDP STD.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AFG    8<span style="text-decoration: underline;">996</span>973        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AFG    9<span style="text-decoration: underline;">169</span>410        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AFG    9<span style="text-decoration: underline;">351</span>441        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.07</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AFG    9<span style="text-decoration: underline;">543</span>205        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.02</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AFG    9<span style="text-decoration: underline;">744</span>781        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.96</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AFG    9<span style="text-decoration: underline;">956</span>320        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.91</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AFG   10<span style="text-decoration: underline;">174</span>836        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.86</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AFG   10<span style="text-decoration: underline;">399</span>926        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.81</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AFG   10<span style="text-decoration: underline;">637</span>063        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.76</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AFG   10<span style="text-decoration: underline;">893</span>776        <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.71</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 13,166 more rows</span></span>
<span class="r-in"><span class="co"># ..keeps the weight column unless keep.w = FALSE</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

