<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon">
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast Transform and Compute Columns on a Data Frame — ftransform • collapse</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fast Transform and Compute Columns on a Data Frame — ftransform" />
<meta property="og:description" content="ftransform is a much faster version of transform and dplyr::mutate for data frames. It returns the data frame with new columns computed and/or existing columns modified or deleted. settransform does all of that by reference i.e. it modifies the data frame in the global environment. fcompute can be used to compute new columns from the columns in a data frame and returns only the computed columns." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" target="_blank">Blog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/collapse_R" target="_blank">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" target="_blank">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast Transform and Compute Columns on a Data Frame</h1>
    
    <div class="hidden name"><code>ftransform.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>ftransform</code> is a much faster version of <code><a href='https://rdrr.io/r/base/transform.html'>transform</a></code> and <code><a href='https://dplyr.tidyverse.org/reference/mutate.html'>dplyr::mutate</a></code> for data frames. It returns the data frame with new columns computed and/or existing columns modified or deleted. <code>settransform</code> does all of that by reference i.e. it modifies the data frame in the global environment. <code>fcompute</code> can be used to compute new columns from the columns in a data frame and returns only the computed columns.</p>
    </div>

    <pre class="usage"><span class='co'># Modify and return data frame</span>
<span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>ftransformv</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>vars</span>, <span class='va'>FUN</span>, <span class='va'>...</span>, apply <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>tfm</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>...</span><span class='op'>)</span>               <span class='co'># Shortcut for ftransform</span>
<span class='fu'>tfmv</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>vars</span>, <span class='va'>FUN</span>, <span class='va'>...</span>, apply <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Modify data frame by reference</span>
<span class='fu'>settransform</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>settransformv</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>vars</span>, <span class='va'>FUN</span>, <span class='va'>...</span>, apply <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>settfm</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>...</span><span class='op'>)</span>            <span class='co'># Shortcut for settransform</span>
<span class='fu'>settfmv</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>vars</span>, <span class='va'>FUN</span>, <span class='va'>...</span>, apply <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Replace/add modified columns in/to a data frame</span>
<span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>
<span class='fu'>tfm</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>           <span class='co'># Shortcut for ftransform&lt;-</span>

<span class='co'># Compute columns, returned as a new data frame</span>
<span class='fu'>fcompute</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>a data frame or named list of columns.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments of the form <code>column = value</code>. The <code>value</code> can be a combination of other columns, a scalar value, or <code>NULL</code>, which deletes <code>column</code>. Alternatively it is also possible to place a single list here, which will be treated like a list of <code>column = value</code> arguments. For <code>ftransformv</code>, <code>...</code> can be used to pass further arguments to <code>FUN</code>. <em>Note:</em> The ellipsis (<code>...</code>) is always evaluated within the data frame (<code>X</code>) environment. See Examples.</p></td>
    </tr>
    <tr>
      <th>vars</th>
      <td><p>variables to be transformed by applying <code>FUN</code> to them: select using names, indices, a logical vector or a selector function (e.g. <code>is.numeric</code>).</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>a single function yielding a result of length <code><a href='https://rdrr.io/r/base/nrow.html'>NROW(X)</a></code> or 1. See also <code>apply</code>.</p></td>
    </tr>
    <tr>
      <th>apply</th>
      <td><p>logical. <code>TRUE</code> (default) will apply <code>FUN</code> to each column selected in <code>vars</code>; <code>FALSE</code> will apply <code>FUN</code> to the subsetted data frame i.e. <code>FUN(get_vars(X, vars), ...)</code>. The latter is useful for <em>collapse</em> functions with data frame or grouped / panel data frame methods, yielding performance gains and enabling grouped transformations. See Examples.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>a named list of replacements, it will be treated like an evaluated list of <code>column = value</code> arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>...</code> arguments to <code>ftransform</code> are tagged
  vector expressions, which are evaluated in the data frame
  <code>X</code>.  The tags are matched against <code><a href='https://rdrr.io/r/base/names.html'>names(X)</a></code>, and for
  those that match, the values replace the corresponding variable in
  <code>X</code>, whereas the others are appended to <code>X</code>. It is also possible to delete columns by assigning <code>NULL</code> to them, i.e. <code>ftransform(data, colk = NULL)</code> removes <code>colk</code> from the data. <em>Note</em> that <code><a href='https://rdrr.io/r/base/names.html'>names(X)</a></code> and the names of the <code>...</code> arguments are checked for uniqueness beforehand, yielding an error if this is not the case.</p>
<p>Since <em>collapse</em> v1.3.0, is is also possible to pass a single named list to <code>...</code>, i.e. <code>ftransform(data, newdata)</code>. This list will be treated like a list of tagged vector expressions. <em>Note</em> the different behavior: <code>ftransform(data, list(newcol = col1))</code> is the same as <code>ftransform(data, newcol = col1)</code>, whereas <code>ftransform(data, newcol = as.list(col1))</code> creates a list column. Something like <code>ftransform(data, as.list(col1))</code> gives an error because the list is not named. See Examples.   <!-- % and \code{ftransform(data, as.list(col1))} gives an error because an unnamed list is passed. % , but \code{ftransform(data, setNames(as.list(col1), col1))} will work and add the values of \code{col1} as separate columns. --></p>
<p><!-- % \code{ftransform(data, fmean(list(col1mean = col1, col2mean = col2), drop = FALSE))} etc. --></p>
<p><!-- % For example \code{ftransformv(data, 1:3, log)} is the same as \code{ftransform(data, lapply(get_vars(data, 1:3), log))}, and \code{ftransformv(data, 1:3, log, apply = FALSE)} is the same as \code{ftransform(data, log(get_vars(data, 1:3)))}. --></p>
<p>The function <code>ftransformv</code> added in v1.3.2 provides a fast replacement for the functions <code><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>dplyr::mutate_at</a></code> and <code><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>dplyr::mutate_if</a></code> facilitating mutations of groups of columns (<code><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>dplyr::mutate_all</a></code> is already accounted for by <code><a href='dapply.html'>dapply</a></code>). See Examples.</p>
<p>The function <code>settransform</code> does all of that by reference, but uses base-R's copy-on modify semantics, which is equivalent to replacing the data with <code>&lt;-</code> (thus it is still memory efficient but the data will have a different memory address afterwards).</p>
<p>The function <code>fcompute</code> works just like <code>ftransform</code>, but returns only the changed / computed columns without modifying or appending the data in <code>X</code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The modified data frame <code>X</code>, or, for <code>fcompute</code>, a new data frame with the columns computed on <code>X</code>. All attributes of <code>X</code> are preserved.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/with.html'>with</a></code>, <code><a href='https://rdrr.io/r/base/with.html'>within</a></code>, <code><a href='fselect, get_vars, add_vars.html'>add_vars</a></code>, <a href='A3-fast-data-manipulation.html'>Data Frame Manipulation</a>, <a href='index.html'>Collapse Overview</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## ftransform modifies and returns a data.frame</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>airquality</span>, Ozone <span class='op'>=</span> <span class='op'>-</span><span class='va'>Ozone</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day
#&gt; 1   -41     190  7.4   67     5   1
#&gt; 2   -36     118  8.0   72     5   2
#&gt; 3   -12     149 12.6   74     5   3
#&gt; 4   -18     313 11.5   62     5   4
#&gt; 5    NA      NA 14.3   56     5   5
#&gt; 6   -28      NA 14.9   66     5   6</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>airquality</span>, new <span class='op'>=</span> <span class='op'>-</span><span class='va'>Ozone</span>, Temp <span class='op'>=</span> <span class='op'>(</span><span class='va'>Temp</span><span class='op'>-</span><span class='fl'>32</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>1.8</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind     Temp Month Day new
#&gt; 1    41     190  7.4 19.44444     5   1 -41
#&gt; 2    36     118  8.0 22.22222     5   2 -36
#&gt; 3    12     149 12.6 23.33333     5   3 -12
#&gt; 4    18     313 11.5 16.66667     5   4 -18
#&gt; 5    NA      NA 14.3 13.33333     5   5  NA
#&gt; 6    28      NA 14.9 18.88889     5   6 -28</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>airquality</span>, new <span class='op'>=</span> <span class='op'>-</span><span class='va'>Ozone</span>, new2 <span class='op'>=</span> <span class='fl'>1</span>, Temp <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># Deleting Temp</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Month Day new new2
#&gt; 1    41     190  7.4     5   1 -41    1
#&gt; 2    36     118  8.0     5   2 -36    1
#&gt; 3    12     149 12.6     5   3 -12    1
#&gt; 4    18     313 11.5     5   4 -18    1
#&gt; 5    NA      NA 14.3     5   5  NA    1
#&gt; 6    28      NA 14.9     5   6 -28    1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>airquality</span>, Ozone <span class='op'>=</span> <span class='cn'>NULL</span>, Temp <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span>            <span class='co'># Deleting columns</span>
</div><div class='output co'>#&gt;   Solar.R Wind Month Day
#&gt; 1     190  7.4     5   1
#&gt; 2     118  8.0     5   2
#&gt; 3     149 12.6     5   3
#&gt; 4     313 11.5     5   4
#&gt; 5      NA 14.3     5   5
#&gt; 6      NA 14.9     5   6</div><div class='input'>
<span class='co'># With collapse's grouped and weighted functions, complex operations are done on the fly</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='co'># Grouped operations by month:</span>
                Ozone_Month_median <span class='op'>=</span> <span class='fu'><a href='fmedian.html'>fmedian</a></span><span class='op'>(</span><span class='va'>Ozone</span>, <span class='va'>Month</span>, TRA <span class='op'>=</span> <span class='st'>"replace_fill"</span><span class='op'>)</span>,
                Ozone_Month_sd <span class='op'>=</span> <span class='fu'><a href='fvar, fsd.html'>fsd</a></span><span class='op'>(</span><span class='va'>Ozone</span>, <span class='va'>Month</span>, TRA <span class='op'>=</span> <span class='st'>"replace"</span><span class='op'>)</span>,
                Ozone_Month_centered <span class='op'>=</span> <span class='fu'><a href='fbetween, fwithin.html'>fwithin</a></span><span class='op'>(</span><span class='va'>Ozone</span>, <span class='va'>Month</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day Ozone_Month_median Ozone_Month_sd
#&gt; 1    41     190  7.4   67     5   1                 18       22.22445
#&gt; 2    36     118  8.0   72     5   2                 18       22.22445
#&gt; 3    12     149 12.6   74     5   3                 18       22.22445
#&gt; 4    18     313 11.5   62     5   4                 18       22.22445
#&gt; 5    NA      NA 14.3   56     5   5                 18             NA
#&gt; 6    28      NA 14.9   66     5   6                 18       22.22445
#&gt;   Ozone_Month_centered
#&gt; 1            17.384615
#&gt; 2            12.384615
#&gt; 3           -11.615385
#&gt; 4            -5.615385
#&gt; 5                   NA
#&gt; 6             4.384615</div><div class='input'>
<span class='co'># Grouping by month and above/below average temperature in each month</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>airquality</span>, Ozone_Month_high_median <span class='op'>=</span>
                  <span class='fu'><a href='fmedian.html'>fmedian</a></span><span class='op'>(</span><span class='va'>Ozone</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>Month</span>, <span class='va'>Temp</span> <span class='op'>&gt;</span> <span class='fu'><a href='fbetween, fwithin.html'>fbetween</a></span><span class='op'>(</span><span class='va'>Temp</span>, <span class='va'>Month</span><span class='op'>)</span><span class='op'>)</span>, TRA <span class='op'>=</span> <span class='st'>"replace_fill"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day Ozone_Month_high_median
#&gt; 1    41     190  7.4   67     5   1                      28
#&gt; 2    36     118  8.0   72     5   2                      28
#&gt; 3    12     149 12.6   74     5   3                      28
#&gt; 4    18     313 11.5   62     5   4                      14
#&gt; 5    NA      NA 14.3   56     5   5                      14
#&gt; 6    28      NA 14.9   66     5   6                      28</div><div class='input'>
<span class='co'>## ftransformv can be used to modify multiply columns using a function</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransformv</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='va'>log</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      Ozone  Solar.R     Wind Temp Month Day
#&gt; 1 3.713572 5.247024 2.001480   67     5   1
#&gt; 2 3.583519 4.770685 2.079442   72     5   2
#&gt; 3 2.484907 5.003946 2.533697   74     5   3
#&gt; 4 2.890372 5.746203 2.442347   62     5   4
#&gt; 5       NA       NA 2.660260   56     5   5
#&gt; 6 3.332205       NA 2.701361   66     5   6</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>`[&lt;-`</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>, <span class='va'>log</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Same thing in base R</span>
</div><div class='output co'>#&gt;      Ozone  Solar.R     Wind Temp Month Day
#&gt; 1 3.713572 5.247024 2.001480   67     5   1
#&gt; 2 3.583519 4.770685 2.079442   72     5   2
#&gt; 3 2.484907 5.003946 2.533697   74     5   3
#&gt; 4 2.890372 5.746203 2.442347   62     5   4
#&gt; 5       NA       NA 2.660260   56     5   5
#&gt; 6 3.332205       NA 2.701361   66     5   6</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransformv</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='va'>log</span>, apply <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      Ozone  Solar.R     Wind Temp Month Day
#&gt; 1 3.713572 5.247024 2.001480   67     5   1
#&gt; 2 3.583519 4.770685 2.079442   72     5   2
#&gt; 3 2.484907 5.003946 2.533697   74     5   3
#&gt; 4 2.890372 5.746203 2.442347   62     5   4
#&gt; 5       NA       NA 2.660260   56     5   5
#&gt; 6 3.332205       NA 2.701361   66     5   6</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>`[&lt;-`</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>         <span class='co'># Same thing in base R</span>
</div><div class='output co'>#&gt;      Ozone  Solar.R     Wind Temp Month Day
#&gt; 1 3.713572 5.247024 2.001480   67     5   1
#&gt; 2 3.583519 4.770685 2.079442   72     5   2
#&gt; 3 2.484907 5.003946 2.533697   74     5   3
#&gt; 4 2.890372 5.746203 2.442347   62     5   4
#&gt; 5       NA       NA 2.660260   56     5   5
#&gt; 6 3.332205       NA 2.701361   66     5   6</div><div class='input'>
<span class='co'># Using apply = FALSE yields meaningful performance gains with collapse functions</span>
<span class='co'># This calls fwithin.default, and repeates the grouping by month 3 times:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransformv</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='va'>fwithin</span>, <span class='va'>Month</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        Ozone    Solar.R       Wind Temp Month Day
#&gt; 1  17.384615   8.703704 -4.2225806   67     5   1
#&gt; 2  12.384615 -63.296296 -3.6225806   72     5   2
#&gt; 3 -11.615385 -32.296296  0.9774194   74     5   3
#&gt; 4  -5.615385 131.703704 -0.1225806   62     5   4
#&gt; 5         NA         NA  2.6774194   56     5   5
#&gt; 6   4.384615         NA  3.2774194   66     5   6</div><div class='input'>
<span class='co'># This calls fwithin.data.frame, and only groups one time -&gt; 5x faster!</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>ftransformv</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='va'>fwithin</span>, <span class='va'>Month</span>, apply <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        Ozone    Solar.R       Wind Temp Month Day
#&gt; 1  17.384615   8.703704 -4.2225806   67     5   1
#&gt; 2  12.384615 -63.296296 -3.6225806   72     5   2
#&gt; 3 -11.615385 -32.296296  0.9774194   74     5   3
#&gt; 4  -5.615385 131.703704 -0.1225806   62     5   4
#&gt; 5         NA         NA  2.6774194   56     5   5
#&gt; 6   4.384615         NA  3.2774194   66     5   6</div><div class='input'> 
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span> <span class='co'># Pipe operators</span>
<span class='co'># This also works for grouped and panel data frames (calling fwithin.grouped_df)</span>
<span class='va'>airquality</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>Month</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ftransformv</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='va'>fwithin</span>, apply <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;        Ozone    Solar.R       Wind Temp Month Day
#&gt; 1  17.384615   8.703704 -4.2225806   67     5   1
#&gt; 2  12.384615 -63.296296 -3.6225806   72     5   2
#&gt; 3 -11.615385 -32.296296  0.9774194   74     5   3
#&gt; 4  -5.615385 131.703704 -0.1225806   62     5   4
#&gt; 5         NA         NA  2.6774194   56     5   5
#&gt; 6   4.384615         NA  3.2774194   66     5   6</div><div class='input'>
<span class='co'># But this gives the WRONG result (calling fwithin.default). Need option apply = FALSE!!</span>
<span class='va'>airquality</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>Month</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ftransformv</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='va'>fwithin</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;       Ozone    Solar.R      Wind Temp Month Day
#&gt; 1  -1.12931   4.068493 -2.557516   67     5   1
#&gt; 2  -6.12931 -67.931507 -1.957516   72     5   2
#&gt; 3 -30.12931 -36.931507  2.642484   74     5   3
#&gt; 4 -24.12931 127.068493  1.542484   62     5   4
#&gt; 5        NA         NA  4.342484   56     5   5
#&gt; 6 -14.12931         NA  4.942484   66     5   6</div><div class='input'>
<span class='co'># For grouped modification of single columns in a grouped dataset, we can use GRP():</span>
<span class='va'>airquality</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>Month</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ftransform</span><span class='op'>(</span>W_Ozone <span class='op'>=</span> <span class='fu'><a href='fbetween, fwithin.html'>fwithin</a></span><span class='op'>(</span><span class='va'>Ozone</span>, <span class='fu'><a href='GRP, fgroup_by.html'>GRP</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span>,                 <span class='co'># Grouped centering</span>
             sd_Ozone_m <span class='op'>=</span> <span class='fu'><a href='fvar, fsd.html'>fsd</a></span><span class='op'>(</span><span class='va'>Ozone</span>, <span class='fu'><a href='GRP, fgroup_by.html'>GRP</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span>, TRA <span class='op'>=</span> <span class='st'>"replace"</span><span class='op'>)</span>, <span class='co'># In-Month standard deviation</span>
             sd_Ozone <span class='op'>=</span> <span class='fu'><a href='fvar, fsd.html'>fsd</a></span><span class='op'>(</span><span class='va'>Ozone</span>, TRA <span class='op'>=</span> <span class='st'>"replace"</span><span class='op'>)</span>,           <span class='co'># Overall standard deviation</span>
             sd_Ozone2 <span class='op'>=</span> <span class='fu'><a href='fvar, fsd.html'>fsd</a></span><span class='op'>(</span><span class='va'>Ozone</span>, TRA <span class='op'>=</span> <span class='st'>"replace_fill"</span><span class='op'>)</span>,     <span class='co'># Same, overwriting NA's</span>
             sd_Ozone3 <span class='op'>=</span> <span class='fu'><a href='fvar, fsd.html'>fsd</a></span><span class='op'>(</span><span class='va'>Ozone</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>                  <span class='co'># Same thing (calling rep())</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day    W_Ozone sd_Ozone_m sd_Ozone sd_Ozone2
#&gt; 1    41     190  7.4   67     5   1  17.384615   22.22445 32.98788  32.98788
#&gt; 2    36     118  8.0   72     5   2  12.384615   22.22445 32.98788  32.98788
#&gt; 3    12     149 12.6   74     5   3 -11.615385   22.22445 32.98788  32.98788
#&gt; 4    18     313 11.5   62     5   4  -5.615385   22.22445 32.98788  32.98788
#&gt; 5    NA      NA 14.3   56     5   5         NA         NA       NA  32.98788
#&gt; 6    28      NA 14.9   66     5   6   4.384615   22.22445 32.98788  32.98788
#&gt;   sd_Ozone3
#&gt; 1  32.98788
#&gt; 2  32.98788
#&gt; 3  32.98788
#&gt; 4  32.98788
#&gt; 5  32.98788
#&gt; 6  32.98788</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: object 'airquality' not found</span></div><div class='input'>
<span class='co'>## For more complex mutations we can use ftransform with compound pipes</span>
<span class='va'>airquality</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>Month</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ftransform</span><span class='op'>(</span><span class='fu'><a href='fselect, get_vars, add_vars.html'>get_vars</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>fwithin</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='flag.html'>flag</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt; <span class='message'>Panel-lag computed without timevar: Assuming ordered data</span></div><div class='output co'>#&gt;        Ozone    Solar.R       Wind Temp Month Day   L1.Ozone   L2.Ozone
#&gt; 1  17.384615   8.703704 -4.2225806   67     5   1         NA         NA
#&gt; 2  12.384615 -63.296296 -3.6225806   72     5   2  17.384615         NA
#&gt; 3 -11.615385 -32.296296  0.9774194   74     5   3  12.384615  17.384615
#&gt; 4  -5.615385 131.703704 -0.1225806   62     5   4 -11.615385  12.384615
#&gt; 5         NA         NA  2.6774194   56     5   5  -5.615385 -11.615385
#&gt; 6   4.384615         NA  3.2774194   66     5   6         NA  -5.615385
#&gt;   L1.Solar.R L2.Solar.R    L1.Wind    L2.Wind
#&gt; 1         NA         NA         NA         NA
#&gt; 2   8.703704         NA -4.2225806         NA
#&gt; 3 -63.296296   8.703704 -3.6225806 -4.2225806
#&gt; 4 -32.296296 -63.296296  0.9774194 -3.6225806
#&gt; 5 131.703704 -32.296296 -0.1225806  0.9774194
#&gt; 6         NA 131.703704  2.6774194 -0.1225806</div><div class='input'>
<span class='va'>airquality</span> <span class='op'>%&gt;%</span> <span class='fu'>ftransform</span><span class='op'>(</span><span class='fu'><a href='fscale.html'>STD</a></span><span class='op'>(</span><span class='va'>.</span>, cols <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='AA1-recode-replace.html'>replace_NA</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day   STD.Ozone STD.Solar.R   STD.Wind
#&gt; 1    41     190  7.4   67     5   1 -0.03423409  0.04517615 -0.7259482
#&gt; 2    36     118  8.0   72     5   2 -0.18580489 -0.75430487 -0.5556388
#&gt; 3    12     149 12.6   74     5   3 -0.91334473 -0.41008388  0.7500660
#&gt; 4    18     313 11.5   62     5   4 -0.73145977  1.41095624  0.4378323
#&gt; 5    NA      NA 14.3   56     5   5  0.00000000  0.00000000  1.2326091
#&gt; 6    28      NA 14.9   66     5   6 -0.42831817  0.00000000  1.4029185</div><div class='input'>
<span class='co'># The list argument feature also allows flexible operations creating multiple new columns</span>
<span class='va'>airquality</span> <span class='op'>%&gt;%</span> <span class='co'># The variance of Wind and Ozone, by month, weighted by temperature:</span>
  <span class='fu'>ftransform</span><span class='op'>(</span><span class='fu'><a href='fvar, fsd.html'>fvar</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Wind_var <span class='op'>=</span> <span class='va'>Wind</span>, Ozone_var <span class='op'>=</span> <span class='va'>Ozone</span><span class='op'>)</span>, <span class='va'>Month</span>, <span class='va'>Temp</span>, <span class='st'>"replace"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day Wind_var Ozone_var
#&gt; 1    41     190  7.4   67     5   1 12.08975  533.2819
#&gt; 2    36     118  8.0   72     5   2 12.08975  533.2819
#&gt; 3    12     149 12.6   74     5   3 12.08975  533.2819
#&gt; 4    18     313 11.5   62     5   4 12.08975  533.2819
#&gt; 5    NA      NA 14.3   56     5   5 12.08975        NA
#&gt; 6    28      NA 14.9   66     5   6 12.08975  533.2819</div><div class='input'>
<span class='co'># Same as above using a grouped data frame (a bit more complex)</span>
<span class='va'>airquality</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>Month</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ftransform</span><span class='op'>(</span><span class='fu'><a href='fselect, get_vars, add_vars.html'>fselect</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>Wind</span>, <span class='va'>Ozone</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fvar, fsd.html'>fvar</a></span><span class='op'>(</span><span class='va'>Temp</span>, <span class='st'>"replace"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='AA2-small-helpers.html'>add_stub</a></span><span class='op'>(</span><span class='st'>"_var"</span>, <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='va'>fungroup</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day Wind_var Ozone_var
#&gt; 1    41     190  7.4   67     5   1 12.08975  533.2819
#&gt; 2    36     118  8.0   72     5   2 12.08975  533.2819
#&gt; 3    12     149 12.6   74     5   3 12.08975  533.2819
#&gt; 4    18     313 11.5   62     5   4 12.08975  533.2819
#&gt; 5    NA      NA 14.3   56     5   5 12.08975        NA
#&gt; 6    28      NA 14.9   66     5   6 12.08975  533.2819</div><div class='input'>
<span class='co'># This performs 2 different multi-column grouped operations (need c() to make it one list)</span>
<span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='fmedian.html'>fmedian</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Wind_Day_median <span class='op'>=</span> <span class='va'>Wind</span>,
                                      Ozone_Day_median <span class='op'>=</span> <span class='va'>Ozone</span><span class='op'>)</span>, <span class='va'>Day</span>, TRA <span class='op'>=</span> <span class='st'>"replace"</span><span class='op'>)</span>,
                         <span class='fu'><a href='fvar, fsd.html'>fsd</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Wind_Month_sd <span class='op'>=</span> <span class='va'>Wind</span>,
                                  Ozone_Month_sd <span class='op'>=</span> <span class='va'>Ozone</span><span class='op'>)</span>, <span class='va'>Month</span>, TRA <span class='op'>=</span> <span class='st'>"replace"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day Wind_Day_median Ozone_Day_median
#&gt; 1    41     190  7.4   67     5   1             6.9             68.5
#&gt; 2    36     118  8.0   72     5   2             9.2             42.5
#&gt; 3    12     149 12.6   74     5   3             9.2             24.0
#&gt; 4    18     313 11.5   62     5   4             9.2             78.0
#&gt; 5    NA      NA 14.3   56     5   5             7.4               NA
#&gt; 6    28      NA 14.9   66     5   6            14.3             36.0
#&gt;   Wind_Month_sd Ozone_Month_sd
#&gt; 1       3.53145       22.22445
#&gt; 2       3.53145       22.22445
#&gt; 3       3.53145       22.22445
#&gt; 4       3.53145       22.22445
#&gt; 5       3.53145             NA
#&gt; 6       3.53145       22.22445</div><div class='input'>
<span class='co'>## settransform(v) works like ftransform(v) but modifies a data frame in the global environment..</span>
<span class='fu'>settransform</span><span class='op'>(</span><span class='va'>airquality</span>, Ratio <span class='op'>=</span> <span class='va'>Ozone</span> <span class='op'>/</span> <span class='va'>Temp</span>, Ozone <span class='op'>=</span> <span class='cn'>NULL</span>, Temp <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Solar.R Wind Month Day     Ratio
#&gt; 1     190  7.4     5   1 0.6119403
#&gt; 2     118  8.0     5   2 0.5000000
#&gt; 3     149 12.6     5   3 0.1621622
#&gt; 4     313 11.5     5   4 0.2903226
#&gt; 5      NA 14.3     5   5        NA
#&gt; 6      NA 14.9     5   6 0.4242424</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>

<span class='co'># Grouped and weighted centering</span>
<span class='fu'>settransformv</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='va'>fwithin</span>, <span class='va'>Month</span>, <span class='va'>Temp</span>, apply <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       Ozone    Solar.R        Wind Temp Month Day
#&gt; 1  16.22536   3.571669 -4.08917323   67     5   1
#&gt; 2  11.22536 -68.428331 -3.48917323   72     5   2
#&gt; 3 -12.77464 -37.428331  1.11082677   74     5   3
#&gt; 4  -6.77464 126.571669  0.01082677   62     5   4
#&gt; 5        NA         NA  2.81082677   56     5   5
#&gt; 6   3.22536         NA  3.41082677   66     5   6</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>
 
<span class='co'># Suitably lagged first-differences</span>
<span class='fu'>settransform</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fu'><a href='fselect, get_vars, add_vars.html'>get_vars</a></span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>fdiff</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='flag.html'>flag</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day L1.Ozone L2.Ozone L1.Solar.R L2.Solar.R
#&gt; 1    NA      NA   NA   67     5   1       NA       NA         NA         NA
#&gt; 2    -5     -72  0.6   72     5   2       NA       NA         NA         NA
#&gt; 3   -24      31  4.6   74     5   3       -5       NA        -72         NA
#&gt; 4     6     164 -1.1   62     5   4      -24       -5         31        -72
#&gt; 5    NA      NA  2.8   56     5   5        6      -24        164         31
#&gt; 6    NA      NA  0.6   66     5   6       NA        6         NA        164
#&gt;   L1.Wind L2.Wind
#&gt; 1      NA      NA
#&gt; 2      NA      NA
#&gt; 3     0.6      NA
#&gt; 4     4.6     0.6
#&gt; 5    -1.1     4.6
#&gt; 6     2.8    -1.1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>

<span class='co'># Same as above using magrittr::`%&lt;&gt;%`</span>
<span class='va'>airquality</span> <span class='op'>%&lt;&gt;%</span> <span class='fu'>ftransform</span><span class='op'>(</span><span class='fu'><a href='fselect, get_vars, add_vars.html'>get_vars</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>fdiff</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='flag.html'>flag</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day L1.Ozone L2.Ozone L1.Solar.R L2.Solar.R
#&gt; 1    NA      NA   NA   67     5   1       NA       NA         NA         NA
#&gt; 2    -5     -72  0.6   72     5   2       NA       NA         NA         NA
#&gt; 3   -24      31  4.6   74     5   3       -5       NA        -72         NA
#&gt; 4     6     164 -1.1   62     5   4      -24       -5         31        -72
#&gt; 5    NA      NA  2.8   56     5   5        6      -24        164         31
#&gt; 6    NA      NA  0.6   66     5   6       NA        6         NA        164
#&gt;   L1.Wind L2.Wind
#&gt; 1      NA      NA
#&gt; 2      NA      NA
#&gt; 3     0.6      NA
#&gt; 4     4.6     0.6
#&gt; 5    -1.1     4.6
#&gt; 6     2.8    -1.1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>

<span class='co'># It is also possible to achieve the same thing via a replacement method (if needed)</span>
<span class='fu'>ftransform</span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fselect, get_vars, add_vars.html'>get_vars</a></span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>fdiff</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='flag.html'>flag</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Temp Month Day L1.Ozone L2.Ozone L1.Solar.R L2.Solar.R
#&gt; 1    NA      NA   NA   67     5   1       NA       NA         NA         NA
#&gt; 2    -5     -72  0.6   72     5   2       NA       NA         NA         NA
#&gt; 3   -24      31  4.6   74     5   3       -5       NA        -72         NA
#&gt; 4     6     164 -1.1   62     5   4      -24       -5         31        -72
#&gt; 5    NA      NA  2.8   56     5   5        6      -24        164         31
#&gt; 6    NA      NA  0.6   66     5   6       NA        6         NA        164
#&gt;   L1.Wind L2.Wind
#&gt; 1      NA      NA
#&gt; 2      NA      NA
#&gt; 3     0.6      NA
#&gt; 4     4.6     0.6
#&gt; 5    -1.1     4.6
#&gt; 6     2.8    -1.1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>

<span class='co'>## fcompute only returns the modified / computed columns, ...</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>fcompute</span><span class='op'>(</span><span class='va'>airquality</span>, Ozone <span class='op'>=</span> <span class='op'>-</span><span class='va'>Ozone</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone
#&gt; 1   -41
#&gt; 2   -36
#&gt; 3   -12
#&gt; 4   -18
#&gt; 5    NA
#&gt; 6   -28</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>fcompute</span><span class='op'>(</span><span class='va'>airquality</span>, new <span class='op'>=</span> <span class='op'>-</span><span class='va'>Ozone</span>, Temp <span class='op'>=</span> <span class='op'>(</span><span class='va'>Temp</span><span class='op'>-</span><span class='fl'>32</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>1.8</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   new     Temp
#&gt; 1 -41 19.44444
#&gt; 2 -36 22.22222
#&gt; 3 -12 23.33333
#&gt; 4 -18 16.66667
#&gt; 5  NA 13.33333
#&gt; 6 -28 18.88889</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>fcompute</span><span class='op'>(</span><span class='va'>airquality</span>, new <span class='op'>=</span> <span class='op'>-</span><span class='va'>Ozone</span>, new2 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   new new2
#&gt; 1 -41    1
#&gt; 2 -36    1
#&gt; 3 -12    1
#&gt; 4 -18    1
#&gt; 5  NA    1
#&gt; 6 -28    1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


