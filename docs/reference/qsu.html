<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon">
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast (Grouped, Weighted) Summary Statistics for Cross-Sectional and Panel Data — qsu • collapse</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fast (Grouped, Weighted) Summary Statistics for Cross-Sectional and Panel Data — qsu" />
<meta property="og:description" content="qsu, shorthand for quick-summary, is an extremely fast summary command inspired by the (xt)summarize command in the STATA statistical software.
It computes a set of 7 statistics (nobs, mean, sd, min, max, skewness and kurtosis) using a numerically stable one-pass method generalized from Welford's Algorithm. Statistics can be computed weighted, by groups, and also within-and between entities (for panel data, see Details)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/">Blog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/collapse_R">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast (Grouped, Weighted) Summary Statistics for Cross-Sectional and Panel Data</h1>
    
    <div class="hidden name"><code>qsu.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>qsu</code>, shorthand for quick-summary, is an extremely fast summary command inspired by the (xt)summarize command in the STATA statistical software.</p>
<p>It computes a set of 7 statistics (nobs, mean, sd, min, max, skewness and kurtosis) using a numerically stable one-pass method generalized from Welford's Algorithm. Statistics can be computed weighted, by groups, and also within-and between entities (for panel data, see Details).</p>
    </div>

    <pre class="usage"><span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span>, g <span class='op'>=</span> <span class='cn'>NULL</span>, pid <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, higher <span class='op'>=</span> <span class='cn'>FALSE</span>,
    array <span class='op'>=</span> <span class='cn'>TRUE</span>, stable.algo <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for matrix</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span>, g <span class='op'>=</span> <span class='cn'>NULL</span>, pid <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, higher <span class='op'>=</span> <span class='cn'>FALSE</span>,
    array <span class='op'>=</span> <span class='cn'>TRUE</span>, stable.algo <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, pid <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, cols <span class='op'>=</span> <span class='cn'>NULL</span>, higher <span class='op'>=</span> <span class='cn'>FALSE</span>,
    array <span class='op'>=</span> <span class='cn'>TRUE</span>, vlabels <span class='op'>=</span> <span class='cn'>FALSE</span>, stable.algo <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># Methods for indexed data / compatibility with plm:</span>

<span class='co'># S3 method for pseries</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span>, g <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, effect <span class='op'>=</span> <span class='fl'>1L</span>, higher <span class='op'>=</span> <span class='cn'>FALSE</span>,
    array <span class='op'>=</span> <span class='cn'>TRUE</span>, stable.algo <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for pdata.frame</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, cols <span class='op'>=</span> <span class='cn'>NULL</span>, effect <span class='op'>=</span> <span class='fl'>1L</span>, higher <span class='op'>=</span> <span class='cn'>FALSE</span>,
    array <span class='op'>=</span> <span class='cn'>TRUE</span>, vlabels <span class='op'>=</span> <span class='cn'>FALSE</span>, stable.algo <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># Methods for compatibility with sf:</span>

<span class='co'># S3 method for sf</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, pid <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, cols <span class='op'>=</span> <span class='cn'>NULL</span>, higher <span class='op'>=</span> <span class='cn'>FALSE</span>,
    array <span class='op'>=</span> <span class='cn'>TRUE</span>, vlabels <span class='op'>=</span> <span class='cn'>FALSE</span>, stable.algo <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>


<span class='co'># S3 method for qsu</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, digits <span class='op'>=</span> <span class='fl'>4</span>, nonsci.digits <span class='op'>=</span> <span class='fl'>9</span>, na.print <span class='op'>=</span> <span class='st'>"-"</span>,
      return <span class='op'>=</span> <span class='cn'>FALSE</span>, print.gap <span class='op'>=</span> <span class='fl'>2</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a vector, matrix, data frame, 'indexed_series' ('pseries') or 'indexed_frame' ('pdata.frame').</p></td>
    </tr>
    <tr>
      <th>g</th>
      <td><p>a factor, <code><a href='GRP.html'>GRP</a></code> object, atomic vector (internally converted to factor) or a list of vectors / factors (internally converted to a <code><a href='GRP.html'>GRP</a></code> object) used to group <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p><em>(p)data.frame method</em>: Same as <code>g</code>, but also allows one- or two-sided formulas i.e. <code>~ group1 + group2</code> or <code>var1 + var2 ~ group1 + group2</code>. See Examples.</p></td>
    </tr>
    <tr>
      <th>pid</th>
      <td><p>same input as <code>g/by</code>: Specify a panel-identifier to also compute statistics on between- and within- transformed data. Data frame method also supports one- or two-sided formulas. Transformations are taken independently from grouping with <code>g/by</code> (grouped statistics are computed on the transformed data if <code>g/by</code> is also used). However, passing any LHS variables to <code>pid</code> will overwrite any <code>LHS</code> variables passed to <code>by</code>.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>a vector of (non-negative) weights. Adding weights will compute the weighted mean, sd, skewness and kurtosis, and transform the data using weighted individual means if <code>pid</code> is used.</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>select columns to summarize using column names, indices, a logical vector or a function (e.g. <code>is.numeric</code>). Two-sided formulas passed to <code>by</code> or <code>pid</code> overwrite <code>cols</code>.</p></td>
    </tr>
    <tr>
      <th>higher</th>
      <td><p>logical. Add higher moments (skewness and kurtosis).</p></td>
    </tr>
    <tr>
      <th>array</th>
      <td><p>logical. If computations have more than 2 dimensions (up to a maximum of 4D: variables, statistics, groups and panel-decomposition) <code>TRUE</code> returns an array, while <code>FALSE</code> returns a (nested) list of matrices.</p></td>
    </tr>
    <tr>
      <th>stable.algo</th>
      <td><p>logical. <code>FALSE</code> uses a faster but less stable method to calculate the standard deviation (see Details of <code><a href='fvar-fsd.html'>fsd</a></code>). Only available if <code>w = NULL</code> and <code>higher = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>vlabels</th>
      <td><p>logical <code>TRUE</code> or a function: to display variable labels in the summary. See Details.</p></td>
    </tr>
    <tr>
      <th>effect</th>
      <td><p><em>plm</em> methods: Select which panel identifier should be used for between and within transformations of the data. 1L takes the first variable in the <a href='indexing.html'>index</a>, 2L the second etc.. Index variables can also be called by name using a character string. More than one variable can be supplied.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments to be passed to or from other methods.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>the number of digits to print after the comma/dot.</p></td>
    </tr>
    <tr>
      <th>nonsci.digits</th>
      <td><p>the number of digits to print before resorting to scientific notation (default is to print out numbers with up to 9 digits and print larger numbers scientifically).</p></td>
    </tr>
    <tr>
      <th>na.print</th>
      <td><p>character string to substitute for missing values.</p></td>
    </tr>
    <tr>
      <th>return</th>
      <td><p>logical. Don't print but instead return the formatted object.</p></td>
    </tr>
    <tr>
      <th>print.gap</th>
      <td><p>integer. Spacing between printed columns. Passed to <code>print.default</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The algorithm used to compute statistics is well described <a href='https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance'>here</a> [see sections <em>Welford's online algorithm</em>, <em>Weighted incremental algorithm</em> and <em>Higher-order statistics</em>. Skewness and kurtosis are calculated as described in <em>Higher-order statistics</em> and are mathematically identical to those implemented in the <em>moments</em> package. Just note that <code>qsu</code> computes the kurtosis (like <code>momens::kurtosis</code>), not the excess-kurtosis (=  kurtosis - 3) defined in <em>Higher-order statistics</em>. The <em>Weighted incremental algorithm</em> described can easily be generalized to higher-order statistics].</p>
<p>Grouped computations specified with <code>g/by</code> are carried out extremely efficiently as in <code>fsum</code> (in a single pass, without splitting the data).</p>
<p>If <code>pid</code> is used, <code>qsu</code> performs a panel-decomposition of each variable and computes 3 sets of statistics: Statistics computed on the 'Overall' (raw) data, statistics computed on the 'Between' - transformed (pid - averaged) data, and statistics computed on the 'Within' - transformed (pid - demeaned) data.</p>
<p>More formally, let <b><code>x</code></b> (bold) be a panel vector of data for <code>N</code> individuals indexed by <code>i</code>, recorded for <code>T</code> periods, indexed by <code>t</code>. <code>xit</code> then denotes a single data-point belonging to individual <code>i</code> in time-period <code>t</code> (<code>t/T</code> must not represent time). Then <code>xi.</code> denotes the average of all values for individual <code>i</code> (averaged over <code>t</code>), and by extension <b><code>xN.</code></b> is the vector (length <code>N</code>) of such averages for all individuals. If no groups are supplied to <code>g/by</code>, the 'Between' statistics are computed on <b><code>xN.</code></b>, the vector of individual averages. (This means that for a non-balanced panel or in the presence of missing values, the 'Overall' mean computed on <b><code>x</code></b> can be slightly different than the 'Between' mean computed on <b><code>xN.</code></b>, and the variance decomposition is not exact). If groups are supplied to <code>g/by</code>, <b><code>xN.</code></b> is expanded to the vector <b><code>xi.</code></b> (length <code>N x T</code>) by replacing each value <code>xit</code> in <b><code>x</code></b> with <code>xi.</code>, while preserving missing values in <b><code>x</code></b>. Grouped Between-statistics are then computed on <b><code>xi.</code></b>, with the only difference that the number of observations ('Between-N') reported for each group is the number of distinct non-missing values of <b><code>xi.</code></b> in each group (not the total number of non-missing values of <b><code>xi.</code></b> in each group, which is already reported in 'Overall-N'). See Examples.</p>
<p>'Within' statistics are always computed on the vector <b><code>x - xi. + x..</code></b>, where <b><code>x..</code></b> is simply the 'Overall' mean computed from <b><code>x</code></b>, which is added back to preserve the level of the data. The 'Within' mean computed on this data will always be identical to the 'Overall' mean. In the summary output, <code>qsu</code> reports not 'N', which would be identical to the 'Overall-N', but 'T', the average number of time-periods of data available for each individual obtained as 'T' = 'Overall-N / 'Between-N'. See Examples.</p>
<p>Apart from 'N/T' and the extrema, the standard-deviations ('SD') computed on between- and within- transformed data are extremely valuable because they indicate how much of the variation in a panel-variable is between-individuals and how much of the variation is within-individuals (over time). At the extremes, variables that have common values across individuals (such as the time-variable(s) 't' in a balanced panel), can readily be identified as individual-invariant because the 'Between-SD' on this variable is 0 and the 'Within-SD' is equal to the 'Overall-SD'. Analogous, time-invariant individual characteristics (such as the individual-id 'i') have a 0 'Within-SD' and a 'Between-SD' equal to the 'Overall-SD'. See Examples.</p>
<p>For data frame methods, if <code>vlabels = TRUE</code>, <code>qsu</code> uses <code>function(x) paste(names(x), setv(vlabels(x), NA, ""), sep = ": ")</code> to combine variable names and labels for display. Alternatively, the user can pass a custom function which will be applied to the data frame, e.g. using <code>vlabels = vlabels</code> just displays the labels. See also <code><a href='small-helpers.html'>vlabels</a></code>.</p>
<p><code>qsu</code> comes with it's own print method which by default writes out up to 9 digits at 4 decimal places. Larger numbers are printed in scientific format. for numbers between 7 and 9 digits, an apostrophe (') is placed after the 6th digit to designate the millions. Missing values are printed using '-'.</p>
<p>The <em>sf</em> method simply ignores the geometry column.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector, matrix, array or list of matrices of summary statistics. All matrices and arrays have a class 'qsu' and a class 'table' attached.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>In weighted summaries, observations with missing or zero weights are skipped, and thus do not affect any of the calculated statistics, including the observation count. This also implies that a logical vector passed to <code>w</code> can be used to efficiently summarize a subset of the data.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Welford, B. P. (1962). Note on a method for calculating corrected sums of squares and products. <em>Technometrics</em>. 4 (3): 419-420. doi:10.2307/1266577.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If weights <code>w</code> are used together with <code>pid</code>, transformed data is computed using weighted individual means i.e. weighted <b><code>xi.</code></b> and weighted <b><code>x..</code></b>. Weighted statistics are subsequently computed on this weighted-transformed data.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='descr.html'>descr</a></code>, <a href='summary-statistics.html'>Summary Statistics</a>, <a href='fast-statistical-functions.html'>Fast Statistical Functions</a>, <a href='index.html'>Collapse Overview</a>  <!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ --></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## World Development Panel Data</span>
<span class='co'># Simple Summaries -------------------------</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span><span class='op'>)</span>                                 <span class='co'># Simple summary</span>
</div><div class='output co'>#&gt;              N         Mean          SD          Min             Max
#&gt; country  13176            -           -            -               -
#&gt; iso3c    13176            -           -            -               -
#&gt; date     13176            -           -            -               -
#&gt; year     13176         1990     17.6075         1960            2020
#&gt; decade   13176    1985.5738     17.5117         1960            2020
#&gt; region   13176            -           -            -               -
#&gt; income   13176            -           -            -               -
#&gt; OECD     13176            -           -            -               -
#&gt; PCGDP     9470    12048.778  19077.6416     132.0776      196061.417
#&gt; LIFEEX   11670      64.2963     11.4764       18.907         85.4171
#&gt; GINI      1744      38.5341      9.2006         20.7            65.8
#&gt; ODA       8608   454'720131  868'712654  -997'679993  2.56715605e+10
#&gt; POP      12919  24'245971.6  102'120674         2833  1.39771500e+09</div><div class='input'><span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, vlabels <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>                 <span class='co'># Display variable labels</span>
</div><div class='output co'>#&gt;                                                                                             N
#&gt; country: Country Name                                                                   13176
#&gt; iso3c: Country Code                                                                     13176
#&gt; date: Date Recorded (Fictitious)                                                        13176
#&gt; year: Year                                                                              13176
#&gt; decade: Decade                                                                          13176
#&gt; region: Region                                                                          13176
#&gt; income: Income Level                                                                    13176
#&gt; OECD: Is OECD Member Country?                                                           13176
#&gt; PCGDP: GDP per capita (constant 2010 US$)                                                9470
#&gt; LIFEEX: Life expectancy at birth, total (years)                                         11670
#&gt; GINI: Gini index (World Bank estimate)                                                   1744
#&gt; ODA: Net official development assistance and official aid received (constant 2018 US$)   8608
#&gt; POP: Population, total                                                                  12919
#&gt;                                                                                                Mean
#&gt; country: Country Name                                                                             -
#&gt; iso3c: Country Code                                                                               -
#&gt; date: Date Recorded (Fictitious)                                                                  -
#&gt; year: Year                                                                                     1990
#&gt; decade: Decade                                                                            1985.5738
#&gt; region: Region                                                                                    -
#&gt; income: Income Level                                                                              -
#&gt; OECD: Is OECD Member Country?                                                                     -
#&gt; PCGDP: GDP per capita (constant 2010 US$)                                                 12048.778
#&gt; LIFEEX: Life expectancy at birth, total (years)                                             64.2963
#&gt; GINI: Gini index (World Bank estimate)                                                      38.5341
#&gt; ODA: Net official development assistance and official aid received (constant 2018 US$)   454'720131
#&gt; POP: Population, total                                                                  24'245971.6
#&gt;                                                                                                 SD
#&gt; country: Country Name                                                                            -
#&gt; iso3c: Country Code                                                                              -
#&gt; date: Date Recorded (Fictitious)                                                                 -
#&gt; year: Year                                                                                 17.6075
#&gt; decade: Decade                                                                             17.5117
#&gt; region: Region                                                                                   -
#&gt; income: Income Level                                                                             -
#&gt; OECD: Is OECD Member Country?                                                                    -
#&gt; PCGDP: GDP per capita (constant 2010 US$)                                               19077.6416
#&gt; LIFEEX: Life expectancy at birth, total (years)                                            11.4764
#&gt; GINI: Gini index (World Bank estimate)                                                      9.2006
#&gt; ODA: Net official development assistance and official aid received (constant 2018 US$)  868'712654
#&gt; POP: Population, total                                                                  102'120674
#&gt;                                                                                                 Min
#&gt; country: Country Name                                                                             -
#&gt; iso3c: Country Code                                                                               -
#&gt; date: Date Recorded (Fictitious)                                                                  -
#&gt; year: Year                                                                                     1960
#&gt; decade: Decade                                                                                 1960
#&gt; region: Region                                                                                    -
#&gt; income: Income Level                                                                              -
#&gt; OECD: Is OECD Member Country?                                                                     -
#&gt; PCGDP: GDP per capita (constant 2010 US$)                                                  132.0776
#&gt; LIFEEX: Life expectancy at birth, total (years)                                              18.907
#&gt; GINI: Gini index (World Bank estimate)                                                         20.7
#&gt; ODA: Net official development assistance and official aid received (constant 2018 US$)  -997'679993
#&gt; POP: Population, total                                                                         2833
#&gt;                                                                                                    Max
#&gt; country: Country Name                                                                                -
#&gt; iso3c: Country Code                                                                                  -
#&gt; date: Date Recorded (Fictitious)                                                                     -
#&gt; year: Year                                                                                        2020
#&gt; decade: Decade                                                                                    2020
#&gt; region: Region                                                                                       -
#&gt; income: Income Level                                                                                 -
#&gt; OECD: Is OECD Member Country?                                                                        -
#&gt; PCGDP: GDP per capita (constant 2010 US$)                                                   196061.417
#&gt; LIFEEX: Life expectancy at birth, total (years)                                                85.4171
#&gt; GINI: Gini index (World Bank estimate)                                                            65.8
#&gt; ODA: Net official development assistance and official aid received (constant 2018 US$)  2.56715605e+10
#&gt; POP: Population, total                                                                  1.39771500e+09</div><div class='input'><span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, higher <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>                  <span class='co'># Add skewness and kurtosis</span>
</div><div class='output co'>#&gt;              N         Mean          SD          Min             Max     Skew
#&gt; country  13176            -           -            -               -        -
#&gt; iso3c    13176            -           -            -               -        -
#&gt; date     13176            -           -            -               -        -
#&gt; year     13176         1990     17.6075         1960            2020       -0
#&gt; decade   13176    1985.5738     17.5117         1960            2020   0.0326
#&gt; region   13176            -           -            -               -        -
#&gt; income   13176            -           -            -               -        -
#&gt; OECD     13176            -           -            -               -        -
#&gt; PCGDP     9470    12048.778  19077.6416     132.0776      196061.417   3.1276
#&gt; LIFEEX   11670      64.2963     11.4764       18.907         85.4171  -0.6748
#&gt; GINI      1744      38.5341      9.2006         20.7            65.8    0.596
#&gt; ODA       8608   454'720131  868'712654  -997'679993  2.56715605e+10   6.9832
#&gt; POP      12919  24'245971.6  102'120674         2833  1.39771500e+09   9.7494
#&gt;              Kurt
#&gt; country         -
#&gt; iso3c           -
#&gt; date            -
#&gt; year       1.7994
#&gt; decade     1.7917
#&gt; region          -
#&gt; income          -
#&gt; OECD            -
#&gt; PCGDP     17.1154
#&gt; LIFEEX     2.6718
#&gt; GINI       2.5329
#&gt; ODA       114.889
#&gt; POP      108.9066</div><div class='input'>
<span class='co'># Grouped Summaries ------------------------</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>region</span>, vlabels <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>       <span class='co'># Statistics by World Bank Region</span>
</div><div class='output co'>#&gt; , , country: Country Name
#&gt; 
#&gt;                                N  Mean  SD  Min  Max
#&gt; East Asia &amp; Pacific         2196     -   -    -    -
#&gt; Europe &amp; Central Asia       3538     -   -    -    -
#&gt; Latin America &amp; Caribbean   2562     -   -    -    -
#&gt; Middle East &amp; North Africa  1281     -   -    -    -
#&gt; North America                183     -   -    -    -
#&gt; South Asia                   488     -   -    -    -
#&gt; Sub-Saharan Africa          2928     -   -    -    -
#&gt; 
#&gt; , , iso3c: Country Code
#&gt; 
#&gt;                                N  Mean  SD  Min  Max
#&gt; East Asia &amp; Pacific         2196     -   -    -    -
#&gt; Europe &amp; Central Asia       3538     -   -    -    -
#&gt; Latin America &amp; Caribbean   2562     -   -    -    -
#&gt; Middle East &amp; North Africa  1281     -   -    -    -
#&gt; North America                183     -   -    -    -
#&gt; South Asia                   488     -   -    -    -
#&gt; Sub-Saharan Africa          2928     -   -    -    -
#&gt; 
#&gt; , , date: Date Recorded (Fictitious)
#&gt; 
#&gt;                                N  Mean  SD  Min  Max
#&gt; East Asia &amp; Pacific         2196     -   -    -    -
#&gt; Europe &amp; Central Asia       3538     -   -    -    -
#&gt; Latin America &amp; Caribbean   2562     -   -    -    -
#&gt; Middle East &amp; North Africa  1281     -   -    -    -
#&gt; North America                183     -   -    -    -
#&gt; South Asia                   488     -   -    -    -
#&gt; 
#&gt;  [ reached getOption("max.print") -- omitted 1 row(s) and 9 matrix slice(s) ]</div><div class='input'><span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>PCGDP</span> <span class='op'>+</span> <span class='va'>LIFEEX</span> <span class='op'>~</span> <span class='va'>income</span><span class='op'>)</span>        <span class='co'># Summarize GDP per Capita and Life Expectancy by</span>
</div><div class='output co'>#&gt; , , PCGDP
#&gt; 
#&gt;                         N        Mean          SD       Min         Max
#&gt; High income          3179  30280.7283  23847.0483  932.0417  196061.417
#&gt; Low income           1311    597.4053    288.4392  164.3366   1864.7925
#&gt; Lower middle income  2246   1574.2535    858.7183  144.9863   4818.1922
#&gt; Upper middle income  2734   4945.3258   2979.5609  132.0776  20532.9523
#&gt; 
#&gt; , , LIFEEX
#&gt; 
#&gt;                         N     Mean      SD     Min      Max
#&gt; High income          3831  73.6246  5.6693  42.672  85.4171
#&gt; Low income           1800  49.7301  9.0944  26.172    74.43
#&gt; Lower middle income  2790  58.1481  9.3115  18.907   76.699
#&gt; Upper middle income  3249  66.6466   7.537  36.535   80.279
#&gt; </div><div class='input'><span class='va'>stats</span> <span class='op'>&lt;-</span> <span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>region</span> <span class='op'>+</span> <span class='va'>income</span>,     <span class='co'># World Bank Income Level</span>
             cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>10</span>, higher <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>    <span class='co'># Same variables, by both region and income</span>
<span class='fu'><a href='https://rdrr.io/r/base/aperm.html'>aperm</a></span><span class='op'>(</span><span class='va'>stats</span><span class='op'>)</span>                                <span class='co'># A different perspective on the same stats</span>
</div><div class='output co'>#&gt; , , East Asia &amp; Pacific.High income
#&gt; 
#&gt;           N        Mean          SD       Min         Max     Skew    Kurt
#&gt; PCGDP   487  26766.9163  14823.5175  932.0417  71992.1517   0.2811  2.5566
#&gt; LIFEEX  664     73.3724       6.659     54.81      85.078  -0.4945  2.6876
#&gt; 
#&gt; , , East Asia &amp; Pacific.Lower middle income
#&gt; 
#&gt;           N       Mean        SD       Min        Max     Skew    Kurt
#&gt; PCGDP   562  1599.4748  895.5278  144.9863  4503.1454   0.4987  3.0945
#&gt; LIFEEX  780    59.1597    9.6542    18.907       75.4  -1.0076  4.1679
#&gt; 
#&gt; , , East Asia &amp; Pacific.Upper middle income
#&gt; 
#&gt;           N       Mean         SD       Min         Max     Skew    Kurt
#&gt; PCGDP   418  3561.0911  2468.1843  132.0776  12486.6788   1.4194    4.89
#&gt; LIFEEX  363    66.9366     5.6713    43.725       77.15  -0.9194  4.8567
#&gt; 
#&gt; , , Europe &amp; Central Asia.High income
#&gt; 
#&gt;            N        Mean          SD        Min         Max    Skew     Kurt
#&gt; PCGDP   1551  35718.5696  26466.4643  4500.7362  196061.417  2.2834  10.2728
#&gt; LIFEEX  1845     74.8234      4.3845    63.0749     85.4171   0.042   2.1824
#&gt; 
#&gt; , , Europe &amp; Central Asia.Low income
#&gt; 
#&gt;          N      Mean        SD       Min        Max    Skew    Kurt
#&gt; PCGDP   35  809.4753  336.5425  366.9354  1458.9932   0.426  1.9987
#&gt; LIFEEX  60   60.1129     6.147    50.613     71.097  0.3991  1.9875
#&gt; 
#&gt; , , Europe &amp; Central Asia.Lower middle income
#&gt; 
#&gt;           N       Mean        SD       Min        Max     Skew    Kurt
#&gt; PCGDP   125  1804.0338  964.3793  534.9587  4243.7743   0.6386  2.2984
#&gt; LIFEEX  240    66.7943    3.4816   56.1281     71.901  -0.8383    3.22
#&gt; 
#&gt; , , Europe &amp; Central Asia.Upper middle income
#&gt; 
#&gt;           N       Mean         SD       Min         Max     Skew    Kurt
#&gt; PCGDP   532  4979.0901  2720.4775  700.7008  15190.0995   1.0955  4.1706
#&gt; LIFEEX  901     68.946     4.9936    45.369      78.573  -1.1687  5.5764
#&gt; 
#&gt;  [ reached getOption("max.print") -- omitted 16 matrix slice(s) ]</div><div class='input'>
<span class='co'># Panel Data Summaries ---------------------</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, pid <span class='op'>=</span> <span class='op'>~</span> <span class='va'>iso3c</span>, vlabels <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>   <span class='co'># Adding between and within countries statistics</span>
</div><div class='output co'>#&gt; , , country: Country Name
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; Within      61     -   -    -    -
#&gt; 
#&gt; , , date: Date Recorded (Fictitious)
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; Within      61     -   -    -    -
#&gt; 
#&gt; , , year: Year
#&gt; 
#&gt;            N/T  Mean       SD   Min   Max
#&gt; Overall  13176  1990  17.6075  1960  2020
#&gt; Between    216  1990        0  1990  1990
#&gt; Within      61  1990  17.6075  1960  2020
#&gt; 
#&gt; , , decade: Decade
#&gt; 
#&gt;            N/T       Mean       SD        Min        Max
#&gt; Overall  13176  1985.5738  17.5117       1960       2020
#&gt; Between    216  1985.5738        0  1985.5738  1985.5738
#&gt; Within      61  1985.5738  17.5117       1960       2020
#&gt; 
#&gt; , , region: Region
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; Within      61     -   -    -    -
#&gt; 
#&gt; , , income: Income Level
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; Within      61     -   -    -    -
#&gt; 
#&gt; , , OECD: Is OECD Member Country?
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; 
#&gt;  [ reached getOption("max.print") -- omitted 1 row(s) and 5 matrix slice(s) ]</div><div class='input'><span class='co'># -&gt; They show amongst other things that year and decade are individual-invariant,</span>
<span class='co'># that we have GINI-data on only 161 countries, with only 8.42 observations per country on average,</span>
<span class='co'># and that GDP, LIFEEX and GINI vary more between-countries, but ODA received varies more within</span>
<span class='co'># countries over time.</span>

<span class='co'># Let's do this manually for PCGDP:</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>wlddev</span><span class='op'>$</span><span class='va'>PCGDP</span>
<span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>wlddev</span><span class='op'>$</span><span class='va'>iso3c</span>

<span class='co'># This is the exact variance decomposion</span>
<span class='fu'><a href='https://rdrr.io/pkg/data.table/man/all.equal.data.table.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='fvar-fsd.html'>fvar</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='fu'><a href='fvar-fsd.html'>fvar</a></span><span class='op'>(</span><span class='fu'><a href='fbetween-fwithin.html'>B</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>g</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='fvar-fsd.html'>fvar</a></span><span class='op'>(</span><span class='fu'><a href='fbetween-fwithin.html'>W</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>g</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># What qsu does is calculate</span>
<span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/data.table/man/rbindlist.html'>rbind</a></span><span class='op'>(</span>Overall <span class='op'>=</span> <span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
           Between <span class='op'>=</span> <span class='fu'>qsu</span><span class='op'>(</span><span class='fu'><a href='fmean.html'>fmean</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>g</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'># Aggregation instead of between-transform</span>
           Within <span class='op'>=</span> <span class='fu'>qsu</span><span class='op'>(</span><span class='fu'><a href='fbetween-fwithin.html'>fwithin</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>g</span>, mean <span class='op'>=</span> <span class='st'>"overall.mean"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Same as qsu(W(x, g) + fmean(x))</span>
<span class='va'>r</span><span class='op'>[</span><span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>r</span><span class='op'>[</span><span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>]</span>
<span class='fu'>print.qsu</span><span class='op'>(</span><span class='va'>r</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                N        Mean          SD          Min         Max
#&gt; Overall     9470   12048.778  19077.6416     132.0776  196061.417
#&gt; Between      206  12962.6054  20189.9007     253.1886   141200.38
#&gt; Within   45.9709   12048.778   6723.6808  -33504.8721  76767.5254</div><div class='input'><span class='co'># Proof:</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>x</span>, pid <span class='op'>=</span> <span class='va'>g</span><span class='op'>)</span>
</div><div class='output co'>#&gt;              N/T        Mean          SD          Min         Max
#&gt; Overall     9470   12048.778  19077.6416     132.0776  196061.417
#&gt; Between      206  12962.6054  20189.9007     253.1886   141200.38
#&gt; Within   45.9709   12048.778   6723.6808  -33504.8721  76767.5254</div><div class='input'>
<span class='co'># Using indexed data:</span>
<span class='va'>wldi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='indexing.html'>findex_by</a></span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>iso3c</span>, <span class='va'>year</span><span class='op'>)</span>   <span class='co'># Creating a Indexed Data Frame frame from this data</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wldi</span><span class='op'>)</span>                                <span class='co'># Summary for pdata.frame -&gt; qsu(wlddev, pid = ~ iso3c)</span>
</div><div class='output co'>#&gt; , , country
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; Within      61     -   -    -    -
#&gt; 
#&gt; , , iso3c
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; Within      61     -   -    -    -
#&gt; 
#&gt; , , date
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; Within      61     -   -    -    -
#&gt; 
#&gt; , , year
#&gt; 
#&gt;            N/T  Mean       SD   Min   Max
#&gt; Overall  13176  1990  17.6075  1960  2020
#&gt; Between    216  1990        0  1990  1990
#&gt; Within      61  1990  17.6075  1960  2020
#&gt; 
#&gt; , , decade
#&gt; 
#&gt;            N/T       Mean       SD        Min        Max
#&gt; Overall  13176  1985.5738  17.5117       1960       2020
#&gt; Between    216  1985.5738        0  1985.5738  1985.5738
#&gt; Within      61  1985.5738  17.5117       1960       2020
#&gt; 
#&gt; , , region
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; Within      61     -   -    -    -
#&gt; 
#&gt; , , income
#&gt; 
#&gt;            N/T  Mean  SD  Min  Max
#&gt; Overall  13176     -   -    -    -
#&gt; Between    216     -   -    -    -
#&gt; 
#&gt;  [ reached getOption("max.print") -- omitted 1 row(s) and 6 matrix slice(s) ]</div><div class='input'><span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wldi</span><span class='op'>$</span><span class='va'>PCGDP</span><span class='op'>)</span>                          <span class='co'># Default summary for Panel Series</span>
</div><div class='output co'>#&gt;              N/T        Mean          SD          Min         Max
#&gt; Overall     9470   12048.778  19077.6416     132.0776  196061.417
#&gt; Between      206  12962.6054  20189.9007     253.1886   141200.38
#&gt; Within   45.9709   12048.778   6723.6808  -33504.8721  76767.5254</div><div class='input'><span class='fu'>qsu</span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>wldi</span><span class='op'>$</span><span class='va'>PCGDP</span><span class='op'>)</span><span class='op'>)</span>                       <span class='co'># Summarizing GDP growth, see also ?G</span>
</div><div class='output co'>#&gt;              N/T    Mean      SD       Min       Max
#&gt; Overall     9264  2.0762  6.0081  -64.9924  140.3708
#&gt; Between      202  2.0752  1.8684   -7.6806   10.3106
#&gt; Within   45.8614  2.0762   5.785   -67.359  133.0971</div><div class='input'>
<span class='co'># Grouped Panel Data Summaries -------------</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>region</span>, <span class='op'>~</span> <span class='va'>iso3c</span>, cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span> <span class='co'># Panel-Statistics by region</span>
</div><div class='output co'>#&gt; , , Overall, PCGDP
#&gt; 
#&gt;                              N/T        Mean          SD         Min
#&gt; East Asia &amp; Pacific         1467  10513.2441  14383.5507    132.0776
#&gt; Europe &amp; Central Asia       2243  25992.9618  26435.1316    366.9354
#&gt; Latin America &amp; Caribbean   1976   7628.4477   8818.5055   1005.4085
#&gt; Middle East &amp; North Africa   842  13878.4213  18419.7912    578.5996
#&gt; North America                180    48699.76  24196.2855  16405.9053
#&gt; South Asia                   382   1235.9256   1611.2232    265.9625
#&gt; Sub-Saharan Africa          2380   1840.0259   2596.0104    164.3366
#&gt;                                    Max
#&gt; East Asia &amp; Pacific         71992.1517
#&gt; Europe &amp; Central Asia       196061.417
#&gt; Latin America &amp; Caribbean   88391.3331
#&gt; Middle East &amp; North Africa  116232.753
#&gt; North America               113236.091
#&gt; South Asia                    8476.564
#&gt; Sub-Saharan Africa          20532.9523
#&gt; 
#&gt; , , Between, PCGDP
#&gt; 
#&gt;                             N/T        Mean          SD         Min         Max
#&gt; East Asia &amp; Pacific          34  10513.2441   12771.742    444.2899  39722.0077
#&gt; Europe &amp; Central Asia        56  25992.9618   24051.035    809.4753   141200.38
#&gt; Latin America &amp; Caribbean    38   7628.4477   8470.9708   1357.3326  77403.7443
#&gt; Middle East &amp; North Africa   20  13878.4213  17251.6962   1069.6596  64878.4021
#&gt; North America                 3    48699.76  18604.4369  35260.4708  74934.5874
#&gt; South Asia                    8   1235.9256   1488.3669      413.68   6621.5002
#&gt; Sub-Saharan Africa           47   1840.0259   2234.3254    253.1886   9922.0052
#&gt; 
#&gt; , , Within, PCGDP
#&gt; 
#&gt;                                 N/T       Mean          SD          Min
#&gt; East Asia &amp; Pacific         43.1471  12048.778   6615.8248  -11964.6472
#&gt; Europe &amp; Central Asia       40.0536  12048.778  10971.0483  -33504.8721
#&gt; Latin America &amp; Caribbean        52  12048.778   2451.2636    -354.1639
#&gt; Middle East &amp; North Africa     42.1  12048.778   6455.0512  -18674.4049
#&gt; North America                    60  12048.778  15470.4609  -29523.1017
#&gt; South Asia                    47.75  12048.778    617.0934   10026.9155
#&gt;                                    Max
#&gt; East Asia &amp; Pacific          49541.463
#&gt; Europe &amp; Central Asia       76767.5254
#&gt; Latin America &amp; Caribbean   23036.3668
#&gt; Middle East &amp; North Africa  63665.0446
#&gt; North America               50350.2816
#&gt; South Asia                   14455.865
#&gt; 
#&gt;  [ reached getOption("max.print") -- omitted 1 row(s) and 9 matrix slice(s) ]</div><div class='input'><span class='va'>psr</span> <span class='op'>&lt;-</span> <span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wldi</span>, <span class='op'>~</span> <span class='va'>region</span>, cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span>     <span class='co'># Same on indexed data</span>
<span class='va'>psr</span>                                         <span class='co'># -&gt; Gives a 4D array</span>
</div><div class='output co'>#&gt; , , Overall, PCGDP
#&gt; 
#&gt;                              N/T        Mean          SD         Min
#&gt; East Asia &amp; Pacific         1467  10513.2441  14383.5507    132.0776
#&gt; Europe &amp; Central Asia       2243  25992.9618  26435.1316    366.9354
#&gt; Latin America &amp; Caribbean   1976   7628.4477   8818.5055   1005.4085
#&gt; Middle East &amp; North Africa   842  13878.4213  18419.7912    578.5996
#&gt; North America                180    48699.76  24196.2855  16405.9053
#&gt; South Asia                   382   1235.9256   1611.2232    265.9625
#&gt; Sub-Saharan Africa          2380   1840.0259   2596.0104    164.3366
#&gt;                                    Max
#&gt; East Asia &amp; Pacific         71992.1517
#&gt; Europe &amp; Central Asia       196061.417
#&gt; Latin America &amp; Caribbean   88391.3331
#&gt; Middle East &amp; North Africa  116232.753
#&gt; North America               113236.091
#&gt; South Asia                    8476.564
#&gt; Sub-Saharan Africa          20532.9523
#&gt; 
#&gt; , , Between, PCGDP
#&gt; 
#&gt;                             N/T        Mean          SD         Min         Max
#&gt; East Asia &amp; Pacific          34  10513.2441   12771.742    444.2899  39722.0077
#&gt; Europe &amp; Central Asia        56  25992.9618   24051.035    809.4753   141200.38
#&gt; Latin America &amp; Caribbean    38   7628.4477   8470.9708   1357.3326  77403.7443
#&gt; Middle East &amp; North Africa   20  13878.4213  17251.6962   1069.6596  64878.4021
#&gt; North America                 3    48699.76  18604.4369  35260.4708  74934.5874
#&gt; South Asia                    8   1235.9256   1488.3669      413.68   6621.5002
#&gt; Sub-Saharan Africa           47   1840.0259   2234.3254    253.1886   9922.0052
#&gt; 
#&gt; , , Within, PCGDP
#&gt; 
#&gt;                                 N/T       Mean          SD          Min
#&gt; East Asia &amp; Pacific         43.1471  12048.778   6615.8248  -11964.6472
#&gt; Europe &amp; Central Asia       40.0536  12048.778  10971.0483  -33504.8721
#&gt; Latin America &amp; Caribbean        52  12048.778   2451.2636    -354.1639
#&gt; Middle East &amp; North Africa     42.1  12048.778   6455.0512  -18674.4049
#&gt; North America                    60  12048.778  15470.4609  -29523.1017
#&gt; South Asia                    47.75  12048.778    617.0934   10026.9155
#&gt;                                    Max
#&gt; East Asia &amp; Pacific          49541.463
#&gt; Europe &amp; Central Asia       76767.5254
#&gt; Latin America &amp; Caribbean   23036.3668
#&gt; Middle East &amp; North Africa  63665.0446
#&gt; North America               50350.2816
#&gt; South Asia                   14455.865
#&gt; 
#&gt;  [ reached getOption("max.print") -- omitted 1 row(s) and 9 matrix slice(s) ]</div><div class='input'><span class='va'>psr</span><span class='op'>[</span>,<span class='st'>"N/T"</span>,,<span class='op'>]</span>                               <span class='co'># Checking out the number of observations:</span>
</div><div class='output co'>#&gt; , , PCGDP
#&gt; 
#&gt;                             Overall  Between   Within
#&gt; East Asia &amp; Pacific            1467       34  43.1471
#&gt; Europe &amp; Central Asia          2243       56  40.0536
#&gt; Latin America &amp; Caribbean      1976       38       52
#&gt; Middle East &amp; North Africa      842       20     42.1
#&gt; North America                   180        3       60
#&gt; South Asia                      382        8    47.75
#&gt; Sub-Saharan Africa             2380       47  50.6383
#&gt; 
#&gt; , , LIFEEX
#&gt; 
#&gt;                             Overall  Between   Within
#&gt; East Asia &amp; Pacific            1807       32  56.4688
#&gt; Europe &amp; Central Asia          3046       55  55.3818
#&gt; Latin America &amp; Caribbean      2107       40   52.675
#&gt; Middle East &amp; North Africa     1226       21   58.381
#&gt; North America                   144        3       48
#&gt; South Asia                      480        8       60
#&gt; Sub-Saharan Africa             2860       48  59.5833
#&gt; 
#&gt; , , GINI
#&gt; 
#&gt;                             Overall  Between   Within
#&gt; East Asia &amp; Pacific             154       23   6.6957
#&gt; Europe &amp; Central Asia           798       49  16.2857
#&gt; Latin America &amp; Caribbean       413       25    16.52
#&gt; Middle East &amp; North Africa       91       15   6.0667
#&gt; North America                    49        2     24.5
#&gt; South Asia                       46        7   6.5714
#&gt; Sub-Saharan Africa              193       46   4.1957
#&gt; 
#&gt; , , ODA
#&gt; 
#&gt;                             Overall  Between   Within
#&gt; East Asia &amp; Pacific            1537       31  49.5806
#&gt; Europe &amp; Central Asia           787       32  24.5938
#&gt; Latin America &amp; Caribbean      1972       37  53.2973
#&gt; Middle East &amp; North Africa     1105       21   52.619
#&gt; North America                    39        1       39
#&gt; South Asia                      466        8    58.25
#&gt; Sub-Saharan Africa             2702       48  56.2917
#&gt; </div><div class='input'><span class='co'># In North america we only have 3 countries, for the GINI we only have 3.91 observations on average</span>
<span class='co'># for 45 Sub-Saharan-African countries, etc..</span>
<span class='va'>psr</span><span class='op'>[</span>,<span class='st'>"SD"</span>,,<span class='op'>]</span>                                <span class='co'># Considering only standard deviations</span>
</div><div class='output co'>#&gt; , , PCGDP
#&gt; 
#&gt;                                Overall     Between      Within
#&gt; East Asia &amp; Pacific         14383.5507   12771.742   6615.8248
#&gt; Europe &amp; Central Asia       26435.1316   24051.035  10971.0483
#&gt; Latin America &amp; Caribbean    8818.5055   8470.9708   2451.2636
#&gt; Middle East &amp; North Africa  18419.7912  17251.6962   6455.0512
#&gt; North America               24196.2855  18604.4369  15470.4609
#&gt; South Asia                   1611.2232   1488.3669    617.0934
#&gt; Sub-Saharan Africa           2596.0104   2234.3254    1321.764
#&gt; 
#&gt; , , LIFEEX
#&gt; 
#&gt;                             Overall  Between  Within
#&gt; East Asia &amp; Pacific         10.1633   7.6833  6.6528
#&gt; Europe &amp; Central Asia        5.7602   4.4378  3.6723
#&gt; Latin America &amp; Caribbean    7.3768   4.9199  5.4965
#&gt; Middle East &amp; North Africa   9.8306    5.922  7.8467
#&gt; North America                3.5734   1.3589  3.3049
#&gt; South Asia                  11.3004   5.6158  9.8062
#&gt; Sub-Saharan Africa           8.6876    5.657  6.5933
#&gt; 
#&gt; , , GINI
#&gt; 
#&gt;                             Overall  Between  Within
#&gt; East Asia &amp; Pacific          5.0318   4.3005  2.6125
#&gt; Europe &amp; Central Asia        4.5809   4.0611  2.1195
#&gt; Latin America &amp; Caribbean    5.4821   4.0492  3.6955
#&gt; Middle East &amp; North Africa   5.2073   4.7002  2.2415
#&gt; North America                3.6972   3.3563  1.5507
#&gt; South Asia                   3.9898   3.0052  2.6244
#&gt; Sub-Saharan Africa           8.2003   6.8844  4.4553
#&gt; 
#&gt; , , ODA
#&gt; 
#&gt;                                    Overall         Between          Within
#&gt; East Asia &amp; Pacific             622'847624      457'183279      422'992450
#&gt; Europe &amp; Central Asia           568'237036      438'074771      361'916875
#&gt; Latin America &amp; Caribbean       260'781049      167'160838      200'159960
#&gt; Middle East &amp; North Africa  1.52108993e+09      775'418887  1.30860235e+09
#&gt; North America                  10'653560.8               0     10'653560.8
#&gt; South Asia                  1.61492889e+09  1.18347893e+09  1.09880524e+09
#&gt; Sub-Saharan Africa              656'336230      397'995105      521'897637
#&gt; </div><div class='input'><span class='co'># -&gt; In all regions variations in inequality (GINI) between countries are greater than variations</span>
<span class='co'># in inequality within countries. The opposite is true for Life-Expectancy in all regions apart</span>
<span class='co'># from Europe, etc..</span>

<span class='co'># Again let's do this manually for PDGCP:</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>Overall <span class='op'>=</span> <span class='va'>x</span>,
           Between <span class='op'>=</span> <span class='fu'><a href='fbetween-fwithin.html'>fbetween</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>g</span><span class='op'>)</span>,
           Within <span class='op'>=</span> <span class='fu'><a href='fbetween-fwithin.html'>fwithin</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>g</span>, mean <span class='op'>=</span> <span class='st'>"overall.mean"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'>qsu</span><span class='op'>(</span><span class='va'>d</span>, g <span class='op'>=</span> <span class='va'>wlddev</span><span class='op'>$</span><span class='va'>region</span><span class='op'>)</span>
<span class='va'>r</span><span class='op'>[</span>,<span class='st'>"N"</span>,<span class='st'>"Between"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fndistinct.html'>fndistinct</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>wlddev</span><span class='op'>$</span><span class='va'>region</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>r</span><span class='op'>[</span>,<span class='st'>"N"</span>,<span class='st'>"Within"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>[</span>,<span class='st'>"N"</span>,<span class='st'>"Overall"</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>r</span><span class='op'>[</span>,<span class='st'>"N"</span>,<span class='st'>"Between"</span><span class='op'>]</span>
<span class='va'>r</span>
</div><div class='output co'>#&gt; , , Overall
#&gt; 
#&gt;                                N        Mean          SD         Min
#&gt; East Asia &amp; Pacific         1467  10513.2441  14383.5507    132.0776
#&gt; Europe &amp; Central Asia       2243  25992.9618  26435.1316    366.9354
#&gt; Latin America &amp; Caribbean   1976   7628.4477   8818.5055   1005.4085
#&gt; Middle East &amp; North Africa   842  13878.4213  18419.7912    578.5996
#&gt; North America                180    48699.76  24196.2855  16405.9053
#&gt; South Asia                   382   1235.9256   1611.2232    265.9625
#&gt; Sub-Saharan Africa          2380   1840.0259   2596.0104    164.3366
#&gt;                                    Max
#&gt; East Asia &amp; Pacific         71992.1517
#&gt; Europe &amp; Central Asia       196061.417
#&gt; Latin America &amp; Caribbean   88391.3331
#&gt; Middle East &amp; North Africa  116232.753
#&gt; North America               113236.091
#&gt; South Asia                    8476.564
#&gt; Sub-Saharan Africa          20532.9523
#&gt; 
#&gt; , , Between
#&gt; 
#&gt;                              N        Mean          SD         Min         Max
#&gt; East Asia &amp; Pacific         34  10513.2441   12771.742    444.2899  39722.0077
#&gt; Europe &amp; Central Asia       56  25992.9618   24051.035    809.4753   141200.38
#&gt; Latin America &amp; Caribbean   38   7628.4477   8470.9708   1357.3326  77403.7443
#&gt; Middle East &amp; North Africa  20  13878.4213  17251.6962   1069.6596  64878.4021
#&gt; North America                3    48699.76  18604.4369  35260.4708  74934.5874
#&gt; South Asia                   8   1235.9256   1488.3669      413.68   6621.5002
#&gt; Sub-Saharan Africa          47   1840.0259   2234.3254    253.1886   9922.0052
#&gt; 
#&gt; , , Within
#&gt; 
#&gt;                                   N       Mean          SD          Min
#&gt; East Asia &amp; Pacific         43.1471  12048.778   6615.8248  -11964.6472
#&gt; Europe &amp; Central Asia       40.0536  12048.778  10971.0483  -33504.8721
#&gt; Latin America &amp; Caribbean        52  12048.778   2451.2636    -354.1639
#&gt; Middle East &amp; North Africa     42.1  12048.778   6455.0512  -18674.4049
#&gt; North America                    60  12048.778  15470.4609  -29523.1017
#&gt; South Asia                    47.75  12048.778    617.0934   10026.9155
#&gt;                                    Max
#&gt; East Asia &amp; Pacific          49541.463
#&gt; Europe &amp; Central Asia       76767.5254
#&gt; Latin America &amp; Caribbean   23036.3668
#&gt; Middle East &amp; North Africa  63665.0446
#&gt; North America               50350.2816
#&gt; South Asia                   14455.865
#&gt; </div><div class='input'>
<span class='co'># Proof:</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>PCGDP</span> <span class='op'>~</span> <span class='va'>region</span>, <span class='op'>~</span> <span class='va'>iso3c</span><span class='op'>)</span>
</div><div class='output co'>#&gt; , , Overall
#&gt; 
#&gt;                              N/T        Mean          SD         Min
#&gt; East Asia &amp; Pacific         1467  10513.2441  14383.5507    132.0776
#&gt; Europe &amp; Central Asia       2243  25992.9618  26435.1316    366.9354
#&gt; Latin America &amp; Caribbean   1976   7628.4477   8818.5055   1005.4085
#&gt; Middle East &amp; North Africa   842  13878.4213  18419.7912    578.5996
#&gt; North America                180    48699.76  24196.2855  16405.9053
#&gt; South Asia                   382   1235.9256   1611.2232    265.9625
#&gt; Sub-Saharan Africa          2380   1840.0259   2596.0104    164.3366
#&gt;                                    Max
#&gt; East Asia &amp; Pacific         71992.1517
#&gt; Europe &amp; Central Asia       196061.417
#&gt; Latin America &amp; Caribbean   88391.3331
#&gt; Middle East &amp; North Africa  116232.753
#&gt; North America               113236.091
#&gt; South Asia                    8476.564
#&gt; Sub-Saharan Africa          20532.9523
#&gt; 
#&gt; , , Between
#&gt; 
#&gt;                             N/T        Mean          SD         Min         Max
#&gt; East Asia &amp; Pacific          34  10513.2441   12771.742    444.2899  39722.0077
#&gt; Europe &amp; Central Asia        56  25992.9618   24051.035    809.4753   141200.38
#&gt; Latin America &amp; Caribbean    38   7628.4477   8470.9708   1357.3326  77403.7443
#&gt; Middle East &amp; North Africa   20  13878.4213  17251.6962   1069.6596  64878.4021
#&gt; North America                 3    48699.76  18604.4369  35260.4708  74934.5874
#&gt; South Asia                    8   1235.9256   1488.3669      413.68   6621.5002
#&gt; Sub-Saharan Africa           47   1840.0259   2234.3254    253.1886   9922.0052
#&gt; 
#&gt; , , Within
#&gt; 
#&gt;                                 N/T       Mean          SD          Min
#&gt; East Asia &amp; Pacific         43.1471  12048.778   6615.8248  -11964.6472
#&gt; Europe &amp; Central Asia       40.0536  12048.778  10971.0483  -33504.8721
#&gt; Latin America &amp; Caribbean        52  12048.778   2451.2636    -354.1639
#&gt; Middle East &amp; North Africa     42.1  12048.778   6455.0512  -18674.4049
#&gt; North America                    60  12048.778  15470.4609  -29523.1017
#&gt; South Asia                    47.75  12048.778    617.0934   10026.9155
#&gt;                                    Max
#&gt; East Asia &amp; Pacific          49541.463
#&gt; Europe &amp; Central Asia       76767.5254
#&gt; Latin America &amp; Caribbean   23036.3668
#&gt; Middle East &amp; North Africa  63665.0446
#&gt; North America               50350.2816
#&gt; South Asia                   14455.865
#&gt; </div><div class='input'>
<span class='co'># Same as above, but output as nested list</span>
<span class='va'>psrl</span> <span class='op'>&lt;-</span> <span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>region</span>, <span class='op'>~</span> <span class='va'>iso3c</span>,
            cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span>, array <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>psrl</span>                                        <span class='co'># We can use unlist2d to create a tidy data.frame</span>
</div><div class='output co'>#&gt; $PCGDP
#&gt; $PCGDP$Overall
#&gt;                                N        Mean          SD         Min
#&gt; East Asia &amp; Pacific         1467  10513.2441  14383.5507    132.0776
#&gt; Europe &amp; Central Asia       2243  25992.9618  26435.1316    366.9354
#&gt; Latin America &amp; Caribbean   1976   7628.4477   8818.5055   1005.4085
#&gt; Middle East &amp; North Africa   842  13878.4213  18419.7912    578.5996
#&gt; North America                180    48699.76  24196.2855  16405.9053
#&gt; South Asia                   382   1235.9256   1611.2232    265.9625
#&gt; Sub-Saharan Africa          2380   1840.0259   2596.0104    164.3366
#&gt;                                    Max
#&gt; East Asia &amp; Pacific         71992.1517
#&gt; Europe &amp; Central Asia       196061.417
#&gt; Latin America &amp; Caribbean   88391.3331
#&gt; Middle East &amp; North Africa  116232.753
#&gt; North America               113236.091
#&gt; South Asia                    8476.564
#&gt; Sub-Saharan Africa          20532.9523
#&gt; 
#&gt; $PCGDP$Between
#&gt;                              N        Mean          SD         Min         Max
#&gt; East Asia &amp; Pacific         34  10513.2441   12771.742    444.2899  39722.0077
#&gt; Europe &amp; Central Asia       56  25992.9618   24051.035    809.4753   141200.38
#&gt; Latin America &amp; Caribbean   38   7628.4477   8470.9708   1357.3326  77403.7443
#&gt; Middle East &amp; North Africa  20  13878.4213  17251.6962   1069.6596  64878.4021
#&gt; North America                3    48699.76  18604.4369  35260.4708  74934.5874
#&gt; South Asia                   8   1235.9256   1488.3669      413.68   6621.5002
#&gt; Sub-Saharan Africa          47   1840.0259   2234.3254    253.1886   9922.0052
#&gt; 
#&gt; $PCGDP$Within
#&gt;                                   N       Mean          SD          Min
#&gt; East Asia &amp; Pacific         43.1471  12048.778   6615.8248  -11964.6472
#&gt; Europe &amp; Central Asia       40.0536  12048.778  10971.0483  -33504.8721
#&gt; Latin America &amp; Caribbean        52  12048.778   2451.2636    -354.1639
#&gt; Middle East &amp; North Africa     42.1  12048.778   6455.0512  -18674.4049
#&gt; North America                    60  12048.778  15470.4609  -29523.1017
#&gt; South Asia                    47.75  12048.778    617.0934   10026.9155
#&gt; Sub-Saharan Africa          50.6383  12048.778    1321.764    4846.3834
#&gt;                                    Max
#&gt; East Asia &amp; Pacific          49541.463
#&gt; Europe &amp; Central Asia       76767.5254
#&gt; Latin America &amp; Caribbean   23036.3668
#&gt; Middle East &amp; North Africa  63665.0446
#&gt; North America               50350.2816
#&gt; South Asia                   14455.865
#&gt; Sub-Saharan Africa          24883.1246
#&gt; 
#&gt; 
#&gt; $LIFEEX
#&gt; $LIFEEX$Overall
#&gt;                                N     Mean       SD      Min      Max
#&gt; East Asia &amp; Pacific         1807  65.9445  10.1633   18.907   85.078
#&gt; Europe &amp; Central Asia       3046  72.1625   5.7602   45.369  85.4171
#&gt; Latin America &amp; Caribbean   2107  68.3486   7.3768   41.762  82.1902
#&gt; Middle East &amp; North Africa  1226  66.2508   9.8306   29.919  82.8049
#&gt; North America                144  76.2867   3.5734  68.8978  82.0488
#&gt; South Asia                   480  57.5585  11.3004   32.446   78.921
#&gt; Sub-Saharan Africa          2860   51.581   8.6876   26.172  74.5146
#&gt; 
#&gt; $LIFEEX$Between
#&gt;                              N     Mean      SD      Min      Max
#&gt; East Asia &amp; Pacific         32  65.9445  7.6833  49.7995  77.9008
#&gt; Europe &amp; Central Asia       55  72.1625  4.4378  60.1129  85.4171
#&gt; Latin America &amp; Caribbean   40  68.3486  4.9199  53.4918  82.1902
#&gt; Middle East &amp; North Africa  21  66.2508   5.922  52.5371  76.7395
#&gt; North America                3  76.2867  1.3589  74.8065  78.4175
#&gt; South Asia                   8  57.5585  5.6158  49.1972  69.3429
#&gt; Sub-Saharan Africa          48   51.581   5.657  40.9663  71.5749
#&gt; 
#&gt; $LIFEEX$Within
#&gt;                                   N     Mean      SD      Min      Max
#&gt; East Asia &amp; Pacific         56.4688  64.2963  6.6528  32.9068  83.9918
#&gt; Europe &amp; Central Asia       55.3818  64.2963  3.6723  46.3045  78.6265
#&gt; Latin America &amp; Caribbean    52.675  64.2963  5.4965  46.7831  79.5026
#&gt; Middle East &amp; North Africa   58.381  64.2963  7.8467  41.6187  78.8872
#&gt; North America                    48  64.2963  3.3049  54.7766  69.4306
#&gt; South Asia                       60  64.2963  9.8062  41.4342  83.0122
#&gt; Sub-Saharan Africa          59.5833  64.2963  6.5933  41.5678  84.4198
#&gt; 
#&gt; 
#&gt; $GINI
#&gt; $GINI$Overall
#&gt;                               N     Mean      SD   Min   Max
#&gt; East Asia &amp; Pacific         154  37.7571  5.0318  27.8  49.1
#&gt; Europe &amp; Central Asia       798  31.9114  4.5809  20.7  48.4
#&gt; Latin America &amp; Caribbean   413  49.9557  5.4821  34.4  63.3
#&gt; Middle East &amp; North Africa   91  36.0143  5.2073    26  47.4
#&gt; North America                49  37.4816  3.6972    31  41.5
#&gt; South Asia                   46  33.8804  3.9898  25.9  43.8
#&gt; Sub-Saharan Africa          193  44.6606  8.2003  29.8  65.8
#&gt; 
#&gt; $GINI$Between
#&gt;                              N     Mean      SD      Min      Max
#&gt; East Asia &amp; Pacific         23  37.7571  4.3005     30.8  45.8857
#&gt; Europe &amp; Central Asia       49  31.9114  4.0611  24.8667   40.935
#&gt; Latin America &amp; Caribbean   25  49.9557  4.0492     41.1     57.9
#&gt; Middle East &amp; North Africa  15  36.0143  4.7002    29.05     42.7
#&gt; North America                2  37.4816  3.3563  33.1222  40.0129
#&gt; South Asia                   7  33.8804  3.0052  30.3556     38.8
#&gt; Sub-Saharan Africa          46  44.6606  6.8844    34.52  61.7143
#&gt; 
#&gt; $GINI$Within
#&gt;                                   N     Mean      SD      Min      Max
#&gt; East Asia &amp; Pacific          6.6957  38.5341  2.6125  31.0187  45.8901
#&gt; Europe &amp; Central Asia       16.2857  38.5341  2.1195  31.2841  50.1387
#&gt; Latin America &amp; Caribbean     16.52  38.5341  3.6955  25.3917  48.8341
#&gt; Middle East &amp; North Africa   6.0667  38.5341  2.2415  31.7675   45.777
#&gt; North America                  24.5  38.5341  1.5507  33.0212  42.7119
#&gt; South Asia                   6.5714  38.5341  2.6244  32.8341  45.0675
#&gt; Sub-Saharan Africa           4.1957  38.5341  4.4553  27.9452  55.3591
#&gt; 
#&gt; 
#&gt; $ODA
#&gt; $ODA$Overall
#&gt;                                N            Mean              SD           Min
#&gt; East Asia &amp; Pacific         1537      352'017964      622'847624   -997'679993
#&gt; Europe &amp; Central Asia        787      402'455286      568'237036   -322'070007
#&gt; Latin America &amp; Caribbean   1972      172'880081      260'781049   -444'040009
#&gt; Middle East &amp; North Africa  1105      732'380009  1.52108993e+09   -141'789993
#&gt; North America                 39      468717.916     10'653560.8  -15'869999.9
#&gt; South Asia                   466  1.27049955e+09  1.61492889e+09   -247'369995
#&gt; Sub-Saharan Africa          2702      486'371750      656'336230  -18'409999.8
#&gt;                                        Max
#&gt; East Asia &amp; Pacific         4.04487988e+09
#&gt; Europe &amp; Central Asia       4.34612988e+09
#&gt; Latin America &amp; Caribbean   2.99568994e+09
#&gt; Middle East &amp; North Africa  2.56715605e+10
#&gt; North America                  61'509998.3
#&gt; South Asia                  8.75425977e+09
#&gt; Sub-Saharan Africa          1.18790801e+10
#&gt; 
#&gt; $ODA$Between
#&gt;                              N            Mean              SD          Min
#&gt; East Asia &amp; Pacific         31      352'017964      457'183279  1'654615.38
#&gt; Europe &amp; Central Asia       32      402'455286      438'074771  12'516000.1
#&gt; Latin America &amp; Caribbean   37      172'880081      167'160838  2'225483.88
#&gt; Middle East &amp; North Africa  21      732'380009      775'418887   3'112820.5
#&gt; North America                1      468717.916               0   468717.916
#&gt; South Asia                   8  1.27049955e+09  1.18347893e+09  27'152499.9
#&gt; Sub-Saharan Africa          48      486'371750      397'995105  28'801206.9
#&gt;                                        Max
#&gt; East Asia &amp; Pacific         1.63585532e+09
#&gt; Europe &amp; Central Asia       2.05456932e+09
#&gt; Latin America &amp; Caribbean       538'386665
#&gt; Middle East &amp; North Africa  2.86174883e+09
#&gt; North America                   468717.916
#&gt; South Asia                  3.62337432e+09
#&gt; Sub-Saharan Africa          1.55049113e+09
#&gt; 
#&gt; $ODA$Within
#&gt;                                   N        Mean              SD
#&gt; East Asia &amp; Pacific         49.5806  454'720131      422'992450
#&gt; Europe &amp; Central Asia       24.5938  454'720131      361'916875
#&gt; Latin America &amp; Caribbean   53.2973  454'720131      200'159960
#&gt; Middle East &amp; North Africa   52.619  454'720131  1.30860235e+09
#&gt; North America                    39  454'720131     10'653560.8
#&gt; South Asia                    58.25  454'720131  1.09880524e+09
#&gt; Sub-Saharan Africa          56.2917  454'720131      521'897637
#&gt;                                         Min             Max
#&gt; East Asia &amp; Pacific         -2.04042108e+09  3.59673152e+09
#&gt; Europe &amp; Central Asia       -1.08796786e+09  3.30549004e+09
#&gt; Latin America &amp; Caribbean       -527'706542  3.28976141e+09
#&gt; Middle East &amp; North Africa  -2.34610870e+09  2.45610972e+10
#&gt; North America                    438'381413      515'761411
#&gt; South Asia                  -2.44379420e+09  5.58560558e+09
#&gt; Sub-Saharan Africa              -952'168698  1.12814455e+10
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='unlist2d.html'>unlist2d</a></span><span class='op'>(</span><span class='va'>psrl</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Variable"</span>,<span class='st'>"Trans"</span><span class='op'>)</span>,
                    row.names <span class='op'>=</span> <span class='st'>"Region"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Variable   Trans                     Region    N      Mean        SD
#&gt; 1    PCGDP Overall        East Asia &amp; Pacific 1467 10513.244 14383.551
#&gt; 2    PCGDP Overall      Europe &amp; Central Asia 2243 25992.962 26435.132
#&gt; 3    PCGDP Overall  Latin America &amp; Caribbean 1976  7628.448  8818.505
#&gt; 4    PCGDP Overall Middle East &amp; North Africa  842 13878.421 18419.791
#&gt; 5    PCGDP Overall              North America  180 48699.760 24196.285
#&gt; 6    PCGDP Overall                 South Asia  382  1235.926  1611.223
#&gt;          Min        Max
#&gt; 1   132.0776  71992.152
#&gt; 2   366.9354 196061.417
#&gt; 3  1005.4085  88391.333
#&gt; 4   578.5996 116232.753
#&gt; 5 16405.9053 113236.091
#&gt; 6   265.9625   8476.564</div><div class='input'>
<span class='co'># Weighted Summaries -----------------------</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>wlddev</span><span class='op'>)</span>
<span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>                    <span class='co'># Generate random weights</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, w <span class='op'>=</span> <span class='va'>weights</span>, higher <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>     <span class='co'># Computed weighted mean, SD, skewness and kurtosis</span>
</div><div class='output co'>#&gt;              N         Mean          SD          Min             Max     Skew
#&gt; country  13176            -           -            -               -        -
#&gt; iso3c    13176            -           -            -               -        -
#&gt; date     13176            -           -            -               -        -
#&gt; year     13176    1990.0226     19.6852         1960            2020    0.059
#&gt; decade   13176    1985.6302     19.5262         1960            2020   0.1091
#&gt; region   13176            -           -            -               -        -
#&gt; income   13176            -           -            -               -        -
#&gt; OECD     13176            -           -            -               -        -
#&gt; PCGDP     9470   11965.3882  20780.0186     132.0776      196061.417   3.8906
#&gt; LIFEEX   11670      64.2895     12.8128       18.907         85.4171  -1.1014
#&gt; GINI      1744      38.3852     10.0985         20.7            65.8   0.6755
#&gt; ODA       8608   456'528688  937'560287  -997'679993  2.56715605e+10   6.5844
#&gt; POP      12919  23'501772.9  110'943040         2833  1.39771500e+09  13.8994
#&gt;              Kurt
#&gt; country         -
#&gt; iso3c           -
#&gt; date            -
#&gt; year       4.2631
#&gt; decade     4.2331
#&gt; region          -
#&gt; income          -
#&gt; OECD            -
#&gt; PCGDP     26.8231
#&gt; LIFEEX     8.3035
#&gt; GINI       5.3838
#&gt; ODA        83.149
#&gt; POP      249.0686</div><div class='input'><span class='va'>weightsNA</span> <span class='op'>&lt;-</span> <span class='va'>weights</span>                        <span class='co'># Weights may contain missing values.. inserting 1000</span>
<span class='va'>weightsNA</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample.int</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='fu'>qsu</span><span class='op'>(</span><span class='va'>wlddev</span>, w <span class='op'>=</span> <span class='va'>weightsNA</span>, higher <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>   <span class='co'># But now these values are removed from all variables</span>
</div><div class='output co'>#&gt;              N         Mean          SD          Min             Max     Skew
#&gt; country  13176            -           -            -               -        -
#&gt; iso3c    13176            -           -            -               -        -
#&gt; date     13176            -           -            -               -        -
#&gt; year     12176    1990.0363     19.7052         1960            2020     0.07
#&gt; decade   12176    1985.6475     19.5509         1960            2020   0.1187
#&gt; region   13176            -           -            -               -        -
#&gt; income   13176            -           -            -               -        -
#&gt; OECD     13176            -           -            -               -        -
#&gt; PCGDP     8755   12068.9326  20947.5464     132.0776      196061.417   3.8739
#&gt; LIFEEX   10775      64.3663     12.8194       18.907         85.4171  -1.1452
#&gt; GINI      1597      38.3429     10.0947         20.7            65.8    0.678
#&gt; ODA       7944   456'798230  944'738939  -997'679993  2.56715605e+10   6.7078
#&gt; POP      11944  23'208664.7  111'923697         3372  1.39771500e+09  14.1413
#&gt;              Kurt
#&gt; country         -
#&gt; iso3c           -
#&gt; date            -
#&gt; year       4.2599
#&gt; decade     4.2391
#&gt; region          -
#&gt; income          -
#&gt; OECD            -
#&gt; PCGDP     26.5945
#&gt; LIFEEX     8.6407
#&gt; GINI       5.4987
#&gt; ODA       85.5513
#&gt; POP      254.5277</div><div class='input'>
<span class='co'># Grouped and panel-summaries can also be weighted in the same manor</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


