<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon">
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast Subsetting Matrix-Like Objects — fsubset • collapse</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fast Subsetting Matrix-Like Objects — fsubset" />
<meta property="og:description" content="fsubset returns subsets of vectors, matrices or data frames which meet conditions. It is programmed very efficiently and uses C source code from the data.table package. Especially for data frames it is significantly (4-5 times) faster than subset or dplyr::filter. The methods also provide enhanced functionality compared to subset. The function ss provides an (internal generic) programmers alternative to [ that does not drop dimensions and is significantly faster than [.data.frame." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" target="_blank">Blog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/collapse_R" target="_blank">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" target="_blank">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast Subsetting Matrix-Like Objects</h1>
    
    <div class="hidden name"><code>fsubset.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>fsubset</code> returns subsets of vectors, matrices or data frames which meet conditions. It is programmed very efficiently and uses C source code from the <em>data.table</em> package. Especially for data frames it is significantly (4-5 times) faster than <code><a href='https://rdrr.io/r/base/subset.html'>subset</a></code> or <code><a href='https://dplyr.tidyverse.org/reference/filter.html'>dplyr::filter</a></code>. The methods also provide enhanced functionality compared to <code><a href='https://rdrr.io/r/base/subset.html'>subset</a></code>. The function <code>ss</code> provides an (internal generic) programmers alternative to <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code> that does not drop dimensions and is significantly faster than <code>[.data.frame</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>sbt</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>     <span class='co'># Shortcut for fsubset</span>

<span class='co'># S3 method for default</span>
<span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>subset</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for matrix</span>
<span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>subset</span>, <span class='va'>...</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>subset</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># Fast subsetting (replaces `[`, programmers choice)</span>
<span class='fu'>ss</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>i</span>, <span class='va'>j</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>object to be subsetted.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>logical expression indicating elements or rows to keep:
    missing values are taken as <code>FALSE</code>. The default and matrix methods only support logical vectors or row-indices (or a character vector of rownames if the matrix has rownames; the data frame method also supports logical vectors or row-indices).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For the matrix or data frame method: multiple comma-separated expressions indicating columns to select. Otherwise: further arguments to be passed to or from other methods.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>passed on to <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code> indexing operator. Only available for the matrix method.</p></td>
    </tr>
    <tr>
      <th>i</th>
      <td><p>positive or negative row-indices or a logical vector to subset the rows of <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>j</th>
      <td><p>a vector of column names, positive or negative indices or a suitable logical vector to subset the columns of <code>x</code>. <em>Note:</em> Negative indices are converted to positive ones using <code>j &lt;- seq_along(x)[j]</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>fsubset</code> is a generic function, with methods supplied for vectors, matrices, and data
  frames (including lists). It represents an improvement in both speed and functionality over <code><a href='https://rdrr.io/r/base/subset.html'>subset</a></code>. The function <code>ss</code> is an improvement of <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code> to subset (vectors) matrices and data frames without dropping dimensions. It is significantly faster than <code>[.data.frame</code>. For subsetting columns alone, please see <a href='fselect, get_vars, add_vars.html'>selecting and replacing columns</a>.</p>
<p>For ordinary vectors, the result is <code><a href='https://rdrr.io/r/base/CallExternal.html'>.Call(C_subsetVector, x, subset)</a></code>, where <code>C_subsetVector</code> is an internal function in the <em>data.table</em> package. The <code>subset</code> can be integer or logical. Appropriate errors are delivered for wrong use.</p>
<p>For matrices the implementation is all base-R but slightly more efficient and more versatile than <code><a href='https://rdrr.io/r/base/subset.html'>subset.matrix</a></code>. Thus it is possible to <code>subset</code> matrix rows using logical or integer vectors, or character vectors matching rownames. The <code>drop</code> argument is passed on to the indexing method for matrices.</p>
<p>For both matrices and data frames, the <code>...</code> argument can be used to subset columns, and is evaluated in a non-standard way. Thus it can support vectors of column names, indices or logical vectors, but also multiple comma separated column names passed without quotes, each of which may also be replaced by a sequence of columns i.e. <code>col1:coln</code>, and new column names may be assigned e.g. <code>fsubset(data, col1 &gt; 20, newname =  col2, col3:col6)</code> (see examples).</p>
<p>For data frames, the <code>subset</code> argument is also evaluated in a non-standard way. Thus next to vector of row-indices or logical vectors, it supports logical expressions of the form <code>col2 &gt; 5 &amp; col2 &lt; col3</code> etc. (see examples). The data frame method uses <code>C_subsetDT</code>, an internal C function from the <em>data.table</em> package to subset data frames, hence it is significantly faster than <code><a href='https://rdrr.io/r/base/subset.html'>subset.data.frame</a></code>. If fast data frame subsetting is required but no non-standard evaluation, the function <code>ss</code> is slightly simpler and faster.</p>
<p>Factors may have empty levels after subsetting; unused levels are not automatically removed.  See <code><a href='fdroplevels.html'>fdroplevels</a></code> for a way to drop all unused levels from a data frame.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object similar to <code>x</code> containing just the selected elements (for
  a vector), rows and columns (for a matrix or data frame).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>No replacement method <code>fsubset&lt;-</code> or <code>ss&lt;-</code> is offered in <em>collapse</em>. For efficient subset relacement (without copying) use <code><a href='https://rdrr.io/pkg/data.table/man/assign.html'>data.table::set</a></code>, which can also be used with data frames and tibbles.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='fselect, get_vars, add_vars.html'>fselect</a></code>,
  <code><a href='fselect, get_vars, add_vars.html'>get_vars</a></code>,
  <code><a href='ftransform.html'>ftransform</a></code>,
<a href='fast-data-manipulation.html'>Data Frame Manipulation</a>, <a href='index.html'>Collapse Overview</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='va'>Temp</span> <span class='op'>&gt;</span> <span class='fl'>90</span>, <span class='va'>Ozone</span>, <span class='va'>Temp</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    Ozone Temp
#&gt; 1     NA   93
#&gt; 2     NA   92
#&gt; 3     97   92
#&gt; 4     97   92
#&gt; 5     NA   91
#&gt; 6     NA   92
#&gt; 7     76   97
#&gt; 8    118   94
#&gt; 9     84   96
#&gt; 10    85   94
#&gt; 11    96   91
#&gt; 12    78   92
#&gt; 13    73   93
#&gt; 14    91   93</div><div class='input'><span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='va'>Temp</span> <span class='op'>&gt;</span> <span class='fl'>90</span>, OZ <span class='op'>=</span> <span class='va'>Ozone</span>, <span class='va'>Temp</span><span class='op'>)</span> <span class='co'># With renaming</span>
</div><div class='output co'>#&gt;     OZ Temp
#&gt; 1   NA   93
#&gt; 2   NA   92
#&gt; 3   97   92
#&gt; 4   97   92
#&gt; 5   NA   91
#&gt; 6   NA   92
#&gt; 7   76   97
#&gt; 8  118   94
#&gt; 9   84   96
#&gt; 10  85   94
#&gt; 11  96   91
#&gt; 12  78   92
#&gt; 13  73   93
#&gt; 14  91   93</div><div class='input'><span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='va'>Day</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='op'>-</span><span class='va'>Temp</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Month Day
#&gt; 1    41     190  7.4     5   1
#&gt; 2    NA     286  8.6     6   1
#&gt; 3   135     269  4.1     7   1
#&gt; 4    39      83  6.9     8   1
#&gt; 5    96     167  6.9     9   1</div><div class='input'><span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='va'>Day</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='op'>-</span><span class='op'>(</span><span class='va'>Day</span><span class='op'>:</span><span class='va'>Temp</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind
#&gt; 1    41     190  7.4
#&gt; 2    NA     286  8.6
#&gt; 3   135     269  4.1
#&gt; 4    39      83  6.9
#&gt; 5    96     167  6.9</div><div class='input'><span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='va'>Day</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='va'>Ozone</span><span class='op'>:</span><span class='va'>Wind</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind
#&gt; 1    41     190  7.4
#&gt; 2    NA     286  8.6
#&gt; 3   135     269  4.1
#&gt; 4    39      83  6.9
#&gt; 5    96     167  6.9</div><div class='input'><span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='va'>Day</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Ozone</span><span class='op'>)</span>, <span class='va'>Ozone</span><span class='op'>:</span><span class='va'>Wind</span>, <span class='va'>Month</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Ozone Solar.R Wind Month
#&gt; 1    41     190  7.4     5
#&gt; 2   135     269  4.1     7
#&gt; 3    39      83  6.9     8
#&gt; 4    96     167  6.9     9</div><div class='input'>
<span class='fu'>ss</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>         <span class='co'># Significantly faster than airquality[1:10, 2:3]</span>
</div><div class='output co'>#&gt;    Solar.R Wind
#&gt; 1      190  7.4
#&gt; 2      118  8.0
#&gt; 3      149 12.6
#&gt; 4      313 11.5
#&gt; 5       NA 14.3
#&gt; 6       NA 14.9
#&gt; 7      299  8.6
#&gt; 8       99 13.8
#&gt; 9       19 20.1
#&gt; 10     194  8.6</div><div class='input'><span class='fu'>fsubset</span><span class='op'>(</span><span class='va'>airquality</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>    <span class='co'># This is possible but not advised</span>
</div><div class='output co'>#&gt;    Solar.R Wind
#&gt; 1      190  7.4
#&gt; 2      118  8.0
#&gt; 3      149 12.6
#&gt; 4      313 11.5
#&gt; 5       NA 14.3
#&gt; 6       NA 14.9
#&gt; 7      299  8.6
#&gt; 8       99 13.8
#&gt; 9       19 20.1
#&gt; 10     194  8.6</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


