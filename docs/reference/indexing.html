<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon">
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast Indexed Time Series and Panels — indexing • collapse</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fast Indexed Time Series and Panels — indexing" />
<meta property="og:description" content="A fast and flexible indexed time series and panel data class that inherits from plm's 'pseries' and 'pdata.frame', but is more rigorous, natively handles irregularity, can be superimposed on any data.frame/list, matrix or vector, and supports ad-hoc computations inside data masking functions and model formulas." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/">Blog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/collapse_R">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast Indexed Time Series and Panels</h1>
    
    <div class="hidden name"><code>indexing.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A fast and flexible indexed time series and panel data class that inherits from <em>plm</em>'s 'pseries' and 'pdata.frame', but is more rigorous, natively handles irregularity, can be superimposed on any data.frame/list, matrix or vector, and supports ad-hoc computations inside data masking functions and model formulas.</p>
    </div>

    <pre class="usage">## Create an 'indexed_frame' containing 'indexed_series'
findex_by(.X, ..., single = "auto", interact.ids = TRUE)
iby(.X, ..., single = "auto", interact.ids = TRUE)  # Shorthand

## Retrieve the index ('index_df') from an 'indexed_frame' or 'indexed_series'
findex(x)
ix(x)     # Shorthand

## Remove index from 'indexed_frame' or 'indexed_series' (i.e. get .X back)
unindex(x)

## Reindex 'indexed_frame' or 'indexed_series' (or index vectors / matrices)
reindex(x, index = findex(x), single = "auto")

## Check if 'indexed_frame', 'indexed_series', index or time vector is irregular
is_irregular(x, any_id = TRUE)

## Convert 'indexed_frame'/'indexed_series' to normal 'pdata.frame'/'pseries'
to_plm(x, row.names = FALSE)

# Subsetting &amp; replacement methods: [(&lt;-) methods call NextMethod().
# Also methods for fsubset, funique and roworder(v), na_omit (internal).

# S3 method for indexed_series
[(x, i, ..., drop.index.levels = "id")

# S3 method for indexed_frame
[(x, i, ..., drop.index.levels = "id")

# S3 method for indexed_frame
[(x, i, j) &lt;- value

# S3 method for indexed_frame
$(x, name)

# S3 method for indexed_frame
$(x, name) &lt;- value

# S3 method for indexed_frame
[[(x, i, ...)

# S3 method for indexed_frame
[[(x, i) &lt;- value

# Index subsetting and printing: optimized using ss()

# S3 method for index_df
[(x, i, j, drop = FALSE, drop.index.levels = "id")

# S3 method for index_df
print(x, topn = 5, ...)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.X</th>
      <td><p>a data frame or list-like object of equal-length columns.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>an 'indexed_frame' or 'indexed_series'. <code>findex</code> also works with 'pseries' and 'pdata.frame's created with <em>plm</em>. For <code>is_irregular</code> <code>x</code> can also be an index (inherits 'pindex') or a vector representing time.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>for <code>findex_by</code>: variables identifying the individual (id) and/or time dimensions of the data. Passed either as unquoted comma-separated column names or (tagged) expressions involving columns, or as a vector of column names, indices, a logical vector or a selector function. The time variable must enter last. See Examples. Otherwise: further arguments passed to <code><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod()</a></code>.</p></td>
    </tr>
    <tr>
      <th>single</th>
      <td><p>character. If only one indexing variable is supplied, this can be declared as <code>"id"</code> or <code>"time"</code> variable. <code>"auto"</code> chooses <code>"id"</code> if the variable has <code><a href='https://rdrr.io/pkg/data.table/man/duplicated.html'>anyDuplicated</a></code> values.</p></td>
    </tr>
    <tr>
      <th>interact.ids</th>
      <td><p>logical. If <code>n &gt; 2</code> indexing variables are passed, <code>TRUE</code> calls <code><a href='qF-qG-finteraction.html'>finteraction</a></code> on the first <code>n-1</code> of them (<code>n</code>'th variable must be time). <code>FALSE</code> keeps all variables in the index. The latter slows down computations of lags / differences etc. because ad-hoc interactions need to be computed, but gives more flexibility for scaling / centering / summarising over different data dimensions.</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>and index (inherits 'pindex'), or an atomic vector or list of factors matching the data dimensions. Atomic vectors or lists with 1 factor will must be declared, see <code>single</code>. Atomic vectors will additionally be grouped / turned into time-factors. See Details.</p></td>
    </tr>
    <tr>
      <th>drop.index.levels</th>
      <td><p>character. Subset methods also subset the index (= a data.frame of factors), and this argument regulates which factor levels should be dropped: either <code>"all"</code>, <code>"id"</code>, <code>"time"</code> or <code>"none"</code>. The default <code>"id"</code> only drops levels from id's. <code>"all"</code> or <code>"time"</code> should be used with caution because time-factors may contain levels for missing time periods (gaps in irregular sequences, or periods within a sequence removed through subsetting), and dropping those levels would create a variable that is ordinal but no longer represents time. The benefit of dropping levels is that it can speed-up subsequent computations by reducing the size of intermediate vectors created in C++.</p></td>
    </tr>
    <tr>
      <th>any_id</th>
      <td><p>logical. For panel series: <code>FALSE</code> returns the irregularity check performed for each id, <code>TRUE</code> calls <code><a href='https://rdrr.io/r/base/any.html'>any</a></code> on those checks.</p></td>
    </tr>
    <tr>
      <th>row.names</th>
      <td><p>logical. <code>TRUE</code> creates descriptive row-names (or names for pseries) as in <code>plm</code>. This can be expensive and is usually not required for <code>plm</code> models to work.</p></td>
    </tr>
    <tr>
      <th>topn</th>
      <td><p>integer. The number of first and last rows to print.</p></td>
    </tr>
    <tr>
      <th>i, j, name, drop, value</th>
      <td><p>Arguments passed to <code><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></code>, or as in the <a href='https://rdrr.io/r/base/Extract.data.frame.html'>data.frame methods</a>. Note that for index subsetting to work, <code>i</code> needs to be integer or logical (or an expression evaluation to integer or logical if <code>x</code> is a <em>data.table</em>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The first thing to note about these new 'indexed_frame', 'indexed_series' and 'index_df' classes is that they inherit <em>plm</em>'s 'pdata.frame', 'pseries' and 'pindex' classes, respectively. Hence they are sub-classes that add, improve, and, in some cases, remove functionality provided in <em>plm</em>, with the aim of striking an optimal balance of flexibility and performance. The inheritance means that all 'pseries' and 'pdata.frame' methods in <em>collapse</em>, and also some methods in <em>plm</em>, apply to them. Where compatibility or performance considerations allow for it, <em>collapse</em> will continue to create methods for <em>plm</em>'s classes instead of the sub-classes.</p>
<p>The use of these sub-classes does not require much knowledge of <em>plm</em>, but as a basic background: A 'pdata.frame' is a data.frame with an index attribute: a data.frame of 2 factors identifying the individual and time-dimension of the data. When pulling a variable out of the pdata.frame using a method like <code>$.pdata.frame</code> or <code>[[.pdata.frame</code> (defined in <em>plm</em>), a 'pseries' is created by transferring the index attribute to the vector. Methods defined for functions like <code><a href='https://dplyr.tidyverse.org/reference/lead-lag.html'>lag</a></code> / <code><a href='flag.html'>flag</a></code> etc. use the index for correct computations on this panel data, also inside <em>plm</em>'s estimation commands.</p>
<p><b>Main Features and Enhancements</b></p>
<p>The 'indexed_frame' and 'indexed_series' classes extend and enhance 'pdata.frame' and 'pseries' in a number of critical dimensions. Most notably they:</p>
<ul>
<li><p>Support <b>both time series and panel data</b>, by allowing indexation of data with one, two or more variables.</p></li>
<li><p>Are <b>class-agnostic</b>: any data.frame/list (such as data.table, tibble, tsibble, sf etc.) can become an 'indexed_frame' and continue to function as usual for most use cases. Similarly, any vector or matrix (such as ts, mts, xts) can become an 'indexed_series'. This also allows for transient workflows e.g. <code>some_df |&gt; findex_by(...) |&gt; 'do something using collapse functions' |&gt; unindex() |&gt; 'continue working with some_df'</code>.</p></li>
<li><p>Have a comprehensive and efficient set of <b>methods for subsetting and manipulation</b>, including methods for <code><a href='fsubset.html'>fsubset</a></code>, <code><a href='funique.html'>funique</a></code>, <code><a href='roworder.html'>roworder(v)</a></code> (internal) and <code><a href='efficient-programming.html'>na_omit</a></code> (internal, <code><a href='https://rdrr.io/pkg/data.table/man/na.omit.data.table.html'>na.omit</a></code> also works but is slower). It is also possible to group indexed data with <code><a href='GRP.html'>fgroup_by</a></code> for transformations e.g. using <code><a href='ftransform.html'>fmutate</a></code>, but aggregation requires <code>unindex()</code>ing.</p></li>
<li><p><b>Natively handle irregularity</b>: time objects (such as 'Date', 'POSIXct' etc.) are passed to <code><a href='timeid.html'>timeid</a></code>, which efficiently determines the temporal structure by finding the greatest common divisor (GCD), and creates a time-factor with levels corresponding to a complete time-sequence. The latter is also done with plain numeric vectors, which are assumed to represent unit time steps (GDC = 1) and coerced to integer (but can also be passed through <code><a href='timeid.html'>timeid</a></code> if non-unitary). Character time variables are converted to factor, which might also capture irregular gaps in panel series. Using this time-factor in the index, <em>collapse</em>'s functions efficiently perform correct computations on irregular sequences and panels without the need to 'expand' the data / fill gaps. <code>is_irregular</code> can be used to check for irregularity in the entire sequence / panel or separately for each individual in panel data.</p></li>
<li><p>Support computations inside <b>data-masking functions and formulas</b>, by virtue of "<b>deep indexation</b>": Each variable inside an 'indexed_frame' is an 'indexed_series' which contains in it's 'index_df' attribute an external pointer to the 'index_df' attribute of the frame. Functions operating on 'indexed_series' stored inside the frame (such as <code><a href='https://rdrr.io/r/base/with.html'>with(data, flag(column))</a></code>) can fetch the index from this pointer. This allows worry-free application inside arbitrary data masking environments (<code>with</code>, <code><a href='https://magrittr.tidyverse.org/reference/exposition.html'>%$%</a></code>, <code>attach</code>, etc..) and estimation commands (<code>glm</code>, <code>feols</code>, <code>lmrob</code> etc..) without duplication of the index in memory. A limitation is that external pointers are only valid during the present R session, thus when saving an 'indexed_frame' and loading it again, you need to call <code>data = reindex(data)</code> before computing on it.</p></li>
</ul>

<p>Indexed series also have simple <a href='https://rdrr.io/r/base/groupGeneric.html'>Math</a> and <a href='https://rdrr.io/r/base/groupGeneric.html'>Ops</a> methods, which apply the operation to the unindexed series and shallow copy the attributes of the original object to the result, unless the result it is a logical vector (from operations like <code><a href='https://rdrr.io/r/base/Logic.html'>!</a></code>, <code><a href='https://rdrr.io/r/base/Comparison.html'>==</a></code> etc.). For <a href='https://rdrr.io/r/base/groupGeneric.html'>Ops</a> methods, if the LHS object is an 'indexed_series' its attributes are taken, otherwise the attributes of the RHS object are taken.</p>
<p><b>Limits to plm Compatibility</b></p>
<p>In contrast to 'pseries' and 'pdata.frame's, 'indexed_series' and 'indexed_frames' do not have descriptive "names" or "row.names" attributes attached to them, mainly for efficiency reasons.</p>
<p>Furthermore, the index is stored in an attribute named 'index_df' (same as the class name), not 'index' as in <em>plm</em>, mainly to make these classes work with <em>data.table</em>, <em>tsibble</em> and <em>xts</em>, which also utilize 'index' attributes. This for the most part poses no problem to plm compatibility because plm source code fetches the index using <code><a href='https://rdrr.io/r/base/attr.html'>attr(x, "index")</a></code>, and <code><a href='https://rdrr.io/r/base/attr.html'>attr</a></code> by default performs partial matching. <!-- %It however allows plm objects to be indexed again / doubly indexed with both 'index' and 'index_df' attributes, so care needs to be taken when working with \emph{plm}. --></p>
<p>A much greater obstacle in working with <em>plm</em> is that some internal <em>plm</em> code is hinged on there being no <code>[.pseries</code> method, and the existence of <code>[.indexed_series</code> limits the use of these sub-classes in most <em>plm</em> estimation commands. Therefore the <code>to_plm</code> function is provided to efficiently coerce the sub-classes to ordinary plm objects before estimation. See Examples.</p>
<p>Overall these classes don't really benefit <em>plm</em>, especially given that collapse's plm methods also support native plm objects. However, they work very well inside other models and software, including <em>stats</em> models, <em>fixest</em> / <em>lfe</em>, and a whole bunch of time series and ML models. See Examples.</p>
<p><b>Performance Considerations</b></p>
<p>When indexing long time-series or panels with a single variable, setting <code>single = "id" or "time"</code> avoids a potentially expensive call to <code><a href='https://rdrr.io/pkg/data.table/man/duplicated.html'>anyDuplicated</a></code>. Note also that when panel-data are regular and sorted, omitting the time variable in the index can bring &gt;= 2x performance improvements in operations like lagging and differencing (alternatively use <code>shift = "row"</code> argument to <code><a href='flag.html'>flag</a></code>, <code><a href='fdiff.html'>fdiff</a></code> etc.) .</p>
<p>When dealing with long Date or POSIXct time sequences, it may also be that the internal processing by <code><a href='timeid.html'>timeid</a></code> is slow simply because calling <code><a href='https://rdrr.io/r/base/strptime.html'>strftime</a></code> on these sequences to create factor levels is slow. In this case you may choose to generate an index factor with integer levels by passing <code><a href='timeid.html'>timeid(t)</a></code> to <code>findex_by</code> or <code>reindex</code> (which by default generates a 'qG' object which is internally converted to factor using <code>as_factor_qG</code>. The lazy evaluation of expressions like <code><a href='https://rdrr.io/r/base/character.html'>as.character(seq_len(nlev))</a></code> in modern R makes this extremely efficient).</p>


<p><b>Print Method</b></p>
<p>The print methods for 'indexed_frame' and 'indexed_series' first call <code><a href='https://rdrr.io/r/base/print.html'>print(unindex(x), ...)</a></code>, followed by the index variables with the number of categories (index factor levels) in square brackets. If the time factor contains unused levels (= irregularity in the sequence), the square brackets indicate the number of used levels (periods), followed by the total number of levels (periods in the sequence) in parentheses.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='timeid.html'>timeid</a></code>,
<a href='time-series-panel-series.html'>Time Series and Panel Series</a>, <a href='index.html'>Collapse Overview</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>opts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>max.print <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='co'># Indexing panel data ----------------------------------------------------------</span>

<span class='va'>wldi</span> <span class='op'>&lt;-</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>iso3c</span>, <span class='va'>year</span><span class='op'>)</span>
<span class='va'>wldi</span>
</div><div class='output co'>#&gt;       country iso3c       date year decade     region     income  OECD PCGDP
#&gt; 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA
#&gt; 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA
#&gt; 3 Afghanistan   AFG 1963-01-01 1962   1960 South Asia Low income FALSE    NA
#&gt; 4 Afghanistan   AFG 1964-01-01 1963   1960 South Asia Low income FALSE    NA
#&gt; 5 Afghanistan   AFG 1965-01-01 1964   1960 South Asia Low income FALSE    NA
#&gt; 6 Afghanistan   AFG 1966-01-01 1965   1960 South Asia Low income FALSE    NA
#&gt; 7 Afghanistan   AFG 1967-01-01 1966   1960 South Asia Low income FALSE    NA
#&gt;   LIFEEX GINI       ODA      POP
#&gt; 1 32.446   NA 116769997  8996973
#&gt; 2 32.962   NA 232080002  9169410
#&gt; 3 33.471   NA 112839996  9351441
#&gt; 4 33.971   NA 237720001  9543205
#&gt; 5 34.463   NA 295920013  9744781
#&gt; 6 34.948   NA 341839996  9956320
#&gt; 7 35.430   NA 311609985 10174836
#&gt;  [ reached 'max' / getOption("max.print") -- omitted 13169 rows ]
#&gt; 
#&gt; Indexed by:  iso3c [216] | year [61] </div><div class='input'><span class='va'>wldi</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>,<span class='fl'>1</span><span class='op'>]</span>                 <span class='co'># Works like a data frame</span>
</div><div class='output co'>#&gt;   [1] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;   [6] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [11] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [16] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [21] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [26] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [31] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [36] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [41] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [46] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [51] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [56] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"
#&gt;  [61] "Afghanistan" "Albania"     "Albania"     "Albania"     "Albania"    
#&gt;  [66] "Albania"     "Albania"     "Albania"     "Albania"     "Albania"    
#&gt;  [71] "Albania"     "Albania"     "Albania"     "Albania"     "Albania"    
#&gt;  [76] "Albania"     "Albania"     "Albania"     "Albania"     "Albania"    
#&gt;  [81] "Albania"     "Albania"     "Albania"     "Albania"     "Albania"    
#&gt;  [86] "Albania"     "Albania"     "Albania"     "Albania"     "Albania"    
#&gt;  [91] "Albania"     "Albania"     "Albania"     "Albania"     "Albania"    
#&gt;  [96] "Albania"     "Albania"     "Albania"     "Albania"     "Albania"    
#&gt; 
#&gt; Indexed by:  iso3c [2] | year [61] </div><div class='input'><span class='va'>POP</span> <span class='op'>&lt;-</span> <span class='va'>wldi</span><span class='op'>$</span><span class='va'>POP</span>               <span class='co'># indexed_series</span>
<span class='fu'><a href='qsu.html'>qsu</a></span><span class='op'>(</span><span class='va'>POP</span><span class='op'>)</span>                      <span class='co'># Summary statistics</span>
</div><div class='output co'>#&gt;              N/T         Mean           SD          Min             Max
#&gt; Overall    12919  24'245971.6   102'120674         2833  1.39771500e+09
#&gt; Between      216    24'178573  98'616506.7    8343.3333  1.08786967e+09
#&gt; Within   59.8102  24'245971.6  26'803077.4  -405'793067      510'077008</div><div class='input'><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>POP</span><span class='op'>)</span>                        <span class='co'># Population growth</span>
</div><div class='output co'>#&gt;   [1]         NA  1.9166113  1.9851986  2.0506358  2.1122464  2.1707928
#&gt;   [7]  2.1947467  2.2122224  2.2801797  2.4133823  2.5690449  2.7010262
#&gt;  [13]  2.7517016  2.6947859  2.5104297  2.2251761  2.0011805  1.7632030
#&gt;  [19]  1.2898645  0.5236261 -0.4067167 -1.3838794 -2.1952033 -2.6764778
#&gt;  [25] -2.6594766 -2.1802494 -1.6922892 -1.1217024  0.1160839  2.1593380
#&gt;  [31]  4.5786219  7.1437882  8.9219301  9.1888632  7.9607739  6.0608254
#&gt;  [37]  4.1013421  2.6716031  1.9664025  2.1941643  3.0197497  3.9799657
#&gt;  [43]  4.5993546  4.7790451  4.4162776  3.7513845  3.0356420  2.5251987
#&gt;  [49]  2.2941982  2.4259805  2.7846424  3.1930437  3.4663103  3.5563673
#&gt;  [55]  3.4125163  3.1249152  2.8172726  2.5810946  2.4134239  2.3387468
#&gt;  [61]         NA         NA  3.1700646  3.1039282  2.9978046  2.9225795
#&gt;  [67]  2.7922950  2.6695753  2.6650851  2.8832956  2.9384277  2.5836638
#&gt;  [73]  2.4525645  2.5263580  2.3906816  2.3238034  2.3278346  2.2327972
#&gt;  [79]  2.2379263  2.0974353  2.0093786  2.0690785  2.0231684  2.1357595
#&gt;  [85]  2.1435360  2.1262254  2.0772758  1.9520285  2.0171142  1.9046214
#&gt;  [91]  2.7243108  1.8153666 -0.6009964 -0.6045996 -0.6083081 -0.6120001
#&gt;  [97] -0.6157998 -0.6195840 -0.6234784 -0.6273582
#&gt;  [ reached getOption("max.print") -- omitted 13076 entries ]
#&gt; attr(,"label")
#&gt; [1] "Population, total"
#&gt; 
#&gt; Indexed by:  iso3c [216] | year [61] </div><div class='input'><span class='fu'><a href='fscale.html'>STD</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>POP</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>         <span class='co'># Within-standardized 1 and 10-year growth rates</span>
</div><div class='output co'>#&gt;                     G1         L10G1
#&gt;     [1,]            NA            NA
#&gt;     [2,] -2.404379e-01            NA
#&gt;     [3,] -2.122758e-01            NA
#&gt;     [4,] -1.854071e-01            NA
#&gt;     [5,] -1.601097e-01            NA
#&gt;     [6,] -1.360704e-01            NA
#&gt;     [7,] -1.262349e-01            NA
#&gt;     [8,] -1.190593e-01            NA
#&gt;     [9,] -9.115593e-02            NA
#&gt;    [10,] -3.646264e-02            NA
#&gt;    [11,]  2.745275e-02 -2.502986e-01
#&gt;    [12,]  8.164455e-02 -2.072055e-01
#&gt;    [13,]  1.024520e-01 -1.648010e-01
#&gt;    [14,]  7.908227e-02 -1.289204e-01
#&gt;    [15,]  3.385202e-03 -1.066142e-01
#&gt;    [16,] -1.137405e-01 -1.035575e-01
#&gt;    [17,] -2.057136e-01 -1.144404e-01
#&gt;    [18,] -3.034277e-01 -1.396334e-01
#&gt;    [19,] -4.977815e-01 -1.949160e-01
#&gt;    [20,] -8.124006e-01 -2.992510e-01
#&gt;    [21,] -1.194401e+00 -4.602688e-01
#&gt;    [22,] -1.595626e+00 -6.746138e-01
#&gt;    [23,] -1.928758e+00 -9.237424e-01
#&gt;    [24,] -2.126370e+00 -1.181362e+00
#&gt;    [25,] -2.119389e+00 -1.416777e+00
#&gt;    [26,] -1.922618e+00 -1.607795e+00
#&gt;    [27,] -1.722260e+00 -1.761378e+00
#&gt;    [28,] -1.487976e+00 -1.877266e+00
#&gt;    [29,] -9.797383e-01 -1.923294e+00
#&gt;    [30,] -1.407738e-01 -1.859412e+00
#&gt;    [31,]  8.525893e-01 -1.659693e+00
#&gt;    [32,]  1.905852e+00 -1.297409e+00
#&gt;    [33,]  2.635961e+00 -7.800175e-01
#&gt;    [34,]  2.745564e+00 -1.619956e-01
#&gt;    [35,]  2.241308e+00  4.585063e-01
#&gt;    [36,]  1.461185e+00  9.899186e-01
#&gt;    [37,]  6.566172e-01  1.392975e+00
#&gt;    [38,]  6.956334e-02  1.670811e+00
#&gt;    [39,] -2.199935e-01  1.809795e+00
#&gt;    [40,] -1.264740e-01  1.812406e+00
#&gt;    [41,]  2.125131e-01  1.698199e+00
#&gt;    [42,]  6.067798e-01  1.475333e+00
#&gt;    [43,]  8.611022e-01  1.184657e+00
#&gt;    [44,]  9.348836e-01  9.005781e-01
#&gt;    [45,]  7.859304e-01  6.789725e-01
#&gt;    [46,]  5.129239e-01  5.368227e-01
#&gt;    [47,]  2.190385e-01  4.714477e-01
#&gt;    [48,]  9.449382e-03  4.624347e-01
#&gt;    [49,] -8.539992e-02  4.827251e-01
#&gt;    [50,] -3.128982e-02  4.970885e-01
#&gt;  [ reached getOption("max.print") -- omitted 13126 rows ]
#&gt; attr(,"label")
#&gt; [1] "Population, total"
#&gt; attr(,"class")
#&gt; [1] "numeric" "matrix" 
#&gt; 
#&gt; Indexed by:  iso3c [216] | year [61] </div><div class='input'><span class='fu'><a href='psmat.html'>psmat</a></span><span class='op'>(</span><span class='va'>POP</span><span class='op'>)</span>                    <span class='co'># Panel-Series Matrix</span>
</div><div class='output co'>#&gt;         1960     1961     1962     1963     1964     1965     1966     1967
#&gt; ABW 5.42e+04 5.54e+04 5.62e+04 5.67e+04 5.70e+04 5.74e+04 5.77e+04 5.81e+04
#&gt;         1968     1969     1970     1971     1972     1973     1974     1975
#&gt; ABW 5.84e+04 5.87e+04 5.91e+04 5.94e+04 5.98e+04 6.02e+04 6.05e+04 6.07e+04
#&gt;         1976     1977     1978     1979     1980     1981     1982     1983
#&gt; ABW 6.06e+04 6.04e+04 6.01e+04 6.00e+04 6.01e+04 6.06e+04 6.13e+04 6.22e+04
#&gt;         1984     1985     1986     1987     1988     1989     1990     1991
#&gt; ABW 6.28e+04 6.30e+04 6.26e+04 6.18e+04 6.11e+04 6.10e+04 6.21e+04 6.46e+04
#&gt;         1992     1993     1994     1995     1996     1997     1998     1999
#&gt; ABW 6.82e+04 7.25e+04 7.67e+04 8.03e+04 8.32e+04 8.55e+04 8.73e+04 8.90e+04
#&gt;         2000     2001     2002     2003     2004     2005     2006     2007
#&gt; ABW 9.09e+04 9.29e+04 9.50e+04 9.70e+04 9.87e+04 1.00e+05 1.01e+05 1.01e+05
#&gt;         2008     2009     2010     2011     2012     2013     2014     2015
#&gt; ABW 1.01e+05 1.01e+05 1.02e+05 1.02e+05 1.03e+05 1.03e+05 1.04e+05 1.04e+05
#&gt;         2016     2017     2018     2019 2020
#&gt; ABW 1.05e+05 1.05e+05 1.06e+05 1.06e+05   NA
#&gt;  [ reached getOption("max.print") -- omitted 215 rows ]</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='psmat.html'>psmat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>POP</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='indexing-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>POP</span><span class='op'>[</span><span class='fl'>30</span><span class='op'>:</span><span class='fl'>5000</span><span class='op'>]</span>                  <span class='co'># Subsetting indexed_series</span>
</div><div class='output co'>#&gt;   [1] 11868877 12412308 13299017 14485546 15816603 17075727 18110657 18853437
#&gt;   [9] 19357126 19737765 20170844 20779953 21606988 22600770 23680871 24726684
#&gt;  [17] 25654277 26433049 27100536 27722276 28394813 29185507 30117413 31161376
#&gt;  [25] 32269589 33370794 34413603 35383128 36296400 37172386 38041754       NA
#&gt;  [33]  1608800  1659800  1711319  1762621  1814135  1864791  1914573  1965598
#&gt;  [41]  2022272  2081695  2135479  2187853  2243126  2296752  2350124  2404831
#&gt;  [49]  2458526  2513546  2566266  2617832  2671997  2726056  2784278  2843960
#&gt;  [57]  2904429  2964762  3022635  3083605  3142336  3227943  3286542  3266790
#&gt;  [65]  3247039  3227287  3207536  3187784  3168033  3148281  3128530  3108778
#&gt;  [73]  3089027  3060173  3051010  3039616  3026939  3011487  2992547  2970017
#&gt;  [81]  2947314  2927519  2913021  2905195  2900401  2895092  2889104  2880703
#&gt;  [89]  2876101  2873457  2866376  2854191       NA 11057863 11336339 11619828
#&gt;  [97] 11912803 12221675 12550885 12902627
#&gt;  [ reached getOption("max.print") -- omitted 4871 entries ]
#&gt; 
#&gt; Indexed by:  iso3c [82] | year [61] </div><div class='input'><span class='fu'><a href='fdiff.html'>Dlog</a></span><span class='op'>(</span><span class='va'>POP</span><span class='op'>[</span><span class='fl'>30</span><span class='op'>:</span><span class='fl'>5000</span><span class='op'>]</span><span class='op'>)</span>            <span class='co'># Log-difference of subset</span>
</div><div class='output co'>#&gt;   [1]            NA  0.0447689651  0.0690015617  0.0854612020  0.0879088864
#&gt;   [6]  0.0765977703  0.0588425681  0.0401946820  0.0263653889  0.0194731853
#&gt;  [11]  0.0217043897  0.0297505285  0.0390280570  0.0449671956  0.0466836149
#&gt;  [16]  0.0432153930  0.0368273180  0.0299047809  0.0249384230  0.0226827714
#&gt;  [21]  0.0239702099  0.0274657628  0.0314312590  0.0340758697  0.0349458905
#&gt;  [26]  0.0335558166  0.0307708360  0.0277831741  0.0254834664  0.0238476110
#&gt;  [31]  0.0231181722            NA            NA  0.0312085537  0.0305673050
#&gt;  [36]  0.0295374876  0.0288068643  0.0275402124  0.0263456388  0.0263019035
#&gt;  [41]  0.0284251071  0.0289608339  0.0255085118  0.0242297202  0.0249497311
#&gt;  [46]  0.0236255222  0.0229721418  0.0230115381  0.0220823525  0.0221325218
#&gt;  [51]  0.0207574190  0.0198945702  0.0204796386  0.0200297431  0.0211327178
#&gt;  [56]  0.0212088533  0.0210393662  0.0205599461  0.0193322081  0.0199703996
#&gt;  [61]  0.0188671053  0.0268786199  0.0179908559 -0.0060280968 -0.0060643473
#&gt;  [66] -0.0061016579 -0.0061388051 -0.0061770366 -0.0062151140 -0.0062543010
#&gt;  [71] -0.0062933439 -0.0063335227 -0.0063735683 -0.0093847043 -0.0029987670
#&gt;  [76] -0.0037414917 -0.0041793138 -0.0051179012 -0.0063091124 -0.0075571876
#&gt;  [81] -0.0076734296 -0.0067389405 -0.0049646196 -0.0026901733 -0.0016515104
#&gt;  [86] -0.0018321138 -0.0020704700 -0.0029120579 -0.0015988041 -0.0009197229
#&gt;  [91] -0.0024673204 -0.0042600737            NA            NA  0.0248716481
#&gt;  [96]  0.0246995426  0.0249007549  0.0255973106  0.0265801663  0.0276397530
#&gt;  [ reached getOption("max.print") -- omitted 4871 entries ]
#&gt; 
#&gt; Indexed by:  iso3c [82] | year [61] </div><div class='input'><span class='fu'><a href='psacf.html'>psacf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/identity.html'>identity</a></span><span class='op'>(</span><span class='va'>POP</span><span class='op'>[</span><span class='fl'>30</span><span class='op'>:</span><span class='fl'>5000</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># ACF of subset</span>
</div><div class='img'><img src='indexing-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='flag.html'>L</a></span><span class='op'>(</span><span class='fu'><a href='fdiff.html'>Dlog</a></span><span class='op'>(</span><span class='va'>POP</span><span class='op'>[</span><span class='fl'>30</span><span class='op'>:</span><span class='fl'>5000</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span> <span class='co'># Multiple computations on subset</span>
</div><div class='output co'>#&gt;              F1.Dlog1         Dlog1      L1.Dlog1   F1.L10Dlog1      L10Dlog1
#&gt;    [1,]  4.476897e-02            NA            NA            NA            NA
#&gt;    [2,]  6.900156e-02  4.476897e-02            NA            NA            NA
#&gt;    [3,]  8.546120e-02  6.900156e-02  4.476897e-02            NA            NA
#&gt;    [4,]  8.790889e-02  8.546120e-02  6.900156e-02            NA            NA
#&gt;    [5,]  7.659777e-02  8.790889e-02  8.546120e-02            NA            NA
#&gt;    [6,]  5.884257e-02  7.659777e-02  8.790889e-02            NA            NA
#&gt;    [7,]  4.019468e-02  5.884257e-02  7.659777e-02            NA            NA
#&gt;    [8,]  2.636539e-02  4.019468e-02  5.884257e-02            NA            NA
#&gt;    [9,]  1.947319e-02  2.636539e-02  4.019468e-02            NA            NA
#&gt;   [10,]  2.170439e-02  1.947319e-02  2.636539e-02  0.5303185995            NA
#&gt;   [11,]  2.975053e-02  2.170439e-02  1.947319e-02  0.5153001629  0.5303185995
#&gt;   [12,]  3.902806e-02  2.975053e-02  2.170439e-02  0.4853266582  0.5153001629
#&gt;   [13,]  4.496720e-02  3.902806e-02  2.975053e-02  0.4448326518  0.4853266582
#&gt;   [14,]  4.668361e-02  4.496720e-02  3.902806e-02  0.4036073803  0.4448326518
#&gt;   [15,]  4.321539e-02  4.668361e-02  4.496720e-02  0.3702250030  0.4036073803
#&gt;   [16,]  3.682732e-02  4.321539e-02  4.668361e-02  0.3482097528  0.3702250030
#&gt;           L1.L10Dlog1
#&gt;    [1,]            NA
#&gt;    [2,]            NA
#&gt;    [3,]            NA
#&gt;    [4,]            NA
#&gt;    [5,]            NA
#&gt;    [6,]            NA
#&gt;    [7,]            NA
#&gt;    [8,]            NA
#&gt;    [9,]            NA
#&gt;   [10,]            NA
#&gt;   [11,]            NA
#&gt;   [12,]  0.5303185995
#&gt;   [13,]  0.5153001629
#&gt;   [14,]  0.4853266582
#&gt;   [15,]  0.4448326518
#&gt;   [16,]  0.4036073803
#&gt;  [ reached getOption("max.print") -- omitted 4955 rows ]
#&gt; attr(,"class")
#&gt; [1] "numeric" "matrix" 
#&gt; 
#&gt; Indexed by:  iso3c [82] | year [61] </div><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>
<span class='co'># Fast Statistical Functions don't have dedicated methods</span>
<span class='co'># Thus for aggregation we need to unindex beforehand ...</span>
<span class='fu'><a href='fmean.html'>fmean</a></span><span class='op'>(</span><span class='fu'>unindex</span><span class='op'>(</span><span class='va'>POP</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 24245972
#&gt; attr(,"label")
#&gt; [1] "Population, total"</div><div class='input'><span class='va'>wldi</span> <span class='op'>%&gt;%</span> <span class='fu'>unindex</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='GRP.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>iso3c</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fselect-get_vars-add_vars.html'>num_vars</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fmean.html'>fmean</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    iso3c year   decade      PCGDP   LIFEEX     GINI        ODA         POP
#&gt; 1    ABW 1990 1985.574 25413.8370 72.40653       NA   33245000    76268.63
#&gt; 2    AFG 1990 1985.574   483.8351 49.19717       NA 1487548499 18362258.22
#&gt; 3    AGO 1990 1985.574  2887.6879 46.75805 48.66667  267452068 13823228.03
#&gt; 4    ALB 1990 1985.574  2819.2400 71.68027 31.41111  312928126  2708297.17
#&gt; 5    AND 1990 1985.574 40083.0911       NA       NA         NA    51547.35
#&gt; 6    ARE 1990 1985.574 64616.4864 69.37793 29.25000   13384222  3089064.62
#&gt; 7    ARG 1990 1985.574  7907.8326 71.12565 45.92258  106930833 32301197.52
#&gt; 8    ARM 1990 1985.574  2520.1808 70.67953 32.24500  282426894  2912376.95
#&gt; 9    ASM 1990 1985.574 10071.0659       NA       NA         NA    43115.10
#&gt; 10   ATG 1990 1985.574 11490.5217 70.79783       NA    8948085    70931.67
#&gt; 11   AUS 1990 1985.574 37023.3332 76.60939 33.42000         NA 17103502.10
#&gt; 12   AUT 1990 1985.574 33039.6996 75.30715 29.96190         NA  7844922.22
#&gt;  [ reached 'max' / getOption("max.print") -- omitted 204 rows ]</div><div class='input'>
<span class='co'># ... or unindex after taking group identifiers from the index</span>
<span class='fu'><a href='fmean.html'>fmean</a></span><span class='op'>(</span><span class='fu'>unindex</span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>fgrowth</a></span><span class='op'>(</span><span class='va'>POP</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'>ix</span><span class='op'>(</span><span class='va'>POP</span><span class='op'>)</span><span class='op'>$</span><span class='va'>iso3c</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         ABW         AFG         AGO         ALB         AND         ARE 
#&gt;  1.15986116  2.50218519  3.04019111  0.98728941  3.03828499  8.33912222 
#&gt;         ARG         ARM         ASM         ATG         AUS         AUT 
#&gt;  1.34100846  0.78894579  1.74127860  0.99964449  1.54424580  0.39301937 
#&gt;         AZE         BDI         BEL         BEN         BFA         BGD 
#&gt;  1.61742943  2.43172184  0.38832202  2.71473569  2.46698310  2.09594336 
#&gt;         BGR         BHR         BHS         BIH         BLR         BLZ 
#&gt; -0.20095889  4.01156764  2.17972600  0.04870005  0.23697183  2.48033866 
#&gt;         BMU         BOL         BRA         BRB         BRN         BTN 
#&gt;  0.62656641  1.96310764  1.83756339  0.36894714  2.87598784  2.10961311 
#&gt;         BWA         CAF         CAN         CHE         CHI         CHL 
#&gt;  2.61689824  1.97141241  1.26547829  0.81130910  0.77252949  1.44461721 
#&gt;         CHN         CIV         CMR         COD         COG         COL 
#&gt;  1.26475057  3.43990856  2.76520875  2.99210471  2.86194380  1.95730439 
#&gt;         COM         CPV         CRI         CUB         CUW         CYM 
#&gt;  2.56471792  1.71779560  2.28825488  0.78844375  0.40380104  3.65940831 
#&gt;         CYP         CZE         DEU         DJI         DMA         DNK 
#&gt;  1.26066375  0.17964024  0.22511110  4.28964392  0.30770228  0.40573747 
#&gt;         DOM         DZA         ECU         EGY         ERI         ESP 
#&gt;  2.02552207  2.33239690  2.30053844  2.27489144  2.30900292  0.74430651 
#&gt;         EST         ETH         FIN         FJI         FRA         FRO 
#&gt;  0.15848536  2.78733512  0.37433864  1.39760426  0.61832292  0.58122004 
#&gt;         FSM         GAB         GBR         GEO         GHA         GIB 
#&gt;  1.61438473  2.51981406  0.41364183  0.04208078  2.61483065  0.62304330 
#&gt;         GIN         GMB         GNB         GNQ         GRC         GRD 
#&gt;  2.22222005  3.20665347  1.94813489  2.90829344  0.42877116  0.37664108 
#&gt;         GRL         GTM         GUM         GUY         HKG         HND 
#&gt;  0.94243164  2.38752133  1.57347586  0.53785497  1.53025140  2.68835972 
#&gt;         HRV         HTI         HUN         IDN         IMN         IND 
#&gt; -0.02747626  1.82922709 -0.03595458  1.92885381  0.95179795  1.89913064 
#&gt;         IRL         IRN         IRQ         ISL         ISR         ITA 
#&gt;  0.94976617  2.28679110  2.89832985  1.22870821  2.50001613  0.31178403 
#&gt;         JAM         JOR         JPN         KAZ 
#&gt;  1.01194681  4.13321502  0.53054639  1.06835201 
#&gt;  [ reached getOption("max.print") -- omitted 116 entries ]
#&gt; attr(,"label")
#&gt; [1] "Population, total"</div><div class='input'><span class='va'>wldi</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fselect-get_vars-add_vars.html'>num_vars</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='GRP.html'>fgroup_by</a></span><span class='op'>(</span>iso3c <span class='op'>=</span> <span class='fu'>ix</span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>$</span><span class='va'>iso3c</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unindex</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fmean.html'>fmean</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    iso3c year   decade      PCGDP   LIFEEX     GINI        ODA         POP
#&gt; 1    ABW 1990 1985.574 25413.8370 72.40653       NA   33245000    76268.63
#&gt; 2    AFG 1990 1985.574   483.8351 49.19717       NA 1487548499 18362258.22
#&gt; 3    AGO 1990 1985.574  2887.6879 46.75805 48.66667  267452068 13823228.03
#&gt; 4    ALB 1990 1985.574  2819.2400 71.68027 31.41111  312928126  2708297.17
#&gt; 5    AND 1990 1985.574 40083.0911       NA       NA         NA    51547.35
#&gt; 6    ARE 1990 1985.574 64616.4864 69.37793 29.25000   13384222  3089064.62
#&gt; 7    ARG 1990 1985.574  7907.8326 71.12565 45.92258  106930833 32301197.52
#&gt; 8    ARM 1990 1985.574  2520.1808 70.67953 32.24500  282426894  2912376.95
#&gt; 9    ASM 1990 1985.574 10071.0659       NA       NA         NA    43115.10
#&gt; 10   ATG 1990 1985.574 11490.5217 70.79783       NA    8948085    70931.67
#&gt; 11   AUS 1990 1985.574 37023.3332 76.60939 33.42000         NA 17103502.10
#&gt; 12   AUT 1990 1985.574 33039.6996 75.30715 29.96190         NA  7844922.22
#&gt;  [ reached 'max' / getOption("max.print") -- omitted 204 rows ]</div><div class='input'>
<span class='co'># With matrix methods it is easier as most attributes are dropped upon aggregation.</span>
<span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>POP</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fmean.html'>fmean</a></span><span class='op'>(</span><span class='fu'>ix</span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>$</span><span class='va'>iso3c</span><span class='op'>)</span>
</div><div class='output co'>#&gt;              G1       L10G1
#&gt; ABW  1.15986116  13.5405797
#&gt; AFG  2.50218519  29.7453631
#&gt; AGO  3.04019111  37.2423846
#&gt; ALB  0.98728941  10.4611010
#&gt; AND  3.03828499  36.8630696
#&gt; ARE  8.33912222 145.2957118
#&gt; ARG  1.34100846  14.3289740
#&gt; ARM  0.78894579   7.1746628
#&gt; ASM  1.74127860  20.2992819
#&gt; ATG  0.99964449  10.0195522
#&gt; AUS  1.54424580  16.0434792
#&gt; AUT  0.39301937   3.5211125
#&gt; AZE  1.61742943  16.4526447
#&gt; BDI  2.43172184  26.7915415
#&gt; BEL  0.38832202   3.6354631
#&gt; BEN  2.71473569  31.9252634
#&gt; BFA  2.46698310  28.3385127
#&gt; BGD  2.09594336  23.3556445
#&gt; BGR -0.20095889  -2.3160917
#&gt; BHR  4.01156764  50.7327853
#&gt; BHS  2.17972600  22.6999691
#&gt; BIH  0.04870005   0.5070281
#&gt; BLR  0.23697183   2.1725510
#&gt; BLZ  2.48033866  27.8347280
#&gt; BMU  0.62656641   5.7036637
#&gt; BOL  1.96310764  21.9315509
#&gt; BRA  1.83756339  20.1289837
#&gt; BRB  0.36894714   3.9565564
#&gt; BRN  2.87598784  33.4451942
#&gt; BTN  2.10961311  23.9024113
#&gt; BWA  2.61689824  31.1856395
#&gt; CAF  1.97141241  22.7889510
#&gt; CAN  1.26547829  12.8834454
#&gt; CHE  0.81130910   7.3670756
#&gt; CHI  0.77252949   7.6461689
#&gt; CHL  1.44461721  15.1126169
#&gt; CHN  1.26475057  14.1377449
#&gt; CIV  3.43990856  41.3124185
#&gt; CMR  2.76520875  32.0848829
#&gt; COD  2.99210471  34.3054664
#&gt; COG  2.86194380  33.2530915
#&gt; COL  1.95730439  21.0181093
#&gt; COM  2.56471792  30.1142665
#&gt; CPV  1.71779560  18.1240199
#&gt; CRI  2.28825488  25.5492669
#&gt; CUB  0.78844375   7.7426728
#&gt; CUW  0.40380104   3.4237402
#&gt; CYM  3.65940831  50.0769227
#&gt; CYP  1.26066375  14.7376462
#&gt; CZE  0.17964024   1.6253765
#&gt;  [ reached getOption("max.print") -- omitted 166 rows ]</div><div class='input'>
<span class='co'># Example of index with multiple ids</span>
<span class='va'>GGDC10S</span> <span class='op'>%&gt;%</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>Variable</span>, <span class='va'>Country</span>, <span class='va'>Year</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span> <span class='co'># default is interact.ids = TRUE</span>
</div><div class='output co'>#&gt;   Country Regioncode             Region Variable Year      AGR      MIN
#&gt; 1     BWA        SSA Sub-saharan Africa       VA 1960       NA       NA
#&gt; 2     BWA        SSA Sub-saharan Africa       VA 1961       NA       NA
#&gt; 3     BWA        SSA Sub-saharan Africa       VA 1962       NA       NA
#&gt; 4     BWA        SSA Sub-saharan Africa       VA 1963       NA       NA
#&gt; 5     BWA        SSA Sub-saharan Africa       VA 1964 16.30154 3.494075
#&gt; 6     BWA        SSA Sub-saharan Africa       VA 1965 15.72700 2.495768
#&gt;         MAN        PU       CON      WRT      TRA     FIRE      GOV      OTH
#&gt; 1        NA        NA        NA       NA       NA       NA       NA       NA
#&gt; 2        NA        NA        NA       NA       NA       NA       NA       NA
#&gt; 3        NA        NA        NA       NA       NA       NA       NA       NA
#&gt; 4        NA        NA        NA       NA       NA       NA       NA       NA
#&gt; 5 0.7365696 0.1043936 0.6600454 6.243732 1.658928 1.119194 4.822485 2.341328
#&gt; 6 1.0181992 0.1350976 1.3462312 7.064825 1.939007 1.246789 5.695848 2.678338
#&gt;        SUM
#&gt; 1       NA
#&gt; 2       NA
#&gt; 3       NA
#&gt; 4       NA
#&gt; 5 37.48229
#&gt; 6 39.34710
#&gt; 
#&gt; Indexed by:  Variable.Country [1] | Year [6 (67)] </div><div class='input'><span class='va'>GGDCi</span> <span class='op'>&lt;-</span> <span class='va'>GGDC10S</span> <span class='op'>%&gt;%</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>Variable</span>, <span class='va'>Country</span>, <span class='va'>Year</span>, interact.ids <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>GGDCi</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Country Regioncode             Region Variable Year      AGR      MIN
#&gt; 1     BWA        SSA Sub-saharan Africa       VA 1960       NA       NA
#&gt; 2     BWA        SSA Sub-saharan Africa       VA 1961       NA       NA
#&gt; 3     BWA        SSA Sub-saharan Africa       VA 1962       NA       NA
#&gt; 4     BWA        SSA Sub-saharan Africa       VA 1963       NA       NA
#&gt; 5     BWA        SSA Sub-saharan Africa       VA 1964 16.30154 3.494075
#&gt; 6     BWA        SSA Sub-saharan Africa       VA 1965 15.72700 2.495768
#&gt;         MAN        PU       CON      WRT      TRA     FIRE      GOV      OTH
#&gt; 1        NA        NA        NA       NA       NA       NA       NA       NA
#&gt; 2        NA        NA        NA       NA       NA       NA       NA       NA
#&gt; 3        NA        NA        NA       NA       NA       NA       NA       NA
#&gt; 4        NA        NA        NA       NA       NA       NA       NA       NA
#&gt; 5 0.7365696 0.1043936 0.6600454 6.243732 1.658928 1.119194 4.822485 2.341328
#&gt; 6 1.0181992 0.1350976 1.3462312 7.064825 1.939007 1.246789 5.695848 2.678338
#&gt;        SUM
#&gt; 1       NA
#&gt; 2       NA
#&gt; 3       NA
#&gt; 4       NA
#&gt; 5 37.48229
#&gt; 6 39.34710
#&gt; 
#&gt; Indexed by:  Variable [1] Country [1] | Year [6 (67)] </div><div class='input'><span class='fu'>findex</span><span class='op'>(</span><span class='va'>GGDCi</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Variable Country Year
#&gt; 1       VA     BWA 1960
#&gt; 2       VA     BWA 1961
#&gt; 3       VA     BWA 1962
#&gt; 4       VA     BWA 1963
#&gt; 5       VA     BWA 1964
#&gt; ---                 
#&gt; 5023 EMP EGY 2008
#&gt; 5024 EMP EGY 2009
#&gt; 5025 EMP EGY 2010
#&gt; 5026 EMP EGY 2011
#&gt; 5027 EMP EGY 2012
#&gt; 
#&gt; Variable [2] Country [43] | Year [67]</div><div class='input'><span class='co'># The benefit is increased flexibility for summary statistics and data transformation</span>
<span class='fu'><a href='qsu.html'>qsu</a></span><span class='op'>(</span><span class='va'>GGDCi</span>, effect <span class='op'>=</span> <span class='st'>"Country"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; , , Country
#&gt; 
#&gt;              N/T  Mean  SD  Min  Max
#&gt; Overall     5027     -   -    -    -
#&gt; Between       43     -   -    -    -
#&gt; Within   116.907     -   -    -    -
#&gt; 
#&gt; , , Regioncode
#&gt; 
#&gt;              N/T  Mean  SD  Min  Max
#&gt; Overall     5027     -   -    -    -
#&gt; Between       43     -   -    -    -
#&gt; Within   116.907     -   -    -    -
#&gt; 
#&gt; , , Region
#&gt; 
#&gt;              N/T  Mean  SD  Min  Max
#&gt; Overall     5027     -   -    -    -
#&gt; Between       43     -   -    -    -
#&gt; Within   116.907     -   -    -    -
#&gt; 
#&gt; , , Variable
#&gt; 
#&gt;              N/T  Mean  SD  Min  Max
#&gt; Overall     5027     -   -    -    -
#&gt; Between       43     -   -    -    -
#&gt; Within   116.907     -   -    -    -
#&gt; 
#&gt; , , Year
#&gt; 
#&gt;              N/T       Mean       SD        Min        Max
#&gt; Overall     5027  1981.5801  17.5704       1947       2013
#&gt; Between       43  1982.4236   5.0799  1978.7519     2011.5
#&gt; Within   116.907  1981.5801  17.4142  1948.8359  2013.8359
#&gt; 
#&gt; , , AGR
#&gt; 
#&gt;               N/T         Mean           SD           Min             Max
#&gt; Overall      4364   2'526696.5  37'129098.1             0  1.19187778e+09
#&gt; Between        43  3'081657.66  15'193918.4       91.3976       99'045233
#&gt; Within   101.4884   2'526696.5  34'362549.9  -96'494556.5  1.09535925e+09
#&gt; 
#&gt; , , MIN
#&gt; 
#&gt;               N/T         Mean           SD           Min             Max
#&gt; Overall      4355  1'867908.95  32'334251.7             0  1.10344053e+09
#&gt; Between        43  2'289538.22  12'355783.5        9.7494     80'696645.5
#&gt; 
#&gt;  [ reached getOption("max.print") -- omitted 1 row(s) and 9 matrix slice(s) ]</div><div class='input'><span class='fu'><a href='fscale.html'>STD</a></span><span class='op'>(</span><span class='va'>GGDCi</span><span class='op'>$</span><span class='va'>SUM</span>, effect <span class='op'>=</span> <span class='st'>"Variable"</span><span class='op'>)</span>            <span class='co'># Standardizing by variable</span>
</div><div class='output co'>#&gt;   [1]         NA         NA         NA         NA -0.1226776 -0.1226776
#&gt;   [7] -0.1226776 -0.1226776 -0.1226776 -0.1226776 -0.1226775 -0.1226775
#&gt;  [13] -0.1226774 -0.1226773 -0.1226772 -0.1226771 -0.1226769 -0.1226767
#&gt;  [19] -0.1226766 -0.1226762 -0.1226756 -0.1226753 -0.1226752 -0.1226744
#&gt;  [25] -0.1226738 -0.1226724 -0.1226704 -0.1226692 -0.1226661 -0.1226627
#&gt;  [31] -0.1226607 -0.1226582 -0.1226567 -0.1226550 -0.1226499 -0.1226448
#&gt;  [37] -0.1226376 -0.1226320 -0.1226275 -0.1226148 -0.1226044 -0.1225979
#&gt;  [43] -0.1225908 -0.1225861 -0.1225770 -0.1225543 -0.1225338 -0.1225158
#&gt;  [49] -0.1224963 -0.1225084 -0.1224488         NA         NA         NA
#&gt;  [55]         NA         NA -0.3807465 -0.3806958 -0.3806859 -0.3806942
#&gt;  [61] -0.3806630 -0.3805993 -0.3805239 -0.3804590 -0.3803244 -0.3802321
#&gt;  [67] -0.3801543 -0.3800409 -0.3799774 -0.3799017 -0.3798278 -0.3797127
#&gt;  [73] -0.3796025 -0.3794529 -0.3793653 -0.3793505 -0.3792470 -0.3791183
#&gt;  [79] -0.3789919 -0.3788054 -0.3785938 -0.3783907 -0.3781674 -0.3778812
#&gt;  [85] -0.3778275 -0.3777038 -0.3775947 -0.3775053 -0.3773939 -0.3773077
#&gt;  [91] -0.3768470 -0.3765509 -0.3763429 -0.3762008 -0.3762097 -0.3761913
#&gt;  [97] -0.3762620 -0.3763458 -0.3762536 -0.3759100
#&gt;  [ reached getOption("max.print") -- omitted 4927 entries ]
#&gt; attr(,"label")
#&gt; [1] "Summation of sector GDP"
#&gt; attr(,"format.stata")
#&gt; [1] "%10.0g"
#&gt; 
#&gt; Indexed by:  Variable [2] Country [43] | Year [67] </div><div class='input'><span class='fu'><a href='fscale.html'>STD</a></span><span class='op'>(</span><span class='va'>GGDCi</span><span class='op'>$</span><span class='va'>SUM</span>, effect <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Variable"</span>, <span class='st'>"Year"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># ... by variable and year</span>
</div><div class='output co'>#&gt;   [1]         NA         NA         NA         NA -0.2041456 -0.2039970
#&gt;   [7] -0.2023122 -0.2041736 -0.2058182 -0.2068329 -0.1799561 -0.1784717
#&gt;  [13] -0.1794400 -0.1809847 -0.1852166 -0.1881118 -0.1915147 -0.1952319
#&gt;  [19] -0.2000250 -0.2086539 -0.2176069 -0.2246298 -0.2285386 -0.2384116
#&gt;  [25] -0.2442721 -0.2480965 -0.2533789 -0.2618757 -0.2684392 -0.2739245
#&gt;  [31] -0.2788689 -0.2831778 -0.2934982 -0.3006316 -0.3052873 -0.3081273
#&gt;  [37] -0.3074253 -0.3039395 -0.2818521 -0.2751017 -0.2694049 -0.2606845
#&gt;  [43] -0.2576762 -0.2567207 -0.2531264 -0.2434613 -0.2351500 -0.2288238
#&gt;  [49] -0.2182615 -0.2127535 -0.2090734         NA         NA         NA
#&gt;  [55]         NA         NA -0.4596772 -0.4497862 -0.4399738 -0.4363115
#&gt;  [61] -0.4331453 -0.4247106 -0.4027655 -0.4096142 -0.4114065 -0.4141980
#&gt;  [67] -0.4082425 -0.4024895 -0.4026850 -0.4047382 -0.4056280 -0.4042404
#&gt;  [73] -0.4021641 -0.4002193 -0.3964763 -0.3950700 -0.3927108 -0.3910619
#&gt;  [79] -0.3901627 -0.3898867 -0.3901324 -0.3914711 -0.3710508 -0.3716052
#&gt;  [85] -0.3694336 -0.3694077 -0.3704525 -0.3708331 -0.3709432 -0.3720367
#&gt;  [91] -0.3716712 -0.3729654 -0.3743309 -0.3738884 -0.3752052 -0.3754277
#&gt;  [97] -0.3780230 -0.3801646 -0.3832266 -0.3866785
#&gt;  [ reached getOption("max.print") -- omitted 4927 entries ]
#&gt; attr(,"label")
#&gt; [1] "Summation of sector GDP"
#&gt; attr(,"format.stata")
#&gt; [1] "%10.0g"
#&gt; 
#&gt; Indexed by:  Variable [2] Country [43] | Year [67] </div><div class='input'><span class='co'># But time-based operations are a bit more expensive because of the necessary interactions</span>
<span class='fu'><a href='fdiff.html'>D</a></span><span class='op'>(</span><span class='va'>GGDCi</span><span class='op'>$</span><span class='va'>SUM</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   [1]            NA            NA            NA            NA            NA
#&gt;   [6]     1.8648058     3.7996670    -1.7515810    -0.2525958    10.0790095
#&gt;  [11]    15.2179271    12.1300779    31.7872318    37.4213552    35.1940244
#&gt;  [16]    36.8116252    85.0015379    44.7177833    52.5841475   158.9853717
#&gt;  [21]   198.2115288   103.9129599    23.7520357   288.7796000   214.2149426
#&gt;  [26]   515.3786450   726.9937149   439.7886989  1085.0704934  1220.4747092
#&gt;  [31]   737.8868699   879.8964485   529.0696305   617.1251820  1841.1712884
#&gt;  [36]  1803.6482296  2600.8383913  1986.0421431  1631.5058344  4552.4978100
#&gt;  [41]  3712.3024701  2342.9411903  2519.9965561  1715.6370519  3237.7063677
#&gt;  [46]  8127.4111125  7374.8681409  6430.3096108  6983.2264598 -4322.3684709
#&gt;  [51] 21358.0356275            NA            NA            NA            NA
#&gt;  [56]            NA            NA     4.8807941     0.9545929    -0.8001645
#&gt;  [61]     3.0111420     6.1276582     7.2716726     6.2475417    12.9682512
#&gt;  [66]     8.8843341     7.4951964    10.9173822     6.1179949     7.2972389
#&gt;  [71]     7.1161614    11.0837290    10.6112385    14.4113485     8.4421850
#&gt;  [76]     1.4233877     9.9704014    12.3905471    12.1749701    17.9642701
#&gt;  [81]    20.3879231    19.5583735    21.5115470    27.5587144     5.1735467
#&gt;  [86]    11.9154167    10.5097882     8.6158860    10.7242235     8.2992284
#&gt;  [91]    44.3774490    28.5241979    20.0313379    13.6837647    -0.8555820
#&gt;  [96]     1.7761664    -6.8163393    -8.0663242     8.8765863    33.0990489
#&gt;  [ reached getOption("max.print") -- omitted 4927 entries ]
#&gt; attr(,"label")
#&gt; [1] "Summation of sector GDP"
#&gt; attr(,"format.stata")
#&gt; [1] "%10.0g"
#&gt; 
#&gt; Indexed by:  Variable [2] Country [43] | Year [67] </div><div class='input'>
<span class='co'># Panel-Data modelling ---------------------------------------------------------</span>

<span class='co'># Linear model of 5-year annualized growth rates of GDP on Life Expactancy + 5y lag</span>
<span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, <span class='fl'>5</span>, p <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='flag.html'>L</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>LIFEEX</span>, <span class='fl'>5</span>, p <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>wldi</span><span class='op'>)</span> <span class='co'># p abbreviates "power"</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lm(formula = G(PCGDP, 5, p = 1/5) ~ L(G(LIFEEX, 5, p = 1/5), 
#&gt;     c(0, 5)), data = wldi)
#&gt; 
#&gt; Coefficients:
#&gt;                         (Intercept)  L(G(LIFEEX, 5, p = 1/5), c(0, 5))--  
#&gt;                              1.6021                               0.4739  
#&gt; L(G(LIFEEX, 5, p = 1/5), c(0, 5))L5  
#&gt;                              0.1716  
#&gt; </div><div class='input'>
<span class='co'># Same, adding time fixed effects via plm package: need to utilize to_plm function</span>
<span class='fu'>plm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/plm/man/plm.html'>plm</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, <span class='fl'>5</span>, p <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='flag.html'>L</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>LIFEEX</span>, <span class='fl'>5</span>, p <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'>to_plm</span><span class='op'>(</span><span class='va'>wldi</span><span class='op'>)</span>, effect <span class='op'>=</span> <span class='st'>"time"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model Formula: G(PCGDP, 5, p = 1/5) ~ L(G(LIFEEX, 5, p = 1/5), c(0, 5))
#&gt; &lt;environment: 0x0000001c5eb0a540&gt;
#&gt; 
#&gt; Coefficients:
#&gt; L(G(LIFEEX, 5, p = 1/5), c(0, 5))-- L(G(LIFEEX, 5, p = 1/5), c(0, 5))L5 
#&gt;                             0.26902                             0.34879 
#&gt; </div><div class='input'>
<span class='co'># With country and time fixed effects via fixest</span>
<span class='fu'>fixest</span><span class='fu'>::</span><span class='fu'><a href='https://lrberge.github.io/fixest/reference/feols.html'>feols</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, <span class='fl'>5</span>, p<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='flag.html'>L</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>LIFEEX</span>, <span class='fl'>5</span>, p<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>wldi</span>, fixef <span class='op'>=</span> <span class='fu'><a href='small-helpers.html'>.c</a></span><span class='op'>(</span><span class='va'>iso3c</span>, <span class='va'>year</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>NOTE: 5,596 observations removed because of NA values (LHS: 4,720, RHS: 3,522).</span></div><div class='output co'>#&gt; OLS estimation, Dep. Var.: G(PCGDP, 5, p = 1/5)
#&gt; Observations: 7,580 
#&gt; Fixed-effects: iso3c: 192,  year: 50
#&gt; Standard-errors: Clustered (iso3c) 
#&gt;                                     Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; L(G(LIFEEX, 5, p = 1/5), c(0, 5))-- 0.392178   0.104398  3.7566 0.000229 ***
#&gt; L(G(LIFEEX, 5, p = 1/5), c(0, 5))L5 0.476969   0.112195  4.2513 0.000033 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; RMSE: 3.051     Adj. R2: 0.279618
#&gt;               Within R2: 0.019289</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># Running a robust MM regression without fixed effects</span>
<span class='fu'>robustbase</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/robustbase/man/lmrob.html'>lmrob</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, <span class='fl'>5</span>, p <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='flag.html'>L</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>LIFEEX</span>, <span class='fl'>5</span>, p <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>wldi</span><span class='op'>)</span>

<span class='co'># Running a robust MM regression with country and time fixed effects</span>
<span class='va'>wldi</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fselect-get_vars-add_vars.html'>fselect</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, <span class='va'>LIFEEX</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='fgrowth.html'>fgrowth</a></span><span class='op'>(</span><span class='fl'>5</span>, power <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='ftransform.html'>ftransform</a></span><span class='op'>(</span>LIFEEX_L5 <span class='op'>=</span> <span class='fu'><a href='flag.html'>L</a></span><span class='op'>(</span><span class='va'>LIFEEX</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'># drop abbreviates drop.index.levels (not strictly needed here but more consistent)</span>
  <span class='fu'><a href='efficient-programming.html'>na_omit</a></span><span class='op'>(</span>drop <span class='op'>=</span> <span class='st'>"all"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fhdbetween-fhdwithin.html'>fhdwithin</a></span><span class='op'>(</span>na.rm <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># For TFE use fwithin(effect = "year")</span>
  <span class='fu'>unindex</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>robustbase</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/robustbase/man/lmrob.html'>lmrob</a></span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>PCGDP</span> <span class='op'>~</span><span class='va'>.</span><span class='op'>)</span>    <span class='co'># using lm() gives same result as fixest</span>

<span class='co'># Using a random forest model without fixed effects</span>
<span class='co'># ranger does not support these kinds of formulas, thus we need some preprocessing...</span>
<span class='va'>wldi</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fselect-get_vars-add_vars.html'>fselect</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, <span class='va'>LIFEEX</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='fgrowth.html'>fgrowth</a></span><span class='op'>(</span><span class='fl'>5</span>, power <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='ftransform.html'>ftransform</a></span><span class='op'>(</span>LIFEEX_L5 <span class='op'>=</span> <span class='fu'><a href='flag.html'>L</a></span><span class='op'>(</span><span class='va'>LIFEEX</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unindex</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='efficient-programming.html'>na_omit</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>ranger</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ranger/man/ranger.html'>ranger</a></span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>PCGDP</span> <span class='op'>~</span><span class='va'>.</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Indexing other data frame based classes --------------------------------------</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tibble.tidyverse.org/'>tibble</a></span><span class='op'>)</span>
<span class='va'>wlditbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='quick-conversion.html'>qTBL</a></span><span class='op'>(</span><span class='va'>wlddev</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>iso3c</span>, <span class='va'>year</span><span class='op'>)</span>
<span class='va'>wlditbl</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='co'># Works like a tibble...</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 13,176 x 1</span><span>
#&gt;    iso3c
#&gt;  </span><span style='color: #BCBCBC;'>*</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;fct&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'> 1</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'> 2</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'> 3</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'> 4</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'> 5</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'> 6</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'> 7</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'> 8</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'> 9</span><span> AFG  
#&gt; </span><span style='color: #BCBCBC;'>10</span><span> AFG  
#&gt; </span><span style='color: #949494;'># ... with 13,166 more rows</span><span>
#&gt; 
#&gt; Indexed by:  iso3c [216] | year [61] </div><div class='input'><span class='va'>wlditbl</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt;   [1] AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG
#&gt;  [19] AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG
#&gt;  [37] AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG
#&gt;  [55] AFG AFG AFG AFG AFG AFG AFG ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB
#&gt;  [73] ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB
#&gt;  [91] ALB ALB ALB ALB ALB ALB ALB ALB ALB ALB
#&gt;  [ reached getOption("max.print") -- omitted 13076 entries ]
#&gt; attr(,"label")
#&gt; [1] Country Code
#&gt; 216 Levels: ABW AFG AGO ALB AND ARE ARG ARM ASM ATG AUS AUT AZE BDI BEL ... ZWE
#&gt; 
#&gt; Indexed by:  iso3c [216] | year [61] </div><div class='input'><span class='va'>wlditbl</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>1000</span>, <span class='fl'>10</span><span class='op'>]</span>
</div><div class='output co'>#&gt; </span><span style='color: #949494;'># A tibble: 1,000 x 1</span><span>
#&gt;    LIFEEX
#&gt;  </span><span style='color: #BCBCBC;'>*</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'> 1</span><span>   32.4
#&gt; </span><span style='color: #BCBCBC;'> 2</span><span>   33.0
#&gt; </span><span style='color: #BCBCBC;'> 3</span><span>   33.5
#&gt; </span><span style='color: #BCBCBC;'> 4</span><span>   34.0
#&gt; </span><span style='color: #BCBCBC;'> 5</span><span>   34.5
#&gt; </span><span style='color: #BCBCBC;'> 6</span><span>   34.9
#&gt; </span><span style='color: #BCBCBC;'> 7</span><span>   35.4
#&gt; </span><span style='color: #BCBCBC;'> 8</span><span>   35.9
#&gt; </span><span style='color: #BCBCBC;'> 9</span><span>   36.4
#&gt; </span><span style='color: #BCBCBC;'>10</span><span>   36.9
#&gt; </span><span style='color: #949494;'># ... with 990 more rows</span><span>
#&gt; 
#&gt; Indexed by:  iso3c [17] | year [61] </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>wlditbl</span><span class='op'>)</span>
</div><div class='output co'>#&gt; </span><span style='color: #949494;'># A tibble: 6 x 13</span><span>
#&gt;   country  iso3c date        year decade region  income OECD  PCGDP LIFEEX  GINI
#&gt; </span><span style='color: #BCBCBC;'>*</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>    </span><span style='color: #949494;font-style: italic;'>&lt;fct&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;date&gt;</span><span>     </span><span style='color: #949494;font-style: italic;'>&lt;int&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;int&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;fct&gt;</span><span>   </span><span style='color: #949494;font-style: italic;'>&lt;fct&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;lgl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> Afghani~ AFG   1961-01-01  </span><span style='text-decoration: underline;'>1</span><span>960   </span><span style='text-decoration: underline;'>1</span><span>960 South ~ Low i~ FALSE    </span><span style='color: #BB0000;'>NA</span><span>   32.4    </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> Afghani~ AFG   1962-01-01  </span><span style='text-decoration: underline;'>1</span><span>961   </span><span style='text-decoration: underline;'>1</span><span>960 South ~ Low i~ FALSE    </span><span style='color: #BB0000;'>NA</span><span>   33.0    </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> Afghani~ AFG   1963-01-01  </span><span style='text-decoration: underline;'>1</span><span>962   </span><span style='text-decoration: underline;'>1</span><span>960 South ~ Low i~ FALSE    </span><span style='color: #BB0000;'>NA</span><span>   33.5    </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> Afghani~ AFG   1964-01-01  </span><span style='text-decoration: underline;'>1</span><span>963   </span><span style='text-decoration: underline;'>1</span><span>960 South ~ Low i~ FALSE    </span><span style='color: #BB0000;'>NA</span><span>   34.0    </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> Afghani~ AFG   1965-01-01  </span><span style='text-decoration: underline;'>1</span><span>964   </span><span style='text-decoration: underline;'>1</span><span>960 South ~ Low i~ FALSE    </span><span style='color: #BB0000;'>NA</span><span>   34.5    </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #BCBCBC;'>6</span><span> Afghani~ AFG   1966-01-01  </span><span style='text-decoration: underline;'>1</span><span>965   </span><span style='text-decoration: underline;'>1</span><span>960 South ~ Low i~ FALSE    </span><span style='color: #BB0000;'>NA</span><span>   34.9    </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #949494;'># ... with 2 more variables: ODA &lt;dbl&gt;, POP &lt;dbl&gt;</span><span>
#&gt; 
#&gt; Indexed by:  iso3c [1] | year [6 (61)] </div><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span>
<span class='va'>wldidt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='quick-conversion.html'>qDT</a></span><span class='op'>(</span><span class='va'>wlddev</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>iso3c</span>, <span class='va'>year</span><span class='op'>)</span>
<span class='va'>wldidt</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>1000</span><span class='op'>]</span>      <span class='co'># Works like a data.table...</span>
</div><div class='output co'>#&gt;           country iso3c       date year decade                    region
#&gt;    1: Afghanistan   AFG 1961-01-01 1960   1960                South Asia
#&gt;    2: Afghanistan   AFG 1962-01-01 1961   1960                South Asia
#&gt;    3: Afghanistan   AFG 1963-01-01 1962   1960                South Asia
#&gt;    4: Afghanistan   AFG 1964-01-01 1963   1960                South Asia
#&gt;    5: Afghanistan   AFG 1965-01-01 1964   1960                South Asia
#&gt;   ---                                                                   
#&gt;  996:    Barbados   BRB 1980-01-01 1979   1970 Latin America &amp; Caribbean
#&gt;            income  OECD    PCGDP LIFEEX GINI       ODA     POP
#&gt;    1:  Low income FALSE       NA 32.446   NA 116769997 8996973
#&gt;    2:  Low income FALSE       NA 32.962   NA 232080002 9169410
#&gt;    3:  Low income FALSE       NA 33.471   NA 112839996 9351441
#&gt;    4:  Low income FALSE       NA 33.971   NA 237720001 9543205
#&gt;    5:  Low income FALSE       NA 34.463   NA 295920013 9744781
#&gt;   ---                                                         
#&gt;  996: High income FALSE 13042.10 71.800   NA  17260000  251351
#&gt;  [ reached getOption("max.print") -- omitted 4 rows ]
#&gt; 
#&gt; Indexed by:  iso3c [17] | year [61] </div><div class='input'><span class='va'>wldidt</span><span class='op'>[</span><span class='va'>year</span> <span class='op'>&gt;</span> <span class='fl'>2000</span><span class='op'>]</span>
</div><div class='output co'>#&gt;           country iso3c       date year decade             region
#&gt;    1: Afghanistan   AFG 2002-01-01 2001   2000         South Asia
#&gt;    2: Afghanistan   AFG 2003-01-01 2002   2000         South Asia
#&gt;    3: Afghanistan   AFG 2004-01-01 2003   2000         South Asia
#&gt;    4: Afghanistan   AFG 2005-01-01 2004   2000         South Asia
#&gt;    5: Afghanistan   AFG 2006-01-01 2005   2000         South Asia
#&gt;   ---                                                            
#&gt; 4316:    Zimbabwe   ZWE 2017-01-01 2016   2010 Sub-Saharan Africa
#&gt;                    income  OECD     PCGDP LIFEEX GINI        ODA      POP
#&gt;    1:          Low income FALSE        NA 56.308   NA  682969971 21606988
#&gt;    2:          Low income FALSE  330.3036 56.784   NA 1790479980 22600770
#&gt;    3:          Low income FALSE  343.0809 57.271   NA 1972890015 23680871
#&gt;    4:          Low income FALSE  333.2167 57.772   NA 2681449951 24726684
#&gt;    5:          Low income FALSE  357.2347 58.290   NA 3306389893 25654277
#&gt;   ---                                                                    
#&gt; 4316: Lower middle income FALSE 1224.3099 60.294   NA  687659973 14030390
#&gt;  [ reached getOption("max.print") -- omitted 4 rows ]
#&gt; 
#&gt; Indexed by:  iso3c [216] | year [20 (61)] </div><div class='input'><span class='va'>wldidt</span><span class='op'>[</span>, <span class='fu'>.</span><span class='op'>(</span>sum_PCGDP <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='va'>country</span><span class='op'>]</span> <span class='co'># Aggregation unindexes the result</span>
</div><div class='output co'>#&gt;                    country   sum_PCGDP
#&gt;   1:           Afghanistan    8709.031
#&gt;   2:               Albania  112769.600
#&gt;   3:               Algeria  211936.285
#&gt;   4:        American Samoa  171208.120
#&gt;   5:               Andorra 2004154.553
#&gt;  ---                                  
#&gt; 212: Virgin Islands (U.S.)  570075.738
#&gt; 213:    West Bank and Gaza   62099.304
#&gt; 214:           Yemen, Rep.   32089.789
#&gt; 215:                Zambia   79131.760
#&gt; 216:              Zimbabwe   73166.158</div><div class='input'><span class='va'>wldidt</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>.SD</span>, <span class='va'>sum</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='va'>country</span>, .SDcols <span class='op'>=</span> <span class='fu'><a href='small-helpers.html'>.c</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, <span class='va'>LIFEEX</span><span class='op'>)</span><span class='op'>]</span>
</div><div class='output co'>#&gt;                    country       PCGDP   LIFEEX
#&gt;   1:           Afghanistan    8709.031 2951.830
#&gt;   2:               Albania  112769.600 4300.816
#&gt;   3:               Algeria  211936.285 3813.774
#&gt;   4:        American Samoa  171208.120    0.000
#&gt;   5:               Andorra 2004154.553    0.000
#&gt;  ---                                           
#&gt; 212: Virgin Islands (U.S.)  570075.738 4422.775
#&gt; 213:    West Bank and Gaza   62099.304 2148.234
#&gt; 214:           Yemen, Rep.   32089.789 3152.224
#&gt; 215:                Zambia   79131.760 3065.558
#&gt; 216:              Zimbabwe   73166.158 3272.016</div><div class='input'><span class='co'># This also works but is a bit inefficient since the index is subset and then dropped</span>
<span class='co'># -&gt; better unindex beforehand</span>
<span class='va'>wldidt</span><span class='op'>[</span><span class='va'>year</span> <span class='op'>&gt;</span> <span class='fl'>2000</span>, <span class='fu'>.</span><span class='op'>(</span>sum_PCGDP <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='va'>country</span><span class='op'>]</span>
</div><div class='output co'>#&gt;                    country  sum_PCGDP
#&gt;   1:           Afghanistan   8709.031
#&gt;   2:               Albania  73832.383
#&gt;   3:               Algeria  84017.769
#&gt;   4:        American Samoa 171208.120
#&gt;   5:               Andorra 827219.533
#&gt;  ---                                 
#&gt; 212: Virgin Islands (U.S.) 570075.738
#&gt; 213:    West Bank and Gaza  47661.621
#&gt; 214:           Yemen, Rep.  20313.628
#&gt; 215:                Zambia  26490.196
#&gt; 216:              Zimbabwe  21161.694</div><div class='input'><span class='va'>wldidt</span><span class='op'>[</span>, <span class='va'>PCGDP_gr_5Y</span> <span class='op'>:=</span> <span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>PCGDP</span>, <span class='fl'>5</span>, power <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span>  <span class='co'># Can add Variables by reference</span>
<span class='co'># Note that .SD is a data.table of indexed_series, not an indexed_frame, so this is WRONG!</span>
<span class='va'>wldidt</span><span class='op'>[</span>, <span class='fu'><a href='small-helpers.html'>.c</a></span><span class='op'>(</span><span class='va'>PCGDP_gr_5Y</span>, <span class='va'>LIFEEX_gr_5Y</span><span class='op'>)</span> <span class='op'>:=</span> <span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='fu'><a href='fselect-get_vars-add_vars.html'>slt</a></span><span class='op'>(</span><span class='va'>.SD</span>, <span class='va'>PCGDP</span>, <span class='va'>LIFEEX</span><span class='op'>)</span>, <span class='fl'>5</span>, power <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Found '.SD' in the call but no 'apply' function. Please note that .SD is not an indexed_frame but a plain data.table containing indexed_series. Thus indexed_frame / pdata.frame methods don't work on .SD! Consider using (m/l)apply(.SD, FUN) or reindex(.SD, ix(data)). If you are not performing indexed operations on .SD please ignore or suppress this warning.</span></div><div class='input'><span class='co'># This gives the correct outcome</span>
<span class='va'>wldidt</span><span class='op'>[</span>, <span class='fu'><a href='small-helpers.html'>.c</a></span><span class='op'>(</span><span class='va'>PCGDP_gr_5Y</span>, <span class='va'>LIFEEX_gr_5Y</span><span class='op'>)</span> <span class='op'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='fselect-get_vars-add_vars.html'>slt</a></span><span class='op'>(</span><span class='va'>.SD</span>, <span class='va'>PCGDP</span>, <span class='va'>LIFEEX</span><span class='op'>)</span>, <span class='va'>G</span>, <span class='fl'>5</span>, power <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1</span></div><div class='input'><span class='va'>nc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_read.html'>st_read</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shape/nc.shp"</span>, package <span class='op'>=</span> <span class='st'>"sf"</span><span class='op'>)</span>, quiet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>nci</span> <span class='op'>&lt;-</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>nc</span>, <span class='va'>SID74</span><span class='op'>)</span>
<span class='va'>nci</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='st'>"AREA"</span><span class='op'>]</span>
</div><div class='output co'>#&gt; Simple feature collection with 10 features and 1 field
#&gt; geometry type:  MULTIPOLYGON
#&gt; dimension:      XY
#&gt; bbox:           xmin: -81.74107 ymin: 36.07282 xmax: -75.77316 ymax: 36.58965
#&gt; geographic CRS: NAD27
#&gt;     AREA                       geometry
#&gt; 1  0.114 MULTIPOLYGON (((-81.47276 3...
#&gt; 2  0.061 MULTIPOLYGON (((-81.23989 3...
#&gt; 3  0.143 MULTIPOLYGON (((-80.45634 3...
#&gt; 4  0.070 MULTIPOLYGON (((-76.00897 3...
#&gt; 5  0.153 MULTIPOLYGON (((-77.21767 3...
#&gt; 6  0.097 MULTIPOLYGON (((-76.74506 3...
#&gt; 7  0.062 MULTIPOLYGON (((-76.00897 3...
#&gt; 8  0.091 MULTIPOLYGON (((-76.56251 3...
#&gt; 9  0.118 MULTIPOLYGON (((-78.30876 3...
#&gt; 10 0.124 MULTIPOLYGON (((-80.02567 3...
#&gt; 
#&gt; Indexed by:  SID74 [6] </div><div class='input'><span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_centroid</a></span><span class='op'>(</span><span class='va'>nci</span><span class='op'>)</span> <span class='co'># The geometry column is never indexed, thus sf computations work normally</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: st_centroid assumes attributes are constant over geometries of x</span></div><div class='output co'>#&gt; <span class='warning'>Warning: st_centroid does not give correct centroids for longitude/latitude data</span></div><div class='output co'>#&gt; Simple feature collection with 100 features and 14 fields
#&gt; geometry type:  POINT
#&gt; dimension:      XY
#&gt; bbox:           xmin: -84.05976 ymin: 34.07663 xmax: -75.80982 ymax: 36.49101
#&gt; geographic CRS: NAD27
#&gt; First 10 features:
#&gt;    AREA PERIMETER CNTY_ CNTY_ID        NAME  FIPS FIPSNO CRESS_ID BIR74 SID74
#&gt; 1 0.114     1.442  1825    1825        Ashe 37009  37009        5  1091     1
#&gt; 2 0.061     1.231  1827    1827   Alleghany 37005  37005        3   487     0
#&gt; 3 0.143     1.630  1828    1828       Surry 37171  37171       86  3188     5
#&gt; 4 0.070     2.968  1831    1831   Currituck 37053  37053       27   508     1
#&gt; 5 0.153     2.206  1832    1832 Northampton 37131  37131       66  1421     9
#&gt; 6 0.097     1.670  1833    1833    Hertford 37091  37091       46  1452     7
#&gt;   NWBIR74 BIR79 SID79 NWBIR79                   geometry
#&gt; 1      10  1364     0      19  POINT (-81.49826 36.4314)
#&gt; 2      10   542     3      12 POINT (-81.12515 36.49101)
#&gt; 3     208  3616     6     260 POINT (-80.68575 36.41252)
#&gt; 4     123   830     2     145  POINT (-76.0275 36.40728)
#&gt; 5    1066  1606     3    1197 POINT (-77.41056 36.42228)
#&gt; 6     954  1838     5    1237 POINT (-76.99478 36.36145)
#&gt;  [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
#&gt; 
#&gt; Indexed by:  SID74 [23] </div><div class='input'><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>nci</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                 X        Y L1 L2  L3
#&gt;    [1,] -81.47276 36.23436  1  1   1
#&gt;    [2,] -81.54084 36.27251  1  1   1
#&gt;    [3,] -81.56198 36.27359  1  1   1
#&gt;    [4,] -81.63306 36.34069  1  1   1
#&gt;    [5,] -81.74107 36.39178  1  1   1
#&gt;    [6,] -81.69828 36.47178  1  1   1
#&gt;    [7,] -81.70280 36.51934  1  1   1
#&gt;    [8,] -81.67000 36.58965  1  1   1
#&gt;    [9,] -81.34530 36.57286  1  1   1
#&gt;   [10,] -81.34754 36.53791  1  1   1
#&gt;   [11,] -81.32478 36.51368  1  1   1
#&gt;   [12,] -81.31332 36.48070  1  1   1
#&gt;   [13,] -81.26624 36.43721  1  1   1
#&gt;   [14,] -81.26284 36.40504  1  1   1
#&gt;   [15,] -81.24069 36.37942  1  1   1
#&gt;   [16,] -81.23989 36.36536  1  1   1
#&gt;   [17,] -81.26424 36.35241  1  1   1
#&gt;   [18,] -81.32899 36.36350  1  1   1
#&gt;   [19,] -81.36137 36.35316  1  1   1
#&gt;   [20,] -81.36569 36.33905  1  1   1
#&gt;  [ reached getOption("max.print") -- omitted 2509 rows ]</div><div class='input'><span class='fu'><a href='fmean.html'>fmean</a></span><span class='op'>(</span><span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_measures.html'>st_area</a></span><span class='op'>(</span><span class='va'>nci</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 1270317571 [m^2]</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tsibble.tidyverts.org'>tsibble</a></span><span class='op'>)</span>
<span class='va'>pedi</span> <span class='op'>&lt;-</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>pedestrian</span>, <span class='va'>Sensor</span>, <span class='va'>Date_Time</span><span class='op'>)</span>
<span class='va'>pedi</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='op'>]</span>
<span class='fu'>findex</span><span class='op'>(</span><span class='va'>pedi</span><span class='op'>)</span> <span class='co'># Time factor with 17k levels from POSIXct</span>
<span class='co'># Now here is a case where integer levels in the index can really speed things up</span>
<span class='fu'>ix</span><span class='op'>(</span><span class='fu'>iby</span><span class='op'>(</span><span class='va'>pedestrian</span>, <span class='va'>Sensor</span>, <span class='fu'><a href='timeid.html'>timeid</a></span><span class='op'>(</span><span class='va'>Date_Time</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/joshuaulrich/microbenchmark/'>microbenchmark</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html'>microbenchmark</a></span><span class='op'>(</span>descriptive_levels <span class='op'>=</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>pedestrian</span>, <span class='va'>Sensor</span>, <span class='va'>Date_Time</span><span class='op'>)</span>,
               integer_levels <span class='op'>=</span> <span class='fu'>findex_by</span><span class='op'>(</span><span class='va'>pedestrian</span>, <span class='va'>Sensor</span>, <span class='fu'><a href='timeid.html'>timeid</a></span><span class='op'>(</span><span class='va'>Date_Time</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Data has irregularity</span>
<span class='fu'>is_irregular</span><span class='op'>(</span><span class='va'>pedi</span><span class='op'>)</span>
<span class='fu'>is_irregular</span><span class='op'>(</span><span class='va'>pedi</span>, any_id <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='co'># irregularity in all sequences</span>
<span class='co'># Manipulation such as lagging with tsibble/dplyr requires expanding rows and grouping</span>
<span class='co'># Collapse can just compute correct lag on indexed series or frames</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html'>microbenchmark</a></span><span class='op'>(</span>
  dplyr <span class='op'>=</span> <span class='fu'><a href='https://tsibble.tidyverts.org/reference/fill_gaps.html'>fill_gaps</a></span><span class='op'>(</span><span class='va'>pedestrian</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://tsibble.tidyverts.org/reference/group_by_key.html'>group_by_key</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Lag_Count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/lead-lag.html'>lag</a></span><span class='op'>(</span><span class='va'>Count</span><span class='op'>)</span><span class='op'>)</span>,
  collapse <span class='op'>=</span> <span class='fu'><a href='ftransform.html'>fmutate</a></span><span class='op'>(</span><span class='va'>pedi</span>, Lag_Count <span class='op'>=</span> <span class='fu'><a href='flag.html'>flag</a></span><span class='op'>(</span><span class='va'>Count</span><span class='op'>)</span><span class='op'>)</span>, times <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Indexing Atomic objects ---------------------------------------------------------</span>

<span class='co'>## ts</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
#&gt; 1949 112 118 132 129 121 135 148 148 136 119 104 118
#&gt; 1950 115 126 141 135 125 149 170 170 158 133 114 140
#&gt; 1951 145 150 178 163 172 178 199 199 184 162 146 166
#&gt; 1952 171 180 193 181 183 218 230 242 209 191 172 194
#&gt; 1953 196 196 236 235 229 243 264 272 237 211 180 201
#&gt; 1954 204 188 235 227 234 264 302 293 259 229 203 229
#&gt; 1955 242 233 267 269 270 315 364 347 312 274 237 278
#&gt; 1956 284 277 317 313 318 374 413 405 355 306 271 306
#&gt;  [ reached getOption("max.print") -- omitted 4 rows ]</div><div class='input'><span class='va'>AirPassengers</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>]</span>        <span class='co'># Ts class does not support irregularity, subsetting drops class</span>
</div><div class='output co'>#&gt;   [1] 112 118 132 129 121 135 148 148 136 119 104 118 115 126 141 135 125 149
#&gt;  [19] 170 199 199 184 162 146 166 171 180 193 181 183 218 230 242 209 191 172
#&gt;  [37] 194 196 196 236 235 229 243 264 272 237 211 180 201 204 188 235 227 234
#&gt;  [55] 264 302 293 259 229 203 229 242 233 267 269 270 315 364 347 312 274 237
#&gt;  [73] 278 284 277 317 313 318 374 413 405 355 306 271 306 315 301 356 348 355
#&gt;  [91] 422 465 467 404 347 305 336 340 318 362
#&gt;  [ reached getOption("max.print") -- omitted 33 entries ]</div><div class='input'><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>12</span><span class='op'>)</span> <span class='co'># Annual Growth Rate: Wrong!</span>
</div><div class='output co'>#&gt;   [1]         NA         NA         NA         NA         NA         NA
#&gt;   [7]         NA         NA         NA         NA         NA         NA
#&gt;  [13]  2.6785714  6.7796610  6.8181818  4.6511628  3.3057851 10.3703704
#&gt;  [19] 14.8648649 34.4594595 46.3235294 54.6218487 55.7692308 23.7288136
#&gt;  [25] 44.3478261 35.7142857 27.6595745 42.9629630 44.8000000 22.8187919
#&gt;  [31] 28.2352941 15.5778894 21.6080402 13.5869565 17.9012346 17.8082192
#&gt;  [37] 16.8674699 14.6198830  8.8888889 22.2797927 29.8342541 25.1366120
#&gt;  [43] 11.4678899 14.7826087 12.3966942 13.3971292 10.4712042  4.6511628
#&gt;  [49]  3.6082474  4.0816327 -4.0816327 -0.4237288 -3.4042553  2.1834061
#&gt;  [55]  8.6419753 14.3939394  7.7205882  9.2827004  8.5308057 12.7777778
#&gt;  [61] 13.9303483 18.6274510 23.9361702 13.6170213 18.5022026 15.3846154
#&gt;  [67] 19.3181818 20.5298013 18.4300341 20.4633205 19.6506550 16.7487685
#&gt;  [73] 21.3973799 17.3553719 18.8841202 18.7265918 16.3568773 17.7777778
#&gt;  [79] 18.7301587 13.4615385 16.7146974 13.7820513 11.6788321 14.3459916
#&gt;  [85] 10.0719424 10.9154930  8.6642599 12.3028391 11.1821086 11.6352201
#&gt;  [91] 12.8342246 12.5907990 15.3086420 13.8028169 13.3986928 12.5461255
#&gt;  [97]  9.8039216  7.9365079  5.6478405  1.6853933
#&gt;  [ reached getOption("max.print") -- omitted 33 entries ]</div><div class='input'><span class='co'># Now indexing AirPassengers (identity() is a trick so that the index is named time(AirPassengers))</span>
<span class='va'>iAP</span> <span class='op'>&lt;-</span> <span class='fu'>reindex</span><span class='op'>(</span><span class='va'>AirPassengers</span>, <span class='fu'><a href='https://rdrr.io/r/base/identity.html'>identity</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/time.html'>time</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>iAP</span>
</div><div class='output co'>#&gt;      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
#&gt; 1949 112 118 132 129 121 135 148 148 136 119 104 118
#&gt; 1950 115 126 141 135 125 149 170 170 158 133 114 140
#&gt; 1951 145 150 178 163 172 178 199 199 184 162 146 166
#&gt; 1952 171 180 193 181 183 218 230 242 209 191 172 194
#&gt; 1953 196 196 236 235 229 243 264 272 237 211 180 201
#&gt; 1954 204 188 235 227 234 264 302 293 259 229 203 229
#&gt; 1955 242 233 267 269 270 315 364 347 312 274 237 278
#&gt; 1956 284 277 317 313 318 374 413 405 355 306 271 306
#&gt;  [ reached getOption("max.print") -- omitted 4 rows ]
#&gt; 
#&gt; Indexed by:  time(AirPassengers) [144] </div><div class='input'><span class='fu'>findex</span><span class='op'>(</span><span class='va'>iAP</span><span class='op'>)</span>    <span class='co'># See the index</span>
</div><div class='output co'>#&gt;   time(AirPassengers)
#&gt; 1                1949
#&gt; 2         1949.083333
#&gt; 3         1949.166666
#&gt; 4         1949.249999
#&gt; 5         1949.333332
#&gt; ---               
#&gt; 140 1960.583287
#&gt; 141  1960.66662
#&gt; 142 1960.749953
#&gt; 143 1960.833286
#&gt; 144 1960.916619
#&gt; 
#&gt; time(AirPassengers) [144]</div><div class='input'><span class='va'>iAP</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>]</span>  <span class='co'># Subsetting</span>
</div><div class='output co'>#&gt;   [1] 112 118 132 129 121 135 148 148 136 119 104 118 115 126 141 135 125 149
#&gt;  [19] 170 199 199 184 162 146 166 171 180 193 181 183 218 230 242 209 191 172
#&gt;  [37] 194 196 196 236 235 229 243 264 272 237 211 180 201 204 188 235 227 234
#&gt;  [55] 264 302 293 259 229 203 229 242 233 267 269 270 315 364 347 312 274 237
#&gt;  [73] 278 284 277 317 313 318 374 413 405 355 306 271 306 315 301 356 348 355
#&gt;  [91] 422 465 467 404 347 305 336 340 318 362
#&gt;  [ reached getOption("max.print") -- omitted 33 entries ]
#&gt; 
#&gt; Indexed by:  time(AirPassengers) [133 (144)] </div><div class='input'><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>iAP</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>12</span><span class='op'>)</span>                <span class='co'># Annual Growth Rate: Correct!</span>
</div><div class='output co'>#&gt;   [1]         NA         NA         NA         NA         NA         NA
#&gt;   [7]         NA         NA         NA         NA         NA         NA
#&gt;  [13]  2.6785714  6.7796610  6.8181818  4.6511628  3.3057851 10.3703704
#&gt;  [19] 14.8648649 17.0588235         NA         NA         NA         NA
#&gt;  [25]         NA         NA         NA         NA         NA         NA
#&gt;  [31]         NA 15.5778894 21.6080402 13.5869565 17.9012346 17.8082192
#&gt;  [37] 16.8674699 14.6198830  8.8888889 22.2797927 29.8342541 25.1366120
#&gt;  [43] 11.4678899 14.7826087 12.3966942 13.3971292 10.4712042  4.6511628
#&gt;  [49]  3.6082474  4.0816327 -4.0816327 -0.4237288 -3.4042553  2.1834061
#&gt;  [55]  8.6419753 14.3939394  7.7205882  9.2827004  8.5308057 12.7777778
#&gt;  [61] 13.9303483 18.6274510 23.9361702 13.6170213 18.5022026 15.3846154
#&gt;  [67] 19.3181818 20.5298013 18.4300341 20.4633205 19.6506550 16.7487685
#&gt;  [73] 21.3973799 17.3553719 18.8841202 18.7265918 16.3568773 17.7777778
#&gt;  [79] 18.7301587 13.4615385 16.7146974 13.7820513 11.6788321 14.3459916
#&gt;  [85] 10.0719424 10.9154930  8.6642599 12.3028391 11.1821086 11.6352201
#&gt;  [91] 12.8342246 12.5907990 15.3086420 13.8028169 13.3986928 12.5461255
#&gt;  [97]  9.8039216  7.9365079  5.6478405  1.6853933
#&gt;  [ reached getOption("max.print") -- omitted 33 entries ]
#&gt; 
#&gt; Indexed by:  time(AirPassengers) [133 (144)] </div><div class='input'><span class='fu'><a href='flag.html'>L</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='va'>iAP</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span> <span class='co'># Lagged level, period and annual growth rates...</span>
</div><div class='output co'>#&gt;         -- L1.--          G1       L1.G1      L12G1   L1.L12G1
#&gt;   [1,] 112    NA          NA          NA         NA         NA
#&gt;   [2,] 118   112   5.3571429          NA         NA         NA
#&gt;   [3,] 132   118  11.8644068   5.3571429         NA         NA
#&gt;   [4,] 129   132  -2.2727273  11.8644068         NA         NA
#&gt;   [5,] 121   129  -6.2015504  -2.2727273         NA         NA
#&gt;   [6,] 135   121  11.5702479  -6.2015504         NA         NA
#&gt;   [7,] 148   135   9.6296296  11.5702479         NA         NA
#&gt;   [8,] 148   148   0.0000000   9.6296296         NA         NA
#&gt;   [9,] 136   148  -8.1081081   0.0000000         NA         NA
#&gt;  [10,] 119   136 -12.5000000  -8.1081081         NA         NA
#&gt;  [11,] 104   119 -12.6050420 -12.5000000         NA         NA
#&gt;  [12,] 118   104  13.4615385 -12.6050420         NA         NA
#&gt;  [13,] 115   118  -2.5423729  13.4615385  2.6785714         NA
#&gt;  [14,] 126   115   9.5652174  -2.5423729  6.7796610  2.6785714
#&gt;  [15,] 141   126  11.9047619   9.5652174  6.8181818  6.7796610
#&gt;  [16,] 135   141  -4.2553191  11.9047619  4.6511628  6.8181818
#&gt;  [ reached getOption("max.print") -- omitted 117 rows ]
#&gt; attr(,"class")
#&gt; [1] "numeric" "matrix" 
#&gt; 
#&gt; Indexed by:  time(AirPassengers) [133 (144)] </div><div class='input'>
<span class='co'>## xts</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/joshuaulrich/xts'>xts</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Lade nötiges Paket: zoo</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attache Paket: ‘zoo’</span></div><div class='output co'>#&gt; <span class='message'>Die folgenden Objekte sind maskiert von ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    as.Date, as.Date.numeric</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attache Paket: ‘xts’</span></div><div class='output co'>#&gt; <span class='message'>Die folgenden Objekte sind maskiert von ‘package:data.table’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    first, last</span></div><div class='output co'>#&gt; <span class='message'>Die folgenden Objekte sind maskiert von ‘package:dplyr’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    first, last</span></div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://zoo.R-Forge.R-project.org/'>zoo</a></span><span class='op'>)</span> <span class='co'># Needed for as.yearmon() and index() functions</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='va'>wlddev</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fsubset.html'>fsubset</a></span><span class='op'>(</span><span class='va'>iso3c</span> <span class='op'>==</span> <span class='st'>"DEU"</span>, <span class='va'>date</span>, <span class='va'>PCGDP</span><span class='op'>:</span><span class='va'>POP</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/pkg/xts/man/xts.html'>xts</a></span><span class='op'>(</span><span class='fu'><a href='fselect-get_vars-add_vars.html'>num_vars</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span>, order.by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/yearmon.html'>as.yearmon</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>$</span><span class='va'>date</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fsubset.html'>ss</a></span><span class='op'>(</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>30</span><span class='op'>:</span><span class='fl'>40</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>reindex</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/identity.html'>identity</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Introducing a gap</span>
<span class='fu'><a href='https://r-spatial.github.io/sf/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='fgrowth.html'>G</a></span><span class='op'>(</span><span class='fu'>unindex</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='indexing-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='fu'>unindex</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>)</span>    <span class='co'># diff.xts gixes wrong result</span>
</div><div class='output co'>#&gt;                PCGDP       LIFEEX GINI ODA      POP
#&gt; Jan 1961          NA           NA   NA  NA       NA
#&gt; Jan 1962          NA  0.197975610   NA  NA   562732
#&gt; Jan 1963          NA  0.183536585   NA  NA   648152
#&gt; Jan 1964          NA  0.168073171   NA  NA   688569
#&gt; Jan 1965          NA  0.154097561   NA  NA   603984
#&gt; Jan 1966          NA  0.138121951   NA  NA   645358
#&gt; Jan 1967          NA  0.119585366   NA  NA   636616
#&gt; Jan 1968          NA  0.102585366   NA  NA   351025
#&gt; Jan 1969          NA  0.091097561   NA  NA   342978
#&gt; Jan 1970          NA  0.085585366   NA  NA   615368
#&gt; Jan 1971          NA  0.089097561   NA  NA   259607
#&gt; Jan 1972   579.34931  0.103097561   NA  NA   143553
#&gt; Jan 1973   770.40722  0.124121951   NA  NA   375610
#&gt; Jan 1974   935.46605  0.149682927   NA  NA   248214
#&gt; Jan 1975   186.88266  0.178731707   NA  NA    30767
#&gt; Jan 1976  -109.97720  0.206317073   NA  NA  -293879
#&gt; Jan 1977  1190.39313  0.232414634   NA  NA  -336604
#&gt; Jan 1978   832.10553  0.249536585   NA  NA  -177136
#&gt; Jan 1979   745.60684  0.259609756   NA  NA   -67994
#&gt; Jan 1980  1018.34851  0.265243902   NA  NA    34530
#&gt;  [ reached getOption("max.print") -- omitted 30 rows ]</div><div class='input'><span class='fu'><a href='fdiff.html'>fdiff</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>            <span class='co'># fdiff gives right result</span>
</div><div class='output co'>#&gt;                PCGDP       LIFEEX GINI ODA      POP
#&gt; Jan 1961          NA           NA   NA  NA       NA
#&gt; Jan 1962          NA  0.197975610   NA  NA   562732
#&gt; Jan 1963          NA  0.183536585   NA  NA   648152
#&gt; Jan 1964          NA  0.168073171   NA  NA   688569
#&gt; Jan 1965          NA  0.154097561   NA  NA   603984
#&gt; Jan 1966          NA  0.138121951   NA  NA   645358
#&gt; Jan 1967          NA  0.119585366   NA  NA   636616
#&gt; Jan 1968          NA  0.102585366   NA  NA   351025
#&gt; Jan 1969          NA  0.091097561   NA  NA   342978
#&gt; Jan 1970          NA  0.085585366   NA  NA   615368
#&gt; Jan 1971          NA  0.089097561   NA  NA   259607
#&gt; Jan 1972   579.34931  0.103097561   NA  NA   143553
#&gt; Jan 1973   770.40722  0.124121951   NA  NA   375610
#&gt; Jan 1974   935.46605  0.149682927   NA  NA   248214
#&gt; Jan 1975   186.88266  0.178731707   NA  NA    30767
#&gt; Jan 1976  -109.97720  0.206317073   NA  NA  -293879
#&gt; Jan 1977  1190.39313  0.232414634   NA  NA  -336604
#&gt; Jan 1978   832.10553  0.249536585   NA  NA  -177136
#&gt; Jan 1979   745.60684  0.259609756   NA  NA   -67994
#&gt; Jan 1980  1018.34851  0.265243902   NA  NA    34530
#&gt;  [ reached getOption("max.print") -- omitted 30 rows ]
#&gt; 
#&gt; Indexed by:  index(.) [50 (61)] </div><div class='input'>
<span class='co'># But xts range-based subsets do not work...</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>X</span><span class='op'>[</span><span class='st'>"1980/"</span><span class='op'>]</span>
<span class='op'>}</span>
<span class='co'># Thus a better way is not to index and perform ad-hoc omputations on the xts index</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'>unindex</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>
<span class='va'>X</span><span class='op'>[</span><span class='st'>"1980/"</span><span class='op'>]</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='fdiff.html'>fdiff</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># xts index is internally processed by timeid()</span>
</div><div class='output co'>#&gt;                PCGDP       LIFEEX GINI ODA      POP
#&gt; Jan 1980          NA           NA   NA  NA       NA
#&gt; Jan 1981   309.62150  0.269365854   NA  NA   162226
#&gt; Jan 1982    98.34802  0.272487805   NA  NA   119331
#&gt; Jan 1983   -78.72879  0.276609756   NA  NA   -74541
#&gt; Jan 1984   481.07564  0.278195122   NA  NA  -205084
#&gt; Jan 1985   846.88924  0.277731707   NA  NA  -269597
#&gt; Jan 1986   702.81344  0.271707317   NA  NA  -173812
#&gt; Jan 1987   631.60512  0.259097561   NA  NA    35563
#&gt; Jan 1988   359.26028  0.245951220   NA  NA   119484
#&gt; Jan 1989   963.80172  0.232804878   NA  NA   304699
#&gt; Jan 2001          NA           NA   NA  NA       NA
#&gt; Jan 2002   573.02200  0.402439024  1.5  NA   138417
#&gt; Jan 2003  -140.79423 -0.100000000 -0.4  NA   138570
#&gt; Jan 2004  -289.69804  0.151219512  0.1  NA    45681
#&gt; Jan 2005   455.80255  0.300000000  0.4  NA   -17916
#&gt; Jan 2006   303.99173  0.251219512  1.7  NA   -46838
#&gt; Jan 2007  1527.68742  0.200000000 -0.8  NA   -92971
#&gt; Jan 2008  1257.04863  0.402439024  0.0  NA  -110079
#&gt; Jan 2009   479.49220  0.202439024 -0.2  NA  -156275
#&gt; Jan 2010 -2296.43175  0.100000000 -0.6  NA  -207790
#&gt;  [ reached getOption("max.print") -- omitted 11 rows ]</div><div class='input'>
<span class='co'>## Of course you can also index plain vectors / matrices...</span>

<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span><span class='va'>opts</span><span class='op'>)</span>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


