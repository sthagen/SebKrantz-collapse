<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon">
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Advanced Data Aggregation — collap • collapse</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Advanced Data Aggregation — collap" />
<meta property="og:description" content="collap is a fast and easy to use multi-purpose data aggregation command.
It performs simple aggregations, multi-type data aggregations applying different functions to numeric and categorical data, weighted aggregations (including weighted multi-type aggregations), multi-function aggregations applying multiple functions to each column, and fully customized aggregations where the user passes a list mapping functions to columns.
collap works with collapse's Fast Statistical Functions, providing extremely fast conventional and weighted aggregation. It also works with other functions but this does not deliver high speeds on large data and does not support weighted aggregations.
" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" target="_blank">Blog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/collapse_R" target="_blank">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" target="_blank">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Advanced Data Aggregation</h1>
    
    <div class="hidden name"><code>collap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>collap</code> is a fast and easy to use multi-purpose data aggregation command.</p>
<p>It performs simple aggregations, multi-type data aggregations applying different functions to numeric and categorical data, weighted aggregations (including weighted multi-type aggregations), multi-function aggregations applying multiple functions to each column, and fully customized aggregations where the user passes a list mapping functions to columns.</p>
<p><code>collap</code> works with <em>collapse</em>'s <a href='A1-fast-statistical-functions.html'>Fast Statistical Functions</a>, providing extremely fast conventional and weighted aggregation. It also works with other functions but this does not deliver high speeds on large data and does not support weighted aggregations.</p>
<p><!-- % \code{collap} supports formula and data (i.e. grouping vectors or lists of vectors) input to \code{by}, whereas \code{collapv} allows names and indices of grouping columns to be passed to \code{by}. --></p>
    </div>

    <pre class="usage"><span class='co'># Main function: allows formula and data input to `by` and `w` arguments</span>
<span class='fu'>collap</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>by</span>, FUN <span class='op'>=</span> <span class='va'>fmean</span>, catFUN <span class='op'>=</span> <span class='va'>fmode</span>, cols <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, wFUN <span class='op'>=</span> <span class='va'>fsum</span>,
       custom <span class='op'>=</span> <span class='cn'>NULL</span>, keep.by <span class='op'>=</span> <span class='cn'>TRUE</span>, keep.w <span class='op'>=</span> <span class='cn'>TRUE</span>, keep.col.order <span class='op'>=</span> <span class='cn'>TRUE</span>,
       sort <span class='op'>=</span> <span class='cn'>TRUE</span>, decreasing <span class='op'>=</span> <span class='cn'>FALSE</span>, na.last <span class='op'>=</span> <span class='cn'>TRUE</span>, parallel <span class='op'>=</span> <span class='cn'>FALSE</span>, mc.cores <span class='op'>=</span> <span class='fl'>2L</span>,
       return <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wide"</span>,<span class='st'>"list"</span>,<span class='st'>"long"</span>,<span class='st'>"long_dupl"</span><span class='op'>)</span>, give.names <span class='op'>=</span> <span class='st'>"auto"</span>, <span class='va'>sort.row</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># Programmer function: allows column names and indices input to `by` and `w` arguments</span>
<span class='fu'>collapv</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>by</span>, FUN <span class='op'>=</span> <span class='va'>fmean</span>, catFUN <span class='op'>=</span> <span class='va'>fmode</span>, cols <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, wFUN <span class='op'>=</span> <span class='va'>fsum</span>,
        custom <span class='op'>=</span> <span class='cn'>NULL</span>, keep.by <span class='op'>=</span> <span class='cn'>TRUE</span>, keep.w <span class='op'>=</span> <span class='cn'>TRUE</span>, keep.col.order <span class='op'>=</span> <span class='cn'>TRUE</span>,
        sort <span class='op'>=</span> <span class='cn'>TRUE</span>, decreasing <span class='op'>=</span> <span class='cn'>FALSE</span>, na.last <span class='op'>=</span> <span class='cn'>TRUE</span>, parallel <span class='op'>=</span> <span class='cn'>FALSE</span>, mc.cores <span class='op'>=</span> <span class='fl'>2L</span>,
        return <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wide"</span>,<span class='st'>"list"</span>,<span class='st'>"long"</span>,<span class='st'>"long_dupl"</span><span class='op'>)</span>, give.names <span class='op'>=</span> <span class='st'>"auto"</span>, <span class='va'>sort.row</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># Auxiliary function: for grouped data ('grouped_df') input + non-standard evaluation</span>
<span class='fu'>collapg</span><span class='op'>(</span><span class='va'>X</span>, FUN <span class='op'>=</span> <span class='va'>fmean</span>, catFUN <span class='op'>=</span> <span class='va'>fmode</span>, cols <span class='op'>=</span> <span class='cn'>NULL</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, wFUN <span class='op'>=</span> <span class='va'>fsum</span>, custom <span class='op'>=</span> <span class='cn'>NULL</span>,
        keep.group_vars <span class='op'>=</span> <span class='cn'>TRUE</span>, keep.w <span class='op'>=</span> <span class='cn'>TRUE</span>, keep.col.order <span class='op'>=</span> <span class='cn'>TRUE</span>,
        parallel <span class='op'>=</span> <span class='cn'>FALSE</span>, mc.cores <span class='op'>=</span> <span class='fl'>2L</span>,
        return <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wide"</span>,<span class='st'>"list"</span>,<span class='st'>"long"</span>,<span class='st'>"long_dupl"</span><span class='op'>)</span>, give.names <span class='op'>=</span> <span class='st'>"auto"</span>, <span class='va'>sort.row</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>a data frame, or an object coercible to data frame using <code><a href='A4-quick-conversion.html'>qDF</a></code>.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p>for <code>collap</code>: a one-or two sided formula, i.e. <code>~ group1</code> or <code>var1 + var2 ~ group1 + group2</code>, or a atomic vector, list of vectors or <code><a href='GRP, fgroup_by.html'>GRP</a></code> object used to group <code>X</code>. For <code>collapv</code>: names or indices of grouping columns, or a logical vector or selector function such as <code><a href='AA2-small-helpers.html'>is.categorical</a></code> selecting grouping columns.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>a function, list of functions (i.e. <code><a href='https://rdrr.io/r/base/list.html'>list(fsum, fmean, fsd)</a></code> or <code><a href='https://rdrr.io/r/base/list.html'>list(myfun1 = function(x).., sd = sd)</a></code>), or a character vector of function names, which are automatically applied only to numeric variables.</p></td>
    </tr>
    <tr>
      <th>catFUN</th>
      <td><p>same as <code>FUN</code>, but applied only to categorical (non-numeric) typed columns (<code><a href='AA2-small-helpers.html'>is.categorical</a></code>).</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>select columns to aggregate using a function, column names, indices or logical vector. <em>Note</em>: <code>cols</code> is ignored if a two-sided formula is passed to <code>by</code>.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>weights. Can be passed as numeric vector or alternatively as formula i.e. <code>~ weightvar</code> in <code>collap</code> or column name / index etc. i.e. <code>"weightvar"</code> in <code>collapv</code>. <code>collapg</code> supports non-standard evaluations so <code>weightvar</code> can be indicated without quotes if found in <code>X</code>.</p></td>
    </tr>
    <tr>
      <th>wFUN</th>
      <td><p>same as <code>FUN</code>: Function(s) to aggregate weight variable if <code>keep.w = TRUE</code>. By default the sum of the weights is computed in each group.</p></td>
    </tr>
    <tr>
      <th>custom</th>
      <td><p>a named list specifying a fully customized aggregation task. The names of the list are function names and the content columns to aggregate using this function (same input as <code>cols</code>). For example <code>custom = list(fmean = 1:6, fsd = 7:9, fmode = 10:11)</code> tells <code>collap</code> to aggregate columns 1-6 of <code>X</code> using the mean, columns 7-9 using the standard deviation etc. <em>Note</em>: <code>custom</code> lets <code>collap</code> ignore any inputs passed to <code>FUN</code>, <code>catFUN</code> or <code>cols</code>.</p></td>
    </tr>
    <tr>
      <th>keep.by, keep.group_vars</th>
      <td><p>logical. <code>FALSE</code> will omit grouping variables from the output. <code>TRUE</code> keeps the variables, even if passed externally in a list or vector (unlike other <em>collapse</em> functions).</p></td>
    </tr>
    <tr>
      <th>keep.w</th>
      <td><p>logical. <code>FALSE</code> will omit weight variable from the output i.e. no aggregation of the weights. <code>TRUE</code> aggregates and adds weights, even if passed externally as a vector (unlike other <em>collapse</em> functions).</p></td>
    </tr>
    <tr>
      <th>keep.col.order</th>
      <td><p>logical. Retain original column order post-aggregation.</p></td>
    </tr>
    <tr>
      <th>sort, decreasing, na.last</th>
      <td><p>logical. Arguments passed to <code><a href='GRP, fgroup_by.html'>GRP.default</a></code> and affecting the row-order in the aggregated data frame.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>logical. Use <code>mclapply</code> instead of <code>lapply</code> to parallelize the computation at the column level. Not available for Windows.</p></td>
    </tr>
    <tr>
      <th>mc.cores</th>
      <td><p>integer. Argument to <code>mclapply</code> setting the number of cores to use, default is 2.</p></td>
    </tr>
    <tr>
      <th>return</th>
      <td><p>character. Control the output format when aggregating with multiple functions or performing custom aggregation. "wide" (default) returns a wider data frame with added columns for each additional function. "list" returns a list of data frames - one for each function. "long" adds a column "Function" and row-binds the results from different functions using <code><a href='https://rdrr.io/pkg/data.table/man/rbindlist.html'>data.table::rbindlist</a></code>. "long.dupl" is a special option for aggregating multi-type data using multiple <code>FUN</code> but only one <code>catFUN</code> or vice-versa. In that case the format is long and data aggregated using only one function is duplicated. See Examples.</p></td>
    </tr>
    <tr>
      <th>give.names</th>
      <td><p>logical. Create unique names of aggregated columns by adding a prefix 'FUN.var'. <code>'auto'</code> will automatically create such prefixes whenever multiple functions are applied to a column. <!-- % By default \code{"."} is used as a separator between 'FUN' and 'var'. It is also possible to choose a different separator by specifying \code{give.names = "_"}, for example. --></p></td>
    </tr>
    <tr>
      <th>sort.row</th>
      <td><p>depreciated, renamed to <code>sort</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to all functions supplied to <code>FUN</code>, <code>catFUN</code>, <code>wFUN</code> or <code>custom</code>. The behavior of <a href='A1-fast-statistical-functions.html'>Fast Statistical Functions</a> is regulated by <code><a href='https://rdrr.io/r/base/options.html'>option("collapse_unused_arg_action")</a></code> and defaults to <code>"warning"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>collap</code> automatically checks each function passed to it whether it is a <a href='A1-fast-statistical-functions.html'>Fast Statistical Function</a> (i.e. whether the function name is contained in <code>.FAST_STAT_FUN</code>). If the function is a fast statistical function, <code>collap</code> only does the grouping and then calls the function to carry out the grouped computations. If the function is not one of <code>.FAST_STAT_FUN</code>, <code><a href='BY.html'>BY</a></code> is called internally to perform the computation. The resulting computations from each function are put into a list and recombined to produce the desired output format as controlled by the <code>return</code> argument.</p>
<p>When setting <code>parallel = TRUE</code> on a non-windows computer, aggregations will efficiently be parallelized at the column level using <code>mclapply</code> utilizing <code>mc.cores</code> cores.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>X</code> aggregated. If <code>X</code> is not a data frame it is coerced to one using <code><a href='A4-quick-conversion.html'>qDF</a></code> and then aggregated.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>(1) Since <code><a href='BY.html'>BY</a></code> does not check and split additional arguments passed to it, it is presently not possible to create a weighted function in R and apply it to data by groups with <code>collap</code>. Weighted aggregations only work with <a href='A1-fast-statistical-functions.html'>Fast Statistical Functions</a> supporting weights. User written weighted functions can be applied using the <em>data.table</em> package.</p>
<p>(2) When the <code>w</code> argument is used, the weights are passed to all <a href='A1-fast-statistical-functions.html'>Fast Statistical Functions</a>. This may be undesirable in settings like <code>collapse::collap(data, ~ id, custom = list(fsum = ..., fmean = ...), w = ~ weights)</code> where some columns are to be aggregated using the weighted mean, and others using a simple sum or another unweighted statistic. Since many <a href='A1-fast-statistical-functions.html'>Fast Statistical Functions</a> including <code><a href='fsum.html'>fsum</a></code> support weights, the above computes a weighted mean and a weighted sum. A couple of workarounds were outlined <a href='https://github.com/SebKrantz/collapse/issues/96'>here</a>, but <em>collapse</em> 1.5.0 incorporates an easy solution into <code>collap</code>: It is now possible to simply append <a href='A1-fast-statistical-functions.html'>Fast Statistical Functions</a> by <code>_uw</code> to yield an unweighted computation. So for the above example we can write: <code>collapse::collap(data, ~ id, custom = list(fsum_uw = ..., fmean = ...), w = ~ weights)</code> to get the weighted mean and the simple sum. <em>Note</em> that the <code>_uw</code> functions are not available for use outside collap. Thus one also needs to quote them when passed to the <code>FUN</code> or <code>catFUN</code> arguments, e.g. use <code>collap(data, ~ id, fmean, "fmode_uw", w = ~ weighs)</code>, since <code>collap(data, ~ id, fmean, fmode_uw, w = ~ weighs)</code> gives an error stating that <code>fmode_uw</code> was not found. <em>Note</em> also that it is never necessary for functions passed to <code>wFUN</code> to be appended like this, as the weights are never used to aggregate themselves.</p>
<p>(3) The dispatch between using optimized <a href='A1-fast-statistical-functions.html'>Fast Statistical Functions</a> performing grouped computations internally or calling <code>BY</code> to perform split-apply-combine computing is done by matching the function name against <code>.FAST_STAT_FUN</code>. Thus code like <code>collapse::collap(data, ~ id, collapse::fmedian)</code> does not yield an optimized computation, as <code>"collapse::fmedian" %!in% .FAST_STAT_FUN</code>. It is sufficient to write <code>collapse::collap(data, ~ id, "fmedian")</code> to get the desired result when the <em>collapse</em> namespace is not attached.</p>
<p><!-- %If you want to perform optimized computations with \code{collap} without loading the pacckage, load the functions beforehand as well, e.g. \code{fmedian &lt;- collapse::fmedian; data, ~ id, fmedian)}. Alternatively it is of course also possible to use \code{collapse::fmedian(collapse::fgroup_by(data, id))}, or something similar... --></p>
<p><!-- % \code{collap} by default (\code{keep.by = TRUE, keep.w = TRUE}) preserves all arguments passed to the \code{by} or \code{w} arguments, whether passed in a formula or externally. The names of externally passed vectors and lists are intelligently extracted. So it is possible to write \code{collap(iris, iris$Species)}, and obtain an aggregated data frame with two \code{Species} columns, whereas \code{collap(iris, ~ Species)} only has one \code{Species} column. Similarly for weight vectors passed to \code{w}. In this regard \code{collap} is more sophisticated than other \emph{collapse} functions where preservation of grouping and weight variables is restricted to formula use. For example \code{STD(iris, iris$Species)} does not preserve \code{Species} in the output, whereas \code{STD(iris, ~ Species)} does. This \code{collap} feature is there simply for convenience, for example sometimes a survey is disaggregated into several datasets, and this now allows easy pulling of identifiers or weights from other datasets for aggregations. If all information is available in one dataset, just using formulas is highly recommended. --></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='BY.html'>BY</a></code>, <a href='A1-fast-statistical-functions.html'>Fast Statistical Functions</a>, <a href='index.html'>Collapse Overview</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## A Simple Introduction --------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
#&gt; 1          5.1         3.5          1.4         0.2  setosa
#&gt; 2          4.9         3.0          1.4         0.2  setosa
#&gt; 3          4.7         3.2          1.3         0.2  setosa
#&gt; 4          4.6         3.1          1.5         0.2  setosa
#&gt; 5          5.0         3.6          1.4         0.2  setosa
#&gt; 6          5.4         3.9          1.7         0.4  setosa</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='op'>~</span> <span class='va'>Species</span><span class='op'>)</span>                                        <span class='co'># Default: FUN = fmean for numeric</span>
</div><div class='output co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1        5.006       3.428        1.462       0.246     setosa
#&gt; 2        5.936       2.770        4.260       1.326 versicolor
#&gt; 3        6.588       2.974        5.552       2.026  virginica</div><div class='input'><span class='fu'>collapv</span><span class='op'>(</span><span class='va'>iris</span>, <span class='fl'>5</span><span class='op'>)</span>                                               <span class='co'># Same using collapv</span>
</div><div class='output co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1        5.006       3.428        1.462       0.246     setosa
#&gt; 2        5.936       2.770        4.260       1.326 versicolor
#&gt; 3        6.588       2.974        5.552       2.026  virginica</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='op'>~</span> <span class='va'>Species</span>, <span class='va'>fmedian</span><span class='op'>)</span>                               <span class='co'># Using the median</span>
</div><div class='output co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1          5.0         3.4         1.50         0.2     setosa
#&gt; 2          5.9         2.8         4.35         1.3 versicolor
#&gt; 3          6.5         3.0         5.55         2.0  virginica</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='op'>~</span> <span class='va'>Species</span>, <span class='va'>fmedian</span>, keep.col.order <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>       <span class='co'># Groups in-front</span>
</div><div class='output co'>#&gt;      Species Sepal.Length Sepal.Width Petal.Length Petal.Width
#&gt; 1     setosa          5.0         3.4         1.50         0.2
#&gt; 2 versicolor          5.9         2.8         4.35         1.3
#&gt; 3  virginica          6.5         3.0         5.55         2.0</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='va'>Sepal.Width</span> <span class='op'>+</span> <span class='va'>Petal.Width</span> <span class='op'>~</span> <span class='va'>Species</span>, <span class='va'>fmedian</span><span class='op'>)</span>     <span class='co'># Only '.Width' columns</span>
</div><div class='output co'>#&gt;   Sepal.Width Petal.Width    Species
#&gt; 1         3.4         0.2     setosa
#&gt; 2         2.8         1.3 versicolor
#&gt; 3         3.0         2.0  virginica</div><div class='input'><span class='fu'>collapv</span><span class='op'>(</span><span class='va'>iris</span>, <span class='fl'>5</span>, cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>                               <span class='co'># Same using collapv</span>
</div><div class='output co'>#&gt;   Sepal.Width Petal.Width    Species
#&gt; 1       3.428       0.246     setosa
#&gt; 2       2.770       1.326 versicolor
#&gt; 3       2.974       2.026  virginica</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='op'>~</span> <span class='va'>Species</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fmean</span>, <span class='va'>fmedian</span><span class='op'>)</span><span class='op'>)</span>                  <span class='co'># Two functions</span>
</div><div class='output co'>#&gt;   fmean.Sepal.Length fmedian.Sepal.Length fmean.Sepal.Width fmedian.Sepal.Width
#&gt; 1              5.006                  5.0             3.428                 3.4
#&gt; 2              5.936                  5.9             2.770                 2.8
#&gt; 3              6.588                  6.5             2.974                 3.0
#&gt;   fmean.Petal.Length fmedian.Petal.Length fmean.Petal.Width fmedian.Petal.Width
#&gt; 1              1.462                 1.50             0.246                 0.2
#&gt; 2              4.260                 4.35             1.326                 1.3
#&gt; 3              5.552                 5.55             2.026                 2.0
#&gt;      Species
#&gt; 1     setosa
#&gt; 2 versicolor
#&gt; 3  virginica</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='op'>~</span> <span class='va'>Species</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fmean</span>, <span class='va'>fmedian</span><span class='op'>)</span>, return <span class='op'>=</span> <span class='st'>"long"</span><span class='op'>)</span> <span class='co'># Long format</span>
</div><div class='output co'>#&gt;   Function Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1    fmean        5.006       3.428        1.462       0.246     setosa
#&gt; 2    fmean        5.936       2.770        4.260       1.326 versicolor
#&gt; 3    fmean        6.588       2.974        5.552       2.026  virginica
#&gt; 4  fmedian        5.000       3.400        1.500       0.200     setosa
#&gt; 5  fmedian        5.900       2.800        4.350       1.300 versicolor
#&gt; 6  fmedian        6.500       3.000        5.550       2.000  virginica</div><div class='input'><span class='fu'>collapv</span><span class='op'>(</span><span class='va'>iris</span>, <span class='fl'>5</span>, custom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fmean <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, fmedian <span class='op'>=</span> <span class='fl'>3</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>    <span class='co'># Custom aggregation</span>
</div><div class='output co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1        5.006       3.428         1.50         0.2     setosa
#&gt; 2        5.936       2.770         4.35         1.3 versicolor
#&gt; 3        6.588       2.974         5.55         2.0  virginica</div><div class='input'><span class='fu'>collapv</span><span class='op'>(</span><span class='va'>iris</span>, <span class='fl'>5</span>, custom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fmean <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, fmedian <span class='op'>=</span> <span class='fl'>3</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span>,    <span class='co'># Raw output, no column reordering</span>
        return <span class='op'>=</span> <span class='st'>"list"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt;      Species Sepal.Length Sepal.Width
#&gt; 1     setosa        5.006       3.428
#&gt; 2 versicolor        5.936       2.770
#&gt; 3  virginica        6.588       2.974
#&gt; 
#&gt; [[2]]
#&gt;      Species Petal.Length Petal.Width
#&gt; 1     setosa         1.50         0.2
#&gt; 2 versicolor         4.35         1.3
#&gt; 3  virginica         5.55         2.0
#&gt; </div><div class='input'><span class='fu'>collapv</span><span class='op'>(</span><span class='va'>iris</span>, <span class='fl'>5</span>, custom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fmean <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, fmedian <span class='op'>=</span> <span class='fl'>3</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span>,    <span class='co'># A strange choice..</span>
        return <span class='op'>=</span> <span class='st'>"long"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Function Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1        1        5.006       3.428           NA          NA     setosa
#&gt; 2        1        5.936       2.770           NA          NA versicolor
#&gt; 3        1        6.588       2.974           NA          NA  virginica
#&gt; 4        2           NA          NA         1.50         0.2     setosa
#&gt; 5        2           NA          NA         4.35         1.3 versicolor
#&gt; 6        2           NA          NA         5.55         2.0  virginica</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='op'>~</span> <span class='va'>Species</span>, w <span class='op'>=</span> <span class='op'>~</span> <span class='va'>Sepal.Length</span><span class='op'>)</span>                    <span class='co'># Using Sepal.Length as weights, ..</span>
</div><div class='output co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1        250.3    3.447423     1.465202   0.2480224     setosa
#&gt; 2        296.8    2.784063     4.290195   1.3352089 versicolor
#&gt; 3        329.4    2.987948     5.597116   2.0333030  virginica</div><div class='input'><span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='AA2-small-helpers.html'>fnrow</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='op'>~</span> <span class='va'>Species</span>, w <span class='op'>=</span> <span class='va'>weights</span><span class='op'>)</span>                           <span class='co'># Some random weights..</span>
</div><div class='output co'>#&gt;    weights Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1 39.05823     4.938751    3.360079     1.439973   0.2210811     setosa
#&gt; 2 39.11259     5.918390    2.769699     4.236550   1.3255695 versicolor
#&gt; 3 39.60369     6.590353    3.012308     5.572586   2.0047445  virginica</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='va'>iris</span><span class='op'>$</span><span class='va'>Species</span>, w <span class='op'>=</span> <span class='va'>weights</span><span class='op'>)</span>                        <span class='co'># Note this behavior..</span>
</div><div class='output co'>#&gt;      Species  weights Sepal.Length Sepal.Width Petal.Length Petal.Width
#&gt; 1     setosa 39.05823     4.938751    3.360079     1.439973   0.2210811
#&gt; 2 versicolor 39.11259     5.918390    2.769699     4.236550   1.3255695
#&gt; 3  virginica 39.60369     6.590353    3.012308     5.572586   2.0047445
#&gt;      Species
#&gt; 1     setosa
#&gt; 2 versicolor
#&gt; 3  virginica</div><div class='input'><span class='fu'>collap</span><span class='op'>(</span><span class='va'>iris</span>, <span class='va'>iris</span><span class='op'>$</span><span class='va'>Species</span>, w <span class='op'>=</span> <span class='va'>weights</span>,
       keep.by <span class='op'>=</span> <span class='cn'>FALSE</span>, keep.w <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1     4.938751    3.360079     1.439973   0.2210811     setosa
#&gt; 2     5.918390    2.769699     4.236550   1.3255695 versicolor
#&gt; 3     6.590353    3.012308     5.572586   2.0047445  virginica</div><div class='input'> 
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span> <span class='co'># Needed for "%&gt;%"</span>
<span class='va'>iris</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>Species</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>collapg</span>                        <span class='co'># dplyr style, but faster</span>
</div><div class='output co'>#&gt;      Species Sepal.Length Sepal.Width Petal.Length Petal.Width
#&gt; 1     setosa        5.006       3.428        1.462       0.246
#&gt; 2 versicolor        5.936       2.770        4.260       1.326
#&gt; 3  virginica        6.588       2.974        5.552       2.026</div><div class='input'>
<span class='co'>## Multi-Type Aggregation --------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>wlddev</span><span class='op'>)</span>                                                    <span class='co'># World Development Panel Data</span>
</div><div class='output co'>#&gt;       country iso3c       date year decade     region     income  OECD PCGDP
#&gt; 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA
#&gt; 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA
#&gt; 3 Afghanistan   AFG 1963-01-01 1962   1960 South Asia Low income FALSE    NA
#&gt; 4 Afghanistan   AFG 1964-01-01 1963   1960 South Asia Low income FALSE    NA
#&gt; 5 Afghanistan   AFG 1965-01-01 1964   1960 South Asia Low income FALSE    NA
#&gt; 6 Afghanistan   AFG 1966-01-01 1965   1960 South Asia Low income FALSE    NA
#&gt;   LIFEEX GINI       ODA
#&gt; 1 32.292   NA 114440000
#&gt; 2 32.742   NA 233350000
#&gt; 3 33.185   NA 114880000
#&gt; 4 33.624   NA 236450000
#&gt; 5 34.060   NA 302480000
#&gt; 6 34.495   NA 370250000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span><span class='op'>)</span><span class='op'>)</span>                        <span class='co'># Aggregate by country and decade</span>
</div><div class='output co'>#&gt;       country iso3c       date   year decade     region     income  OECD
#&gt; 1 Afghanistan   AFG 1961-01-01 1962.5   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan   AFG 1967-01-01 1970.0   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan   AFG 1976-01-01 1980.0   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan   AFG 1987-01-01 1990.0   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan   AFG 1996-01-01 2000.0   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan   AFG 2007-01-01 2010.0   2010 South Asia Low income FALSE
#&gt;      PCGDP   LIFEEX GINI        ODA
#&gt; 1       NA 33.39967   NA  228641667
#&gt; 2       NA 36.70089   NA  224881111
#&gt; 3       NA 42.03909   NA  132813636
#&gt; 4       NA 49.69089   NA  249072222
#&gt; 5 349.7596 55.61818   NA 1045170000
#&gt; 6 506.9931 61.12978   NA 5298066667</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, <span class='va'>fmedian</span>, <span class='va'>ffirst</span><span class='op'>)</span><span class='op'>)</span>       <span class='co'># Different functions</span>
</div><div class='output co'>#&gt;       country iso3c       date   year decade     region     income  OECD
#&gt; 1 Afghanistan   AFG 1961-01-01 1962.5   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan   AFG 1967-01-01 1970.0   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan   AFG 1976-01-01 1980.0   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan   AFG 1987-01-01 1990.0   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan   AFG 1996-01-01 2000.0   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan   AFG 2007-01-01 2010.0   2010 South Asia Low income FALSE
#&gt;      PCGDP  LIFEEX GINI        ODA
#&gt; 1       NA 33.4045   NA  234900000
#&gt; 2       NA 36.6780   NA  229150000
#&gt; 3       NA 41.8530   NA   72610000
#&gt; 4       NA 49.8560   NA  238500000
#&gt; 5 346.9282 55.4820   NA  306200000
#&gt; 6 536.0125 61.2260   NA 5033950000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, cols <span class='op'>=</span> <span class='va'>is.numeric</span><span class='op'>)</span><span class='op'>)</span>     <span class='co'># Aggregate only numeric columns</span>
</div><div class='output co'>#&gt;       country   year decade decade    PCGDP   LIFEEX GINI        ODA
#&gt; 1 Afghanistan 1962.5   1960   1960       NA 33.39967   NA  228641667
#&gt; 2 Afghanistan 1970.0   1970   1970       NA 36.70089   NA  224881111
#&gt; 3 Afghanistan 1980.0   1980   1980       NA 42.03909   NA  132813636
#&gt; 4 Afghanistan 1990.0   1990   1990       NA 49.69089   NA  249072222
#&gt; 5 Afghanistan 2000.0   2000   2000 349.7596 55.61818   NA 1045170000
#&gt; 6 Afghanistan 2010.0   2010   2010 506.9931 61.12978   NA 5298066667</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>           <span class='co'># Only the 4 series</span>
</div><div class='output co'>#&gt;       country decade    PCGDP   LIFEEX GINI        ODA
#&gt; 1 Afghanistan   1960       NA 33.39967   NA  228641667
#&gt; 2 Afghanistan   1970       NA 36.70089   NA  224881111
#&gt; 3 Afghanistan   1980       NA 42.03909   NA  132813636
#&gt; 4 Afghanistan   1990       NA 49.69089   NA  249072222
#&gt; 5 Afghanistan   2000 349.7596 55.61818   NA 1045170000
#&gt; 6 Afghanistan   2010 506.9931 61.12978   NA 5298066667</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>PCGDP</span> <span class='op'>+</span> <span class='va'>LIFEEX</span> <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span><span class='op'>)</span><span class='op'>)</span>         <span class='co'># Only GDP and life-expactancy</span>
</div><div class='output co'>#&gt;       country decade    PCGDP   LIFEEX
#&gt; 1 Afghanistan   1960       NA 33.39967
#&gt; 2 Afghanistan   1970       NA 36.70089
#&gt; 3 Afghanistan   1980       NA 42.03909
#&gt; 4 Afghanistan   1990       NA 49.69089
#&gt; 5 Afghanistan   2000 349.7596 55.61818
#&gt; 6 Afghanistan   2010 506.9931 61.12978</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>PCGDP</span> <span class='op'>+</span> <span class='va'>LIFEEX</span> <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, <span class='va'>fsum</span><span class='op'>)</span><span class='op'>)</span>   <span class='co'># Using the sum instead</span>
</div><div class='output co'>#&gt;       country decade    PCGDP  LIFEEX
#&gt; 1 Afghanistan   1960       NA 200.398
#&gt; 2 Afghanistan   1970       NA 330.308
#&gt; 3 Afghanistan   1980       NA 462.430
#&gt; 4 Afghanistan   1990       NA 447.218
#&gt; 5 Afghanistan   2000 1399.038 611.800
#&gt; 6 Afghanistan   2010 4562.938 550.168</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>PCGDP</span> <span class='op'>+</span> <span class='va'>LIFEEX</span> <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, <span class='va'>sum</span>,     <span class='co'># Same using base::sum -&gt; slower!</span>
            na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade    PCGDP  LIFEEX
#&gt; 1 Afghanistan   1960    0.000 200.398
#&gt; 2 Afghanistan   1970    0.000 330.308
#&gt; 3 Afghanistan   1980    0.000 462.430
#&gt; 4 Afghanistan   1990    0.000 447.218
#&gt; 5 Afghanistan   2000 1399.038 611.800
#&gt; 6 Afghanistan   2010 4562.938 550.168</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>wlddev</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"country"</span>,<span class='st'>"decade"</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>fsum</span>,        <span class='co'># Same, exploring different inputs</span>
            cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade    PCGDP  LIFEEX
#&gt; 1 Afghanistan   1960       NA 200.398
#&gt; 2 Afghanistan   1970       NA 330.308
#&gt; 3 Afghanistan   1980       NA 462.430
#&gt; 4 Afghanistan   1990       NA 447.218
#&gt; 5 Afghanistan   2000 1399.038 611.800
#&gt; 6 Afghanistan   2010 4562.938 550.168</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span><span class='op'>[</span><span class='fl'>9</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span>, <span class='va'>wlddev</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"country"</span>,<span class='st'>"decade"</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>fsum</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade    PCGDP  LIFEEX
#&gt; 1 Afghanistan   1960       NA 200.398
#&gt; 2 Afghanistan   1970       NA 330.308
#&gt; 3 Afghanistan   1980       NA 462.430
#&gt; 4 Afghanistan   1990       NA 447.218
#&gt; 5 Afghanistan   2000 1399.038 611.800
#&gt; 6 Afghanistan   2010 4562.938 550.168</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collapv</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"country"</span>,<span class='st'>"decade"</span><span class='op'>)</span>, <span class='va'>fsum</span><span class='op'>)</span><span class='op'>)</span>              <span class='co'># ..names/indices with collapv</span>
</div><div class='output co'>#&gt;       country iso3c       date  year decade     region     income  OECD
#&gt; 1 Afghanistan   AFG 1961-01-01 11775   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan   AFG 1967-01-01 17730   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan   AFG 1976-01-01 21780   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan   AFG 1987-01-01 17910   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan   AFG 1996-01-01 22000   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan   AFG 2007-01-01 18090   2010 South Asia Low income FALSE
#&gt;      PCGDP  LIFEEX GINI         ODA
#&gt; 1       NA 200.398   NA  1371850000
#&gt; 2       NA 330.308   NA  2023930000
#&gt; 3       NA 462.430   NA  1460950000
#&gt; 4       NA 447.218   NA  2241650000
#&gt; 5 1399.038 611.800   NA 11496870000
#&gt; 6 4562.938 550.168   NA 47682600000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collapv</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>5</span><span class='op'>)</span>, <span class='va'>fsum</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country iso3c       date  year decade     region     income  OECD
#&gt; 1 Afghanistan   AFG 1961-01-01 11775   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan   AFG 1967-01-01 17730   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan   AFG 1976-01-01 21780   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan   AFG 1987-01-01 17910   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan   AFG 1996-01-01 22000   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan   AFG 2007-01-01 18090   2010 South Asia Low income FALSE
#&gt;      PCGDP  LIFEEX GINI         ODA
#&gt; 1       NA 200.398   NA  1371850000
#&gt; 2       NA 330.308   NA  2023930000
#&gt; 3       NA 462.430   NA  1460950000
#&gt; 4       NA 447.218   NA  2241650000
#&gt; 5 1399.038 611.800   NA 11496870000
#&gt; 6 4562.938 550.168   NA 47682600000</div><div class='input'>
<span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='GRP, fgroup_by.html'>GRP</a></span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span><span class='op'>)</span>                            <span class='co'># Precomputing the grouping</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='va'>g</span>, keep.by <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>                        <span class='co'># This is slightly faster now</span>
</div><div class='output co'>#&gt;       country iso3c       date   year decade     region     income  OECD
#&gt; 1 Afghanistan   AFG 1961-01-01 1962.5   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan   AFG 1967-01-01 1970.0   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan   AFG 1976-01-01 1980.0   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan   AFG 1987-01-01 1990.0   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan   AFG 1996-01-01 2000.0   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan   AFG 2007-01-01 2010.0   2010 South Asia Low income FALSE
#&gt;      PCGDP   LIFEEX GINI        ODA
#&gt; 1       NA 33.39967   NA  228641667
#&gt; 2       NA 36.70089   NA  224881111
#&gt; 3       NA 42.03909   NA  132813636
#&gt; 4       NA 49.69089   NA  249072222
#&gt; 5 349.7596 55.61818   NA 1045170000
#&gt; 6 506.9931 61.12978   NA 5298066667</div><div class='input'><span class='co'># Aggregate categorical data using not the mode but the last element</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, <span class='va'>fmean</span>, <span class='va'>flast</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country iso3c       date   year decade     region     income  OECD
#&gt; 1 Afghanistan   AFG 1966-01-01 1962.5   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan   AFG 1975-01-01 1970.0   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan   AFG 1986-01-01 1980.0   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan   AFG 1995-01-01 1990.0   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan   AFG 2006-01-01 2000.0   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan   AFG 2015-01-01 2010.0   2010 South Asia Low income FALSE
#&gt;      PCGDP   LIFEEX GINI        ODA
#&gt; 1       NA 33.39967   NA  228641667
#&gt; 2       NA 36.70089   NA  224881111
#&gt; 3       NA 42.03909   NA  132813636
#&gt; 4       NA 49.69089   NA  249072222
#&gt; 5 349.7596 55.61818   NA 1045170000
#&gt; 6 506.9931 61.12978   NA 5298066667</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, catFUN <span class='op'>=</span> <span class='va'>flast</span>,         <span class='co'># Aggregate only categorical data</span>
            cols <span class='op'>=</span> <span class='va'>is.categorical</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country     country iso3c       date decade     region     income  OECD
#&gt; 1 Afghanistan Afghanistan   AFG 1966-01-01   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan Afghanistan   AFG 1975-01-01   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan Afghanistan   AFG 1986-01-01   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan Afghanistan   AFG 1995-01-01   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan Afghanistan   AFG 2006-01-01   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan Afghanistan   AFG 2015-01-01   2010 South Asia Low income FALSE</div><div class='input'>

<span class='co'>## Weighted Aggregation ----------------------------------------</span>
<span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='AA2-small-helpers.html'>fnrow</a></span><span class='op'>(</span><span class='va'>wlddev</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>                            <span class='co'># Random weight vector</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, w <span class='op'>=</span> <span class='va'>weights</span><span class='op'>)</span><span class='op'>)</span>           <span class='co'># Takes weighted mean for numeric..</span>
</div><div class='output co'>#&gt;     weights     country iso3c       date     year decade     region     income
#&gt; 1  5.219775 Afghanistan   AFG 1964-01-01 1962.878   1960 South Asia Low income
#&gt; 2  6.280377 Afghanistan   AFG 1972-01-01 1970.986   1970 South Asia Low income
#&gt; 3 12.357487 Afghanistan   AFG 1979-01-01 1980.104   1980 South Asia Low income
#&gt; 4  9.588870 Afghanistan   AFG 1987-01-01 1989.056   1990 South Asia Low income
#&gt; 5  9.112089 Afghanistan   AFG 2004-01-01 2000.208   2000 South Asia Low income
#&gt; 6  9.513924 Afghanistan   AFG 2009-01-01 2008.957   2010 South Asia Low income
#&gt;    OECD    PCGDP   LIFEEX GINI        ODA
#&gt; 1 FALSE       NA 33.56576   NA  247280527
#&gt; 2 FALSE       NA 37.14266   NA  221160015
#&gt; 3 FALSE       NA 42.06259   NA  123263137
#&gt; 4 FALSE       NA 48.93413   NA  199747378
#&gt; 5 FALSE 354.9449 55.73774   NA 1108491908
#&gt; 6 FALSE 471.7897 60.65860   NA 5290040073</div><div class='input'><span class='co'># ..and weighted mode for categorical data. The weight vector is aggregated using fsum</span>
<span class='va'>wlddev</span><span class='op'>$</span><span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='va'>weights</span>                                       <span class='co'># Adding to data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, w <span class='op'>=</span> <span class='op'>~</span> <span class='va'>weights</span><span class='op'>)</span><span class='op'>)</span>         <span class='co'># Keeps column order</span>
</div><div class='output co'>#&gt;       country iso3c       date     year decade     region     income  OECD
#&gt; 1 Afghanistan   AFG 1964-01-01 1962.878   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan   AFG 1972-01-01 1970.986   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan   AFG 1979-01-01 1980.104   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan   AFG 1987-01-01 1989.056   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan   AFG 2004-01-01 2000.208   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan   AFG 2009-01-01 2008.957   2010 South Asia Low income FALSE
#&gt;      PCGDP   LIFEEX GINI        ODA   weights
#&gt; 1       NA 33.56576   NA  247280527  5.219775
#&gt; 2       NA 37.14266   NA  221160015  6.280377
#&gt; 3       NA 42.06259   NA  123263137 12.357487
#&gt; 4       NA 48.93413   NA  199747378  9.588870
#&gt; 5 354.9449 55.73774   NA 1108491908  9.112089
#&gt; 6 471.7897 60.65860   NA 5290040073  9.513924</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, w <span class='op'>=</span> <span class='op'>~</span> <span class='va'>weights</span>,          <span class='co'># Aggregating weights using sum</span>
            wFUN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fsum</span>, <span class='va'>fmax</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>                           <span class='co'># and max (corresponding to mode)</span>
</div><div class='output co'>#&gt;       country iso3c       date     year decade     region     income  OECD
#&gt; 1 Afghanistan   AFG 1964-01-01 1962.878   1960 South Asia Low income FALSE
#&gt; 2 Afghanistan   AFG 1972-01-01 1970.986   1970 South Asia Low income FALSE
#&gt; 3 Afghanistan   AFG 1979-01-01 1980.104   1980 South Asia Low income FALSE
#&gt; 4 Afghanistan   AFG 1987-01-01 1989.056   1990 South Asia Low income FALSE
#&gt; 5 Afghanistan   AFG 2004-01-01 2000.208   2000 South Asia Low income FALSE
#&gt; 6 Afghanistan   AFG 2009-01-01 2008.957   2010 South Asia Low income FALSE
#&gt;      PCGDP   LIFEEX GINI        ODA fsum.weights fmax.weights
#&gt; 1       NA 33.56576   NA  247280527     5.219775     1.790592
#&gt; 2       NA 37.14266   NA  221160015     6.280377     1.270672
#&gt; 3       NA 42.06259   NA  123263137    12.357487     2.211769
#&gt; 4       NA 48.93413   NA  199747378     9.588870     2.564408
#&gt; 5 354.9449 55.73774   NA 1108491908     9.112089     2.446680
#&gt; 6 471.7897 60.65860   NA 5290040073     9.513924     2.648932</div><div class='input'><span class='va'>wlddev</span><span class='op'>$</span><span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>


<span class='co'>## Multi-Function Aggregation ----------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fmean</span>, <span class='va'>fNobs</span><span class='op'>)</span>,     <span class='co'># Saving mean and Nobs</span>
            cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade fmean.PCGDP fNobs.PCGDP fmean.LIFEEX fNobs.LIFEEX
#&gt; 1 Afghanistan   1960          NA           0     33.39967            6
#&gt; 2 Afghanistan   1970          NA           0     36.70089            9
#&gt; 3 Afghanistan   1980          NA           0     42.03909           11
#&gt; 4 Afghanistan   1990          NA           0     49.69089            9
#&gt; 5 Afghanistan   2000    349.7596           4     55.61818           11
#&gt; 6 Afghanistan   2010    506.9931           9     61.12978            9
#&gt;   fmean.GINI fNobs.GINI  fmean.ODA fNobs.ODA
#&gt; 1         NA          0  228641667         6
#&gt; 2         NA          0  224881111         9
#&gt; 3         NA          0  132813636        11
#&gt; 4         NA          0  249072222         9
#&gt; 5         NA          0 1045170000        11
#&gt; 6         NA          0 5298066667         9</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># Same using base R -&gt; slower</span>
            <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='va'>mean</span>,
                 Nobs <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
            cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade mean.PCGDP Nobs.PCGDP mean.LIFEEX Nobs.LIFEEX mean.GINI
#&gt; 1 Afghanistan   1960        NaN          0    33.39967           6       NaN
#&gt; 2 Afghanistan   1970        NaN          0    36.70089           9       NaN
#&gt; 3 Afghanistan   1980        NaN          0    42.03909          11       NaN
#&gt; 4 Afghanistan   1990        NaN          0    49.69089           9       NaN
#&gt; 5 Afghanistan   2000   349.7596          4    55.61818          11       NaN
#&gt; 6 Afghanistan   2010   506.9931          9    61.12978           9       NaN
#&gt;   Nobs.GINI   mean.ODA Nobs.ODA
#&gt; 1         0  228641667        6
#&gt; 2         0  224881111        9
#&gt; 3         0  132813636       11
#&gt; 4         0  249072222        9
#&gt; 5         0 1045170000       11
#&gt; 6         0 5298066667        9</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                       <span class='co'># List output format</span>
            <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fmean</span>, <span class='va'>fNobs</span><span class='op'>)</span>, cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span>, return <span class='op'>=</span> <span class='st'>"list"</span><span class='op'>)</span>, <span class='va'>head</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $fmean
#&gt;       country decade    PCGDP   LIFEEX GINI        ODA
#&gt; 1 Afghanistan   1960       NA 33.39967   NA  228641667
#&gt; 2 Afghanistan   1970       NA 36.70089   NA  224881111
#&gt; 3 Afghanistan   1980       NA 42.03909   NA  132813636
#&gt; 4 Afghanistan   1990       NA 49.69089   NA  249072222
#&gt; 5 Afghanistan   2000 349.7596 55.61818   NA 1045170000
#&gt; 6 Afghanistan   2010 506.9931 61.12978   NA 5298066667
#&gt; 
#&gt; $fNobs
#&gt;       country decade PCGDP LIFEEX GINI ODA
#&gt; 1 Afghanistan   1960     0      6    0   6
#&gt; 2 Afghanistan   1970     0      9    0   9
#&gt; 3 Afghanistan   1980     0     11    0  11
#&gt; 4 Afghanistan   1990     0      9    0   9
#&gt; 5 Afghanistan   2000     4     11    0  11
#&gt; 6 Afghanistan   2010     9      9    0   9
#&gt; </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># Long output format</span>
            <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fmean</span>, <span class='va'>fNobs</span><span class='op'>)</span>, cols <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span>, return <span class='op'>=</span> <span class='st'>"long"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Function     country decade    PCGDP   LIFEEX GINI        ODA
#&gt; 1    fmean Afghanistan   1960       NA 33.39967   NA  228641667
#&gt; 2    fmean Afghanistan   1970       NA 36.70089   NA  224881111
#&gt; 3    fmean Afghanistan   1980       NA 42.03909   NA  132813636
#&gt; 4    fmean Afghanistan   1990       NA 49.69089   NA  249072222
#&gt; 5    fmean Afghanistan   2000 349.7596 55.61818   NA 1045170000
#&gt; 6    fmean Afghanistan   2010 506.9931 61.12978   NA 5298066667</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># Also aggregating categorical data,</span>
            <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fmean</span>, <span class='va'>fNobs</span><span class='op'>)</span>, return <span class='op'>=</span> <span class='st'>"long_dupl"</span><span class='op'>)</span><span class='op'>)</span>          <span class='co'># and duplicating it 2 times</span>
</div><div class='output co'>#&gt;   Function     country iso3c       date   year decade     region     income
#&gt; 1    fmean Afghanistan   AFG 1961-01-01 1962.5   1960 South Asia Low income
#&gt; 2    fmean Afghanistan   AFG 1967-01-01 1970.0   1970 South Asia Low income
#&gt; 3    fmean Afghanistan   AFG 1976-01-01 1980.0   1980 South Asia Low income
#&gt; 4    fmean Afghanistan   AFG 1987-01-01 1990.0   1990 South Asia Low income
#&gt; 5    fmean Afghanistan   AFG 1996-01-01 2000.0   2000 South Asia Low income
#&gt; 6    fmean Afghanistan   AFG 2007-01-01 2010.0   2010 South Asia Low income
#&gt;    OECD    PCGDP   LIFEEX GINI        ODA
#&gt; 1 FALSE       NA 33.39967   NA  228641667
#&gt; 2 FALSE       NA 36.70089   NA  224881111
#&gt; 3 FALSE       NA 42.03909   NA  132813636
#&gt; 4 FALSE       NA 49.69089   NA  249072222
#&gt; 5 FALSE 349.7596 55.61818   NA 1045170000
#&gt; 6 FALSE 506.9931 61.12978   NA 5298066667</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># Now also using 2 functions on</span>
            <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fmean</span>, <span class='va'>fNobs</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fmode</span>, <span class='va'>flast</span><span class='op'>)</span>,             <span class='co'># categorical data</span>
            keep.col.order <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade fmean.year fmean.PCGDP fmean.LIFEEX fmean.GINI  fmean.ODA
#&gt; 1 Afghanistan   1960     1962.5          NA     33.39967         NA  228641667
#&gt; 2 Afghanistan   1970     1970.0          NA     36.70089         NA  224881111
#&gt; 3 Afghanistan   1980     1980.0          NA     42.03909         NA  132813636
#&gt; 4 Afghanistan   1990     1990.0          NA     49.69089         NA  249072222
#&gt; 5 Afghanistan   2000     2000.0    349.7596     55.61818         NA 1045170000
#&gt; 6 Afghanistan   2010     2010.0    506.9931     61.12978         NA 5298066667
#&gt;   fNobs.year fNobs.PCGDP fNobs.LIFEEX fNobs.GINI fNobs.ODA fmode.iso3c
#&gt; 1          6           0            6          0         6         AFG
#&gt; 2          9           0            9          0         9         AFG
#&gt; 3         11           0           11          0        11         AFG
#&gt; 4          9           0            9          0         9         AFG
#&gt; 5         11           4           11          0        11         AFG
#&gt; 6          9           9            9          0         9         AFG
#&gt;   fmode.date fmode.region fmode.income fmode.OECD flast.iso3c flast.date
#&gt; 1 1961-01-01   South Asia   Low income      FALSE         AFG 1966-01-01
#&gt; 2 1967-01-01   South Asia   Low income      FALSE         AFG 1975-01-01
#&gt; 3 1976-01-01   South Asia   Low income      FALSE         AFG 1986-01-01
#&gt; 4 1987-01-01   South Asia   Low income      FALSE         AFG 1995-01-01
#&gt; 5 1996-01-01   South Asia   Low income      FALSE         AFG 2006-01-01
#&gt; 6 2007-01-01   South Asia   Low income      FALSE         AFG 2015-01-01
#&gt;   flast.region flast.income flast.OECD
#&gt; 1   South Asia   Low income      FALSE
#&gt; 2   South Asia   Low income      FALSE
#&gt; 3   South Asia   Low income      FALSE
#&gt; 4   South Asia   Low income      FALSE
#&gt; 5   South Asia   Low income      FALSE
#&gt; 6   South Asia   Low income      FALSE</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># More functions, string input,</span>
            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fmean"</span>,<span class='st'>"fsum"</span>,<span class='st'>"fNobs"</span>,<span class='st'>"fsd"</span>,<span class='st'>"fvar"</span><span class='op'>)</span>,             <span class='co'># parallelized execution</span>
            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fmode"</span>,<span class='st'>"ffirst"</span>,<span class='st'>"flast"</span>,<span class='st'>"fNdistinct"</span><span class='op'>)</span>,           <span class='co'># (choose more than 1 cores,</span>
            parallel <span class='op'>=</span> <span class='cn'>TRUE</span>, mc.cores <span class='op'>=</span> <span class='fl'>1L</span>,                     <span class='co'># depending on your machine)</span>
            keep.col.order <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade fmean.year fmean.PCGDP fmean.LIFEEX fmean.GINI  fmean.ODA
#&gt; 1 Afghanistan   1960     1962.5          NA     33.39967         NA  228641667
#&gt; 2 Afghanistan   1970     1970.0          NA     36.70089         NA  224881111
#&gt; 3 Afghanistan   1980     1980.0          NA     42.03909         NA  132813636
#&gt; 4 Afghanistan   1990     1990.0          NA     49.69089         NA  249072222
#&gt; 5 Afghanistan   2000     2000.0    349.7596     55.61818         NA 1045170000
#&gt; 6 Afghanistan   2010     2010.0    506.9931     61.12978         NA 5298066667
#&gt;   fsum.year fsum.PCGDP fsum.LIFEEX fsum.GINI    fsum.ODA fNobs.year fNobs.PCGDP
#&gt; 1     11775         NA     200.398        NA  1371850000          6           0
#&gt; 2     17730         NA     330.308        NA  2023930000          9           0
#&gt; 3     21780         NA     462.430        NA  1460950000         11           0
#&gt; 4     17910         NA     447.218        NA  2241650000          9           0
#&gt; 5     22000   1399.038     611.800        NA 11496870000         11           4
#&gt; 6     18090   4562.938     550.168        NA 47682600000          9           9
#&gt;   fNobs.LIFEEX fNobs.GINI fNobs.ODA fsd.year fsd.PCGDP fsd.LIFEEX fsd.GINI
#&gt; 1            6          0         6 1.870829        NA  0.8236083       NA
#&gt; 2            9          0         9 2.738613        NA  1.2329864       NA
#&gt; 3           11          0        11 3.316625        NA  2.1599808       NA
#&gt; 4            9          0         9 2.738613        NA  2.1258392       NA
#&gt; 5           11          0        11 3.316625  11.89378  1.8056120       NA
#&gt; 6            9          0         9 2.738613  86.22723  1.2872844       NA
#&gt;      fsd.ODA fvar.year fvar.PCGDP fvar.LIFEEX fvar.GINI     fvar.ODA
#&gt; 1  101559732       3.5         NA   0.6783307        NA 1.031438e+16
#&gt; 2   58515953       7.5         NA   1.5202554        NA 3.424117e+15
#&gt; 3  108271755      11.0         NA   4.6655169        NA 1.172277e+16
#&gt; 4  203018929       7.5         NA   4.5191921        NA 4.121669e+16
#&gt; 5 1113781886      11.0    141.462   3.2602346        NA 1.240510e+18
#&gt; 6 1102034385       7.5   7435.136   1.6571012        NA 1.214480e+18
#&gt;   fmode.iso3c fmode.date fmode.region fmode.income fmode.OECD ffirst.iso3c
#&gt; 1         AFG 1961-01-01   South Asia   Low income      FALSE          AFG
#&gt; 2         AFG 1967-01-01   South Asia   Low income      FALSE          AFG
#&gt; 3         AFG 1976-01-01   South Asia   Low income      FALSE          AFG
#&gt; 4         AFG 1987-01-01   South Asia   Low income      FALSE          AFG
#&gt; 5         AFG 1996-01-01   South Asia   Low income      FALSE          AFG
#&gt; 6         AFG 2007-01-01   South Asia   Low income      FALSE          AFG
#&gt;   ffirst.date ffirst.region ffirst.income ffirst.OECD flast.iso3c flast.date
#&gt; 1  1961-01-01    South Asia    Low income       FALSE         AFG 1966-01-01
#&gt; 2  1967-01-01    South Asia    Low income       FALSE         AFG 1975-01-01
#&gt; 3  1976-01-01    South Asia    Low income       FALSE         AFG 1986-01-01
#&gt; 4  1987-01-01    South Asia    Low income       FALSE         AFG 1995-01-01
#&gt; 5  1996-01-01    South Asia    Low income       FALSE         AFG 2006-01-01
#&gt; 6  2007-01-01    South Asia    Low income       FALSE         AFG 2015-01-01
#&gt;   flast.region flast.income flast.OECD fNdistinct.iso3c fNdistinct.date
#&gt; 1   South Asia   Low income      FALSE                1               6
#&gt; 2   South Asia   Low income      FALSE                1               9
#&gt; 3   South Asia   Low income      FALSE                1              11
#&gt; 4   South Asia   Low income      FALSE                1               9
#&gt; 5   South Asia   Low income      FALSE                1              11
#&gt; 6   South Asia   Low income      FALSE                1               9
#&gt;   fNdistinct.region fNdistinct.income fNdistinct.OECD
#&gt; 1                 1                 1               1
#&gt; 2                 1                 1               1
#&gt; 3                 1                 1               1
#&gt; 4                 1                 1               1
#&gt; 5                 1                 1               1
#&gt; 6                 1                 1               1</div><div class='input'>

<span class='co'>## Custom Aggregation ------------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># Custom aggregation</span>
            custom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fmean <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span>, fsd <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>10</span>, fmode <span class='op'>=</span> <span class='fl'>7</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade fmode.income fmode.OECD fmean.PCGDP fsd.PCGDP fmean.LIFEEX
#&gt; 1 Afghanistan   1960   Low income      FALSE          NA        NA     33.39967
#&gt; 2 Afghanistan   1970   Low income      FALSE          NA        NA     36.70089
#&gt; 3 Afghanistan   1980   Low income      FALSE          NA        NA     42.03909
#&gt; 4 Afghanistan   1990   Low income      FALSE          NA        NA     49.69089
#&gt; 5 Afghanistan   2000   Low income      FALSE    349.7596  11.89378     55.61818
#&gt; 6 Afghanistan   2010   Low income      FALSE    506.9931  86.22723     61.12978
#&gt;   fsd.LIFEEX fmean.GINI  fmean.ODA
#&gt; 1  0.8236083         NA  228641667
#&gt; 2  1.2329864         NA  224881111
#&gt; 3  2.1599808         NA  132813636
#&gt; 4  2.1258392         NA  249072222
#&gt; 5  1.8056120         NA 1045170000
#&gt; 6  1.2872844         NA 5298066667</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># Using column names</span>
            custom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fmean <span class='op'>=</span> <span class='st'>"PCGDP"</span>, fsd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LIFEEX"</span>,<span class='st'>"GINI"</span><span class='op'>)</span>,
                          flast <span class='op'>=</span> <span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country       date decade    PCGDP    LIFEEX GINI
#&gt; 1 Afghanistan 1966-01-01   1960       NA 0.8236083   NA
#&gt; 2 Afghanistan 1975-01-01   1970       NA 1.2329864   NA
#&gt; 3 Afghanistan 1986-01-01   1980       NA 2.1599808   NA
#&gt; 4 Afghanistan 1995-01-01   1990       NA 2.1258392   NA
#&gt; 5 Afghanistan 2006-01-01   2000 349.7596 1.8056120   NA
#&gt; 6 Afghanistan 2015-01-01   2010 506.9931 1.2872844   NA</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># Weighted parallelized custom</span>
            custom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fmean <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span>, fsd <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>10</span>,             <span class='co'># aggregation</span>
                          fmode <span class='op'>=</span> <span class='fl'>7</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span>, w <span class='op'>=</span> <span class='va'>weights</span>,
            wFUN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fsum</span>, <span class='va'>fmax</span><span class='op'>)</span>,
            parallel <span class='op'>=</span> <span class='cn'>TRUE</span>, mc.cores <span class='op'>=</span> <span class='fl'>1L</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   fsum.weights fmax.weights     country decade fmode.income fmode.OECD
#&gt; 1     5.219775     1.790592 Afghanistan   1960   Low income      FALSE
#&gt; 2     6.280377     1.270672 Afghanistan   1970   Low income      FALSE
#&gt; 3    12.357487     2.211769 Afghanistan   1980   Low income      FALSE
#&gt; 4     9.588870     2.564408 Afghanistan   1990   Low income      FALSE
#&gt; 5     9.112089     2.446680 Afghanistan   2000   Low income      FALSE
#&gt; 6     9.513924     2.648932 Afghanistan   2010   Low income      FALSE
#&gt;   fmean.PCGDP fsd.PCGDP fmean.LIFEEX fsd.LIFEEX fmean.GINI  fmean.ODA
#&gt; 1          NA        NA     33.56576  0.8351381         NA  247280527
#&gt; 2          NA        NA     37.14266  1.1330649         NA  221160015
#&gt; 3          NA        NA     42.06259  1.8611270         NA  123263137
#&gt; 4          NA        NA     48.93413  2.2581963         NA  199747378
#&gt; 5    354.9449  8.672255     55.73774  1.8527170         NA 1108491908
#&gt; 6    471.7897 78.761274     60.65860  1.0621405         NA 5290040073</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>collap</span><span class='op'>(</span><span class='va'>wlddev</span>, <span class='op'>~</span> <span class='va'>country</span> <span class='op'>+</span> <span class='va'>decade</span>,                         <span class='co'># No column reordering</span>
            custom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fmean <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span>, fsd <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>10</span>,
                          fmode <span class='op'>=</span> <span class='fl'>7</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span>, w <span class='op'>=</span> <span class='va'>weights</span>,
            wFUN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fsum</span>, <span class='va'>fmax</span><span class='op'>)</span>,
            parallel <span class='op'>=</span> <span class='cn'>TRUE</span>, mc.cores <span class='op'>=</span> <span class='fl'>1L</span>, keep.col.order <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       country decade fsum.weights fmax.weights fmean.PCGDP fmean.LIFEEX
#&gt; 1 Afghanistan   1960     5.219775     1.790592          NA     33.56576
#&gt; 2 Afghanistan   1970     6.280377     1.270672          NA     37.14266
#&gt; 3 Afghanistan   1980    12.357487     2.211769          NA     42.06259
#&gt; 4 Afghanistan   1990     9.588870     2.564408          NA     48.93413
#&gt; 5 Afghanistan   2000     9.112089     2.446680    354.9449     55.73774
#&gt; 6 Afghanistan   2010     9.513924     2.648932    471.7897     60.65860
#&gt;   fmean.GINI  fmean.ODA fsd.PCGDP fsd.LIFEEX fmode.income fmode.OECD
#&gt; 1         NA  247280527        NA  0.8351381   Low income      FALSE
#&gt; 2         NA  221160015        NA  1.1330649   Low income      FALSE
#&gt; 3         NA  123263137        NA  1.8611270   Low income      FALSE
#&gt; 4         NA  199747378        NA  2.2581963   Low income      FALSE
#&gt; 5         NA 1108491908  8.672255  1.8527170   Low income      FALSE
#&gt; 6         NA 5290040073 78.761274  1.0621405   Low income      FALSE</div><div class='input'>
 
<span class='co'>## Piped Use --------------------------------------------------</span>
<span class='va'>wlddev</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>country</span>, <span class='va'>decade</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>collapg</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;       country decade iso3c       date   year     region     income  OECD
#&gt; 1 Afghanistan   1960   AFG 1961-01-01 1962.5 South Asia Low income FALSE
#&gt; 2 Afghanistan   1970   AFG 1967-01-01 1970.0 South Asia Low income FALSE
#&gt; 3 Afghanistan   1980   AFG 1976-01-01 1980.0 South Asia Low income FALSE
#&gt; 4 Afghanistan   1990   AFG 1987-01-01 1990.0 South Asia Low income FALSE
#&gt; 5 Afghanistan   2000   AFG 1996-01-01 2000.0 South Asia Low income FALSE
#&gt; 6 Afghanistan   2010   AFG 2007-01-01 2010.0 South Asia Low income FALSE
#&gt;      PCGDP   LIFEEX GINI        ODA
#&gt; 1       NA 33.39967   NA  228641667
#&gt; 2       NA 36.70089   NA  224881111
#&gt; 3       NA 42.03909   NA  132813636
#&gt; 4       NA 49.69089   NA  249072222
#&gt; 5 349.7596 55.61818   NA 1045170000
#&gt; 6 506.9931 61.12978   NA 5298066667</div><div class='input'><span class='va'>wlddev</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>country</span>, <span class='va'>decade</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>collapg</span><span class='op'>(</span>w <span class='op'>=</span> <span class='va'>ODA</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;       country decade         ODA iso3c       date     year     region
#&gt; 1 Afghanistan   1960  1371850000   AFG 1966-01-01 1963.086 South Asia
#&gt; 2 Afghanistan   1970  2023930000   AFG 1967-01-01 1969.797 South Asia
#&gt; 3 Afghanistan   1980  1460950000   AFG 1978-01-01 1977.816 South Asia
#&gt; 4 Afghanistan   1990  2241650000   AFG 1992-01-01 1991.213 South Asia
#&gt; 5 Afghanistan   2000 11496870000   AFG 2006-01-01 2002.833 South Asia
#&gt; 6 Afghanistan   2010 47682600000   AFG 2012-01-01 2010.168 South Asia
#&gt;       income  OECD    PCGDP   LIFEEX GINI
#&gt; 1 Low income FALSE       NA 33.65730   NA
#&gt; 2 Low income FALSE       NA 36.61192   NA
#&gt; 3 Low income FALSE       NA 40.63028   NA
#&gt; 4 Low income FALSE       NA 50.67509   NA
#&gt; 5 Low income FALSE 351.3902 57.20476   NA
#&gt; 6 Low income FALSE 515.1409 61.22270   NA</div><div class='input'><span class='va'>wlddev</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>country</span>, <span class='va'>decade</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>collapg</span><span class='op'>(</span><span class='va'>fmedian</span>, <span class='va'>flast</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;       country decade iso3c       date   year     region     income  OECD
#&gt; 1 Afghanistan   1960   AFG 1966-01-01 1962.5 South Asia Low income FALSE
#&gt; 2 Afghanistan   1970   AFG 1975-01-01 1970.0 South Asia Low income FALSE
#&gt; 3 Afghanistan   1980   AFG 1986-01-01 1980.0 South Asia Low income FALSE
#&gt; 4 Afghanistan   1990   AFG 1995-01-01 1990.0 South Asia Low income FALSE
#&gt; 5 Afghanistan   2000   AFG 2006-01-01 2000.0 South Asia Low income FALSE
#&gt; 6 Afghanistan   2010   AFG 2015-01-01 2010.0 South Asia Low income FALSE
#&gt;      PCGDP  LIFEEX GINI        ODA
#&gt; 1       NA 33.4045   NA  234900000
#&gt; 2       NA 36.6780   NA  229150000
#&gt; 3       NA 41.8530   NA   72610000
#&gt; 4       NA 49.8560   NA  238500000
#&gt; 5 346.9282 55.4820   NA  306200000
#&gt; 6 536.0125 61.2260   NA 5033950000</div><div class='input'><span class='va'>wlddev</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='GRP, fgroup_by.html'>fgroup_by</a></span><span class='op'>(</span><span class='va'>country</span>, <span class='va'>decade</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>collapg</span><span class='op'>(</span>custom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fmean <span class='op'>=</span> <span class='fl'>9</span><span class='op'>:</span><span class='fl'>12</span>, fmode <span class='op'>=</span> <span class='fl'>5</span><span class='op'>:</span><span class='fl'>7</span>, flast <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</div><div class='output co'>#&gt;       country decade       date decade     region     income    PCGDP   LIFEEX
#&gt; 1 Afghanistan   1960 1966-01-01   1960 South Asia Low income       NA 33.39967
#&gt; 2 Afghanistan   1970 1975-01-01   1970 South Asia Low income       NA 36.70089
#&gt; 3 Afghanistan   1980 1986-01-01   1980 South Asia Low income       NA 42.03909
#&gt; 4 Afghanistan   1990 1995-01-01   1990 South Asia Low income       NA 49.69089
#&gt; 5 Afghanistan   2000 2006-01-01   2000 South Asia Low income 349.7596 55.61818
#&gt; 6 Afghanistan   2010 2015-01-01   2010 South Asia Low income 506.9931 61.12978
#&gt;   GINI        ODA
#&gt; 1   NA  228641667
#&gt; 2   NA  224881111
#&gt; 3   NA  132813636
#&gt; 4   NA  249072222
#&gt; 5   NA 1045170000
#&gt; 6   NA 5298066667</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


