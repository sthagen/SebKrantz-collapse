<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fast (Grouped, Weighted) N'th Element/Quantile for Matrix-Like Objects — fnth-fmedian • collapse</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fast (Grouped, Weighted) N'th Element/Quantile for Matrix-Like Objects — fnth-fmedian"><meta property="og:description" content="fnth (column-wise) returns the n'th smallest element from a set of unsorted elements x corresponding to an integer index (n), or to a probability between 0 and 1. If n is passed as a probability, ties can be resolved using the lower, upper, or average of the possible elements, or, since v1.9.0, continuous quantile estimation. The new default is quantile type 7 (as in quantile). For n &amp;gt; 1, the lower element is always returned (as in sort(x, partial = n)[n]). See Details.
fmedian is a simple wrapper around fnth, which fixes n = 0.5 and (default) ties = &quot;mean&quot; i.e. it averages eligible elements. See Details. "><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" class="external-link">Blog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/collapse_R" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast (Grouped, Weighted) N'th Element/Quantile for Matrix-Like Objects</h1>
    
    <div class="hidden name"><code>fnth_fmedian.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>fnth</code> (column-wise) returns the n'th smallest element from a set of unsorted elements <code>x</code> corresponding to an integer index (<code>n</code>), or to a probability between 0 and 1. If <code>n</code> is passed as a probability, ties can be resolved using the lower, upper, or average of the possible elements, or, since v1.9.0, continuous quantile estimation. The new default is quantile type 7 (as in <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>). For <code>n &gt; 1</code>, the lower element is always returned (as in <code>sort(x, partial = n)[n]</code>). See Details.</p>
<p><code>fmedian</code> is a simple wrapper around <code>fnth</code>, which fixes <code>n = 0.5</code> and (default) <code>ties = "mean"</code> i.e. it averages eligible elements. See Details. <!-- %Users may prefer a quantile based definition of the weighted median. --></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     use.g.names <span class="op">=</span> <span class="cn">TRUE</span>, ties <span class="op">=</span> <span class="st">"q7"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     o <span class="op">=</span> <span class="cn">NULL</span>, check.o <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"sorted"</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, ties <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     use.g.names <span class="op">=</span> <span class="cn">TRUE</span>, drop <span class="op">=</span> <span class="cn">TRUE</span>, ties <span class="op">=</span> <span class="st">"q7"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, ties <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     use.g.names <span class="op">=</span> <span class="cn">TRUE</span>, drop <span class="op">=</span> <span class="cn">TRUE</span>, ties <span class="op">=</span> <span class="st">"q7"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, ties <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for grouped_df</span></span>
<span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     use.g.names <span class="op">=</span> <span class="cn">FALSE</span>, keep.group_vars <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     ties <span class="op">=</span> <span class="st">"q7"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for grouped_df</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        use.g.names <span class="op">=</span> <span class="cn">FALSE</span>, keep.group_vars <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        ties <span class="op">=</span> <span class="st">"mean"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector, matrix, data frame or grouped data frame (class 'grouped_df').</p></dd>


<dt>n</dt>
<dd><p>the element to return using a single integer index such that <code>1 &lt; n &lt; NROW(x)</code>, or a probability <code>0 &lt; n &lt; 1</code>. See Details.</p></dd>


<dt>g</dt>
<dd><p>a factor, <code><a href="GRP.html">GRP</a></code> object, atomic vector (internally converted to factor) or a list of vectors / factors (internally converted to a <code><a href="GRP.html">GRP</a></code> object) used to group <code>x</code>.</p></dd>


<dt>w</dt>
<dd><p>a numeric vector of (non-negative) weights, may contain missing values only where <code>x</code> is also missing.</p></dd>


<dt>TRA</dt>
<dd><p>an integer or quoted operator indicating the transformation to perform:
0 - "replace_NA"     |     1 - "replace_fill"     |     2 - "replace"     |     3 - "-"     |     4 - "-+"     |     5 - "/"     |     6 - "%"     |     7 - "+"     |     8 - "*"     |     9 - "%%"     |     10 - "-%%". See <code><a href="TRA.html">TRA</a></code>.</p></dd>


<dt>na.rm</dt>
<dd><p>logical. Skip missing values in <code>x</code>. Defaults to <code>TRUE</code> and implemented at very little computational cost. If <code>na.rm = FALSE</code> a <code>NA</code> is returned when encountered.</p></dd>


<dt>use.g.names</dt>
<dd><p>logical. Make group-names and add to the result as names (default method) or row-names (matrix and data frame methods). No row-names are generated for <em>data.table</em>'s.</p></dd>


<dt>ties</dt>
<dd><p>an integer or character string specifying the method to resolve ties between adjacent qualifying elements:</p><table class="table table"><tr><td><em> Int. </em></td><td></td><td><em> String </em></td><td></td><td><em> Description </em></td></tr><tr><td>1</td><td></td><td>"mean"</td><td></td><td>take the arithmetic mean of all qualifying elements.</td></tr><tr><td>2</td><td></td><td>"min"</td><td></td><td>take the smallest of the elements.</td></tr><tr><td>3</td><td></td><td>"max"</td><td></td><td>take the largest of the elements.</td></tr><tr><td>5-9</td><td></td><td>"qn"</td><td></td><td>continuous quantile types 5-9, see <code><a href="fquantile.html">fquantile</a></code>.</td></tr></table></dd>


<dt>nthreads</dt>
<dd><p>integer. The number of threads to utilize. Parallelism is across groups for grouped computations on vectors and data frames, and at the column-level otherwise. See Details.</p></dd>


<dt>o</dt>
<dd><p>integer. A valid ordering of <code>x</code>, e.g. <code>radixorder(x)</code>. With groups, the grouping needs to be accounted e.g. <code>radixorder(g, x)</code>.</p></dd>


<dt>check.o</dt>
<dd><p>logical. <code>TRUE</code> checks that each element of <code>o</code> is within <code>[1, length(x)]</code>. The default uses the fact that orderings from <code><a href="radixorder.html">radixorder</a></code> have a <code>"sorted"</code> attribute which let's <code>fnth</code> infer that the ordering is valid. The length and data type of <code>o</code> is always checked, regardless of <code>check.o</code>.</p></dd>


<dt>drop</dt>
<dd><p><em>matrix and data.frame method:</em> Logical. <code>TRUE</code> drops dimensions and returns an atomic vector if <code>g = NULL</code> and <code>TRA = NULL</code>.</p></dd>


<dt>keep.group_vars</dt>
<dd><p><em>grouped_df method:</em> Logical. <code>FALSE</code> removes grouping variables after computation.</p></dd>


<dt>keep.w</dt>
<dd><p><em>grouped_df method:</em> Logical. Retain <code>sum</code> of weighting variable after computation (if contained in <code>grouped_df</code>).</p></dd>


<dt>...</dt>
<dd><p>for <code>fmedian</code>: further arguments passed to <code>fnth</code> (apart from <code>n</code>). If <code>TRA</code> is used, passing <code>set = TRUE</code> will transform data by reference and return the result invisibly.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>For v1.9.0 <code>fnth</code> was completely rewritten in C and offers significantly enhanced speed and functionality. It uses a combination of quickselect, quicksort, and radixsort algorithms, combined with several (weighted) quantile estimation methods and, where possible, OpenMP multithreading. This synthesis can be summarised as follows:</p>
<ul><li><p>without weights, quickselect is used to determine a (lower) order statistic. If <code>ties %!in% c("min", "max")</code> a second order statistic is found by taking the max of the upper part of the partitioned array, and the two statistics are averaged using a simple mean (<code>ties = "mean"</code>), or weighted average according to a <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code> method (<code>ties = "q5"-"q9"</code>). For <code>n = 0.5</code>, all supported quantile methods give the sample median. With matrices, multithreading is always across columns, for vectors and data frames it is across groups unless <code>is.null(g)</code> for data frames.</p></li>
<li><p>with weights and no groups (<code>is.null(g)</code>), <code><a href="radixorder.html">radixorder</a></code> is called internally (on each column of <code>x</code>). The ordering is used to sum the weights in order of <code>x</code> and determine weighted order statistics or quantiles. See details below. Multithreading is disabled as <code><a href="radixorder.html">radixorder</a></code> cannot be called concurrently on the same memory stack.</p></li>
<li><p>with weights and groups (<code>!is.null(g)</code>), R's quicksort algorithm is used to sort the data in each group and return an index which can be used to sum the weights in order and proceed as before. This is multithreaded across columns for matrices, and across groups otherwise.</p></li>
<li><p>in <code>fnth.default</code>, an ordering of <code>x</code> can be supplied to '<code>o</code>' e.g. <code>fnth(x, 0.75, o = radixorder(x))</code>. This dramatically speeds up the estimation both with and without weights, and is useful if <code>fnth</code> is to be invoked repeatedly on the same data. With groups, <code>o</code> needs to also account for the grouping e.g. <code>fnth(x, 0.75, g, o = radixorder(g, x))</code>. Multithreading is possible across groups. See Examples.</p></li>
</ul><p><!-- %This is an R port to \code{std::nth_element}, an efficient partial sorting algorithm in C++. It is also used to calculated the median (in fact the default \code{fnth(x, n = 0.5)} is identical to \code{fmedian(x)}, so see also the details for \code{\link{fmedian}}). --></p>
<p><!-- % \code{fnth} generalizes the principles of median value calculation to find arbitrary elements. It offers considerable flexibility by providing both simple order statistics and simple discontinuous quantile estimation. Regarding the former, setting \code{n} to an index between 1 and \code{NROW(x)} will return the n'th smallest element of \code{x}, about 2x faster than \code{sort(x, partial = n)[n]}. As to the latter, setting \code{n} to a probability between 0 and 1 will return the corresponding element of \code{x}, and resolve ties between multiple qualifying elements (such as when \code{n = 0.5} and \code{x} is even) using the arithmetic average \code{ties = "mean"}, or the smallest \code{ties = "min"} or largest \code{ties = "max"} of those elements. --></p>
<p>If <code>n &gt; 1</code>, the result is equivalent to (column-wise) <code>sort(x, partial = n)[n]</code>. Internally, <code>n</code> is converted to a probability using <code>p = (n-1)/(NROW(x)-1)</code>, and that probability is applied to the set of non-missing elements to find the <code>as.integer(p*(fnobs(x)-1))+1L</code>'th element (which corresponds to option <code>ties = "min"</code>). <!-- % Note that it is necessary to subtract and add 1 so that \code{n = 1} corresponds to \code{p = 0} and \code{n = NROW(x)} to \code{p = 1}. %So if \code{n &gt; 1} is used in the presence of missing values, and the default \code{ties = "mean"} is enabled, the resulting element could be the average of two elements. -->
When using grouped computations with <code>n &gt; 1</code>, <code>n</code> is transformed to a probability <code>p = (n-1)/(NROW(x)/ng-1)</code> (where <code>ng</code> contains the number of unique groups in <code>g</code>).</p>
<p>If weights are used and <code>ties = "q5"-"q9"</code>, weighted continuous quantile estimation is done as described in <code><a href="fquantile.html">fquantile</a></code>.</p>
<p>For <code>ties %in% c("mean", "min", "max")</code>, a target partial sum of weights <code>p*sum(w)</code> is calculated, and the weighted n'th element is the element k such that all elements smaller than k have a sum of weights <code>&lt;= p*sum(w)</code>, and all elements larger than k have a sum of weights <code>&lt;= (1 - p)*sum(w)</code>. If the partial-sum of weights (<code>p*sum(w)</code>) is reached exactly for some element k, then (summing from the lower end) both k and k+1 would qualify as the weighted n'th element. If the weight of element k+1 is zero, k, k+1 and k+2 would qualify... . If <code>n &gt; 1</code>, k is chosen (consistent with the unweighted behavior). <!-- %(ensuring that \code{fnth(x, n)}) and \code{fnth(x, n, w = rep(1, NROW(x)))}, always provide the same outcome) -->
If <code>0 &lt; n &lt; 1</code>, the <code>ties</code> option regulates how to resolve such conflicts, yielding lower (<code>ties = "min"</code>: k), upper (<code>ties = "max"</code>: k+2) or average weighted (<code>ties = "mean"</code>: mean(k, k+1, k+2)) n'th elements.</p>
<p>Thus, in the presence of zero weights, the weighted median (default <code>ties = "mean"</code>) can be an arithmetic average of &gt;2 qualifying elements. Users may prefer a quantile based weighted median by setting <code>ties = "q5"-"q9"</code>, which is a continuous function of <code>p</code> and ignores elements with zero weights.</p>
<p>For data frames, column-attributes and overall attributes are preserved if <code>g</code> is used or <code>drop = FALSE</code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>The (<code>w</code> weighted) n'th element/quantile of <code>x</code>, grouped by <code>g</code>, or (if <code><a href="TRA.html">TRA</a></code> is used) <code>x</code> transformed by its (grouped, weighted) n'th element/quantile.</p>


    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="fquantile.html">fquantile</a></code>, <code><a href="fmean.html">fmean</a></code>, <code><a href="fmode.html">fmode</a></code>, <a href="fast-statistical-functions.html">Fast Statistical Functions</a>, <a href="index.html">Collapse Overview</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## default vector method</span></span></span>
<span class="r-in"><span><span class="va">mpg</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span></span></span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>                         <span class="co"># Simple nth element: Median (same as fmedian(mpg))</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19.2</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">5</span><span class="op">)</span>                      <span class="co"># 5th smallest element</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14.7</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">mpg</span>, partial <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>         <span class="co"># Same using base R, fnth is 2x faster.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14.7</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span><span class="op">)</span>                   <span class="co"># Third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 22.8</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, w <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>    <span class="co"># Weighted third quartile: Weighted by hp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20.47391</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>        <span class="co"># Simple transformation: Subtract third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  -1.8  -1.8   0.0  -1.4  -4.1  -4.7  -8.5   1.6   0.0  -3.6  -5.0  -6.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  -5.5  -7.6 -12.4 -12.4  -8.1   9.6   7.6  11.1  -1.3  -7.3  -7.6  -9.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  -3.6   4.5   3.2   7.6  -7.0  -3.1  -7.8  -1.4</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span>             <span class="co"># Grouped third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4     6     8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30.40 21.00 16.25 </span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">mtcars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>       <span class="co"># More groups..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4.0.1  4.1.0  4.1.1  6.0.1  6.1.0  8.0.0  8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.000 23.600 31.400 21.000 19.750 16.625 15.600 </span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="GRP.html">GRP</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="op">~</span> <span class="va">cyl</span> <span class="op">+</span> <span class="va">vs</span> <span class="op">+</span> <span class="va">am</span><span class="op">)</span>       <span class="co"># Precomputing groups gives more speed !</span></span></span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4.0.1  4.1.0  4.1.1  6.0.1  6.1.0  8.0.0  8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.000 23.600 31.400 21.000 19.750 16.625 15.600 </span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">g</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>           <span class="co"># Grouped weighted third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4.0.1    4.1.0    4.1.1    6.0.1    6.1.0    8.0.0    8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.00000 22.72258 30.40000 21.00000 19.56625 16.30937 15.46553 </span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">g</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>           <span class="co"># Groupwise subtract third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   0.000   0.000  -8.600   1.650   2.075  -1.650  -2.325   0.800  -0.800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10]  -0.550  -1.950  -0.225   0.675  -1.425  -6.225  -6.225  -1.925   1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  -1.000   2.500  -2.100  -1.125  -1.425  -3.325   2.575  -4.100   0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28]  -1.000   0.200  -1.300  -0.600 -10.000</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">g</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, <span class="st">"-"</span><span class="op">)</span>      <span class="co"># Groupwise subtract weighted third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.00000000  0.00000000 -7.60000000  1.83375000  2.39062500 -1.46625000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -2.00937500  1.67741935  0.07741935 -0.36625000 -1.76625000  0.09062500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  0.99062500 -1.10937500 -5.90937500 -5.90937500 -1.60937500  2.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  0.00000000  3.50000000 -1.22258065 -0.80937500 -1.10937500 -3.00937500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  2.89062500 -3.10000000  0.00000000  0.00000000  0.33446970 -1.30000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] -0.46553030 -9.00000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## data.frame method</span></span></span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    mpg    cyl   disp     hp   drat     wt   qsec     vs     am   gear   carb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22.80   8.00 326.00 180.00   3.92   3.61  18.90   1.00   1.00   4.00   4.00 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fnth</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">0.75</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl disp  hp  drat     wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         -1.8  -2 -166 -70 -0.02 -0.990 -2.44 -1  0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     -1.8  -2 -166 -70 -0.02 -0.735 -1.88 -1  0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         0.0  -4 -218 -87 -0.07 -1.290 -0.29  0  0    0   -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    -1.4  -2  -68 -70 -0.84 -0.395  0.54  0 -1   -1   -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -4.1   0   34  -5 -0.77 -0.170 -1.88 -1 -1   -1   -2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -4.7  -2 -101 -75 -1.16 -0.150  1.32  0 -1   -1   -3</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">0.75</span>, <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mpg cyl   disp     hp  drat     wt   qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 26.000   4 120.30  91.00 4.430 2.1400 16.700  0  1  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.0 23.600   4 143.75  96.00 3.810 3.1700 21.455  1  0  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.1 31.400   4 101.55 101.00 4.165 2.2600 19.185  1  1  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.0.1 21.000   6 160.00 142.50 3.900 2.8225 16.740  0  1  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.1.0 19.750   6 233.25 123.00 3.920 3.4450 19.635  1  0  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.0.0 16.625   8 410.00 218.75 3.165 4.3650 17.655  0  0  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span>, <span class="va">vs</span>, <span class="va">am</span><span class="op">)</span>, <span class="fl">0.75</span><span class="op">)</span>   <span class="co"># Another way of doing it..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am    mpg   disp     hp  drat     wt   qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.000 120.30  91.00 4.430 2.1400 16.700  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 23.600 143.75  96.00 3.810 3.1700 21.455  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 31.400 101.55 101.00 4.165 2.2600 19.185  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 21.000 160.00 142.50 3.900 2.8225 16.740  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 19.750 233.25 123.00 3.920 3.4450 19.635  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 16.625 410.00 218.75 3.165 4.3650 17.655  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">0.75</span>, <span class="va">g</span>, use.g.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>   <span class="co"># No row-names generated</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mpg cyl   disp     hp  drat     wt   qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 26.000   4 120.30  91.00 4.430 2.1400 16.700  0  1  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 23.600   4 143.75  96.00 3.810 3.1700 21.455  1  0  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 31.400   4 101.55 101.00 4.165 2.2600 19.185  1  1  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 21.000   6 160.00 142.50 3.900 2.8225 16.740  0  1  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 19.750   6 233.25 123.00 3.920 3.4450 19.635  1  0  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 16.625   8 410.00 218.75 3.165 4.3650 17.655  0  0  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## matrix method</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="quick-conversion.html">qM</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">m</span>, <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    mpg    cyl   disp     hp   drat     wt   qsec     vs     am   gear   carb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22.80   8.00 326.00 180.00   3.92   3.61  18.90   1.00   1.00   4.00   4.00 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fnth</span><span class="op">(</span><span class="va">m</span>, <span class="fl">0.75</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl disp  hp  drat     wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         -1.8  -2 -166 -70 -0.02 -0.990 -2.44 -1  0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     -1.8  -2 -166 -70 -0.02 -0.735 -1.88 -1  0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         0.0  -4 -218 -87 -0.07 -1.290 -0.29  0  0    0   -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    -1.4  -2  -68 -70 -0.84 -0.395  0.54  0 -1   -1   -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -4.1   0   34  -5 -0.77 -0.170 -1.88 -1 -1   -1   -2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -4.7  -2 -101 -75 -1.16 -0.150  1.32  0 -1   -1   -3</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">m</span>, <span class="fl">0.75</span>, <span class="va">g</span><span class="op">)</span> <span class="co"># etc..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mpg cyl   disp     hp  drat     wt   qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 26.000   4 120.30  91.00 4.430 2.1400 16.700  0  1  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.0 23.600   4 143.75  96.00 3.810 3.1700 21.455  1  0  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.1 31.400   4 101.55 101.00 4.165 2.2600 19.185  1  1  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.0.1 21.000   6 160.00 142.50 3.900 2.8225 16.740  0  1  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.1.0 19.750   6 233.25 123.00 3.920 3.4450 19.635  1  0  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.0.0 16.625   8 410.00 218.75 3.165 4.3650 17.655  0  0  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 1 row ]</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## grouped_df method</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cyl    vs    am   mpg  disp    hp  drat    wt  qsec  gear  carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     4     0     1  26    120.   91   4.43  2.14  16.7   5       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     4     1     0  23.6  144.   96   3.81  3.17  21.5   4       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     4     1     1  31.4  102.  101   4.16  2.26  19.2   4       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     6     0     1  21    160   142.  3.9   2.82  16.7   4.5     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     6     1     0  19.8  233.  123   3.92  3.44  19.6   4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>     8     0     0  16.6  410   219.  3.16  4.36  17.7   3       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span>     8     0     1  15.6  338.  317.  4.05  3.47  14.6   5       7</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span>, <span class="va">hp</span><span class="op">)</span>           <span class="co"># Weighted</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cyl    vs    am sum.hp   mpg  disp  drat    wt  qsec  gear  carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     4     0     1     91  26    120.  4.43  2.14  16.7  5     2   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     4     1     0    254  22.7  141.  3.85  3.15  21.9  4     2   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     4     1     1    564  30.4  110.  4.08  2.39  18.9  4.22  2   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     6     0     1    395  21    160   3.9   2.79  16.6  4.87  5.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     6     1     0    461  19.6  230.  3.92  3.44  19.5  4     4   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>     8     0     0   <span style="text-decoration: underline;">2</span>330  16.3  426.  3.21  4.80  17.7  3     4   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span>     8     0     1    599  15.5  330.  3.94  3.52  14.6  5     7.53</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span>              <span class="co"># Faster grouping!</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am    mpg   disp     hp  drat     wt   qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.000 120.30  91.00 4.430 2.1400 16.700  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 23.600 143.75  96.00 3.810 3.1700 21.455  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 31.400 101.55 101.00 4.165 2.2600 19.185  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 21.000 160.00 142.50 3.900 2.8225 16.740  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 19.750 233.25 123.00 3.920 3.4450 19.635  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 16.625 410.00 218.75 3.165 4.3650 17.655  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span>, TRA <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>   <span class="co"># Divide by third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   cyl vs am       mpg      disp        hp      drat        wt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           6  0  1 1.0000000 1.0000000 0.7719298 1.0000000 0.9282551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       6  0  1 1.0000000 1.0000000 0.7719298 1.0000000 1.0186005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710          4  1  1 0.7261146 1.0635155 0.9207921 0.9243697 1.0265487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      6  1  0 1.0835443 1.1061093 0.8943089 0.7857143 0.9332366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   8  0  0 1.1248120 0.8780488 0.8000000 0.9952607 0.7880871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             6  1  0 0.9164557 0.9646302 0.8536585 0.7040816 1.0043541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        qsec      gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         0.9832736 0.8888889 0.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     1.0167264 0.8888889 0.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        0.9700287 1.0000000 0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    0.9900688 0.7500000 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout 0.9640329 1.0000000 0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           1.0297937 0.7500000 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 26 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="select_replace_vars.html">fselect</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>    <span class="co"># Faster selecting</span></span></span>
<span class="r-in"><span>      <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span>, <span class="va">hp</span>, <span class="st">"/"</span><span class="op">)</span>  <span class="co"># Divide mpg by its third weighted group-quartile, using hp as weights</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      hp       mpg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           110 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       110 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710           93 0.7500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      110 1.0937201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   175 1.1465798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             105 0.9250623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Duster 360          245 0.8767963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 240D            62 1.0738217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 230             95 1.0034072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280            123 0.9812815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280C           123 0.9097298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SE          180 1.0055566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SL          180 1.0607396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SLC         180 0.9319793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cadillac Fleetwood  205 0.6376701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lincoln Continental 215 0.6376701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chrysler Imperial   230 0.9013221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat 128             66 1.0657895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honda Civic          52 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corolla       65 1.1151316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corona        97 0.9461953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dodge Challenger    150 0.9503736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMC Javelin         150 0.9319793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Camaro Z28          245 0.8154819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pontiac Firebird    175 1.1772370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat X1-9            66 0.8980263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Porsche 914-2        91 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lotus Europa        113 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ford Pantera L      264 1.0216268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ferrari Dino        175 0.9380952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maserati Bora       335 0.9698988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Volvo 142E          109 0.7039474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Efficient grouped estimation of multiple quantiles</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ftransform.html">fmutate</a></span><span class="op">(</span>o <span class="op">=</span> <span class="fu"><a href="radixorder.html">radixorder</a></span><span class="op">(</span><span class="fu"><a href="GRP.html">GRPid</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="fsummarise.html">fsummarise</a></span><span class="op">(</span>mpg_Q1 <span class="op">=</span> <span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.25</span>, o <span class="op">=</span> <span class="va">o</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               mpg_median <span class="op">=</span> <span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, o <span class="op">=</span> <span class="va">o</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               mpg_Q3 <span class="op">=</span> <span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, o <span class="op">=</span> <span class="va">o</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am mpg_Q1 mpg_median mpg_Q3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.000      26.00 26.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 22.150      22.80 23.600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 25.050      30.40 31.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 20.350      21.00 21.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 18.025      18.65 19.750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 14.050      15.20 16.625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   8  0  1 15.200      15.40 15.600</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fmedian()</span></span></span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>                         <span class="co"># Simple median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19.2</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, w <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>          <span class="co"># Weighted median: Weighted by hp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 16.4</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>              <span class="co"># Simple transformation: Subtract median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1.8  1.8  3.6  2.2 -0.5 -1.1 -4.9  5.2  3.6  0.0 -1.4 -2.8 -1.9 -4.0 -8.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] -8.8 -4.5 13.2 11.2 14.7  2.3 -3.7 -4.0 -5.9  0.0  8.1  6.8 11.2 -3.4  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] -4.2  2.2</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span>             <span class="co"># Grouped median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4    6    8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.0 19.7 15.2 </span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">mtcars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>       <span class="co"># More groups..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 4.1.0 4.1.1 6.0.1 6.1.0 8.0.0 8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.00 22.80 30.40 21.00 18.65 15.20 15.40 </span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 4.1.0 4.1.1 6.0.1 6.1.0 8.0.0 8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.00 22.80 30.40 21.00 18.65 15.20 15.40 </span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">g</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>           <span class="co"># Grouped weighted median</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 4.1.0 4.1.1 6.0.1 6.1.0 8.0.0 8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  26.0  22.8  30.4  21.0  19.2  15.2  15.0 </span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">g</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>           <span class="co"># Groupwise subtract median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.00  0.00 -7.60  2.75  3.50 -0.55 -0.90  1.60  0.00  0.55 -0.85  1.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  2.10  0.00 -4.80 -4.80 -0.50  2.00  0.00  3.50 -1.30  0.30  0.00 -1.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  4.00 -3.10  0.00  0.00  0.40 -1.30 -0.40 -9.00</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">g</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, <span class="st">"-"</span><span class="op">)</span>      <span class="co"># Groupwise subtract weighted median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.0  0.0 -7.6  2.2  3.5 -1.1 -0.9  1.6  0.0  0.0 -1.4  1.2  2.1  0.0 -4.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] -4.8 -0.5  2.0  0.0  3.5 -1.3  0.3  0.0 -1.9  4.0 -3.1  0.0  0.0  0.8 -1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31]  0.0 -9.0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## data.frame method</span></span></span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mpg     cyl    disp      hp    drat      wt    qsec      vs      am    gear </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  19.200   6.000 196.300 123.000   3.695   3.325  17.710   0.000   0.000   4.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    carb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.000 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mtcars</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl  disp  hp   drat     wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4          1.8   0 -36.3 -13  0.205 -0.705 -1.25  0  1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag      1.8   0 -36.3 -13  0.205 -0.450 -0.69  0  1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         3.6  -2 -88.3 -30  0.155 -1.005  0.90  1  1    0   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive     2.2   0  61.7 -13 -0.615 -0.110  1.73  1  0   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -0.5   2 163.7  52 -0.545  0.115 -0.69  0  0   -1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -1.1   0  28.7 -18 -0.935  0.135  2.51  1  0   -1   -1</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mpg cyl  disp    hp  drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 26.00   4 120.3  91.0 4.430 2.140 16.70  0  1  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.0 22.80   4 140.8  95.0 3.700 3.150 20.01  1  0  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.1 30.40   4  79.0  66.0 4.080 1.935 18.61  1  1  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.0.1 21.00   6 160.0 110.0 3.900 2.770 16.46  0  1  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.1.0 18.65   6 196.3 116.5 3.500 3.440 19.17  1  0  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.0.0 15.20   8 355.0 180.0 3.075 3.810 17.35  0  0  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span>, <span class="va">vs</span>, <span class="va">am</span><span class="op">)</span><span class="op">)</span>   <span class="co"># Another way of doing it..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am   mpg  disp    hp  drat    wt  qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.00 120.3  91.0 4.430 2.140 16.70  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 22.80 140.8  95.0 3.700 3.150 20.01  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 30.40  79.0  66.0 4.080 1.935 18.61  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 21.00 160.0 110.0 3.900 2.770 16.46  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 18.65 196.3 116.5 3.500 3.440 19.17  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 15.20 355.0 180.0 3.075 3.810 17.35  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">g</span>, use.g.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>   <span class="co"># No row-names generated</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mpg cyl  disp    hp  drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 26.00   4 120.3  91.0 4.430 2.140 16.70  0  1  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 22.80   4 140.8  95.0 3.700 3.150 20.01  1  0  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 30.40   4  79.0  66.0 4.080 1.935 18.61  1  1  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 21.00   6 160.0 110.0 3.900 2.770 16.46  0  1  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 18.65   6 196.3 116.5 3.500 3.440 19.17  1  0  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 15.20   8 355.0 180.0 3.075 3.810 17.35  0  0  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## matrix method</span></span></span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mpg     cyl    disp      hp    drat      wt    qsec      vs      am    gear </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  19.200   6.000 196.300 123.000   3.695   3.325  17.710   0.000   0.000   4.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    carb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.000 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fmedian</span><span class="op">(</span><span class="va">m</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl  disp  hp   drat     wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4          1.8   0 -36.3 -13  0.205 -0.705 -1.25  0  1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag      1.8   0 -36.3 -13  0.205 -0.450 -0.69  0  1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         3.6  -2 -88.3 -30  0.155 -1.005  0.90  1  1    0   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive     2.2   0  61.7 -13 -0.615 -0.110  1.73  1  0   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -0.5   2 163.7  52 -0.545  0.115 -0.69  0  0   -1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -1.1   0  28.7 -18 -0.935  0.135  2.51  1  0   -1   -1</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">m</span>, <span class="va">g</span><span class="op">)</span> <span class="co"># etc..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mpg cyl  disp    hp  drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 26.00   4 120.3  91.0 4.430 2.140 16.70  0  1  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.0 22.80   4 140.8  95.0 3.700 3.150 20.01  1  0  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.1 30.40   4  79.0  66.0 4.080 1.935 18.61  1  1  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.0.1 21.00   6 160.0 110.0 3.900 2.770 16.46  0  1  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.1.0 18.65   6 196.3 116.5 3.500 3.440 19.17  1  0  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.0.0 15.20   8 355.0 180.0 3.075 3.810 17.35  0  0  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 1 row ]</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># grouped_df method</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fmedian</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cyl    vs    am   mpg  disp    hp  drat    wt  qsec  gear  carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     4     0     1  26    120.   91   4.43  2.14  16.7   5     2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     4     1     0  22.8  141.   95   3.7   3.15  20.0   4     2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     4     1     1  30.4   79    66   4.08  1.94  18.6   4     1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     6     0     1  21    160   110   3.9   2.77  16.5   4     4  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     6     1     0  18.6  196.  116.  3.5   3.44  19.2   3.5   2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>     8     0     0  15.2  355   180   3.08  3.81  17.4   3     3  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span>     8     0     1  15.4  326   300.  3.88  3.37  14.6   5     6  </span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fmedian</span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>             <span class="co"># Weighted</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cyl    vs    am sum.hp   mpg  disp  drat    wt  qsec  gear  carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     4     0     1     91  26   120.   4.43  2.14  16.7     5     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     4     1     0    254  22.8 141.   3.7   3.15  20.0     4     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     4     1     1    564  30.4  95.1  4.08  1.94  18.6     4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     6     0     1    395  21   160    3.9   2.77  16.5     4     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     6     1     0    461  19.2 168.   3.92  3.44  18.9     4     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>     8     0     0   <span style="text-decoration: underline;">2</span>330  15.2 360    3.08  3.84  17.4     3     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span>     8     0     1    599  15   301    3.54  3.57  14.6     5     8</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fmedian</span><span class="op">(</span><span class="op">)</span>              <span class="co"># Faster grouping!</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am   mpg  disp    hp  drat    wt  qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.00 120.3  91.0 4.430 2.140 16.70  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 22.80 140.8  95.0 3.700 3.150 20.01  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 30.40  79.0  66.0 4.080 1.935 18.61  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 21.00 160.0 110.0 3.900 2.770 16.46  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 18.65 196.3 116.5 3.500 3.440 19.17  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 15.20 355.0 180.0 3.075 3.810 17.35  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fmedian</span><span class="op">(</span>TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>     <span class="co"># De-median</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   cyl vs am   mpg disp    hp   drat     wt  qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           6  0  1  0.00  0.0   0.0  0.000 -0.150  0.00  0.0  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       6  0  1  0.00  0.0   0.0  0.000  0.105  0.56  0.0  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710          4  1  1 -7.60 29.0  27.0 -0.230  0.385  0.00  0.0  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      6  1  0  2.75 61.7  -6.5 -0.420 -0.225  0.27 -0.5 -1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   8  0  0  3.50  5.0  -5.0  0.075 -0.370 -0.33  0.0 -1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             6  1  0 -0.55 28.7 -11.5 -0.740  0.020  1.05 -0.5 -1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 26 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="select_replace_vars.html">fselect</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>   <span class="co"># Faster selecting</span></span></span>
<span class="r-in"><span>      <span class="fu">fmedian</span><span class="op">(</span><span class="va">hp</span>, <span class="st">"-"</span><span class="op">)</span>  <span class="co"># Weighted de-median mpg, using hp as weights</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      hp  mpg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           110  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       110  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710           93 -7.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      110  2.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   175  3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             105 -1.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Duster 360          245 -0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 240D            62  1.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 230             95  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280            123  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280C           123 -1.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SE          180  1.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SL          180  2.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SLC         180  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cadillac Fleetwood  205 -4.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lincoln Continental 215 -4.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chrysler Imperial   230 -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat 128             66  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honda Civic          52  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corolla       65  3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corona        97 -1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dodge Challenger    150  0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMC Javelin         150  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Camaro Z28          245 -1.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pontiac Firebird    175  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat X1-9            66 -3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Porsche 914-2        91  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lotus Europa        113  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ford Pantera L      264  0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ferrari Dino        175 -1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maserati Bora       335  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Volvo 142E          109 -9.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

