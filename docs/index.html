<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced and Fast Data Transformation in R • collapse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Advanced and Fast Data Transformation in R">
<meta property="og:description" content="A C/C++ based package for advanced data transformation and
    statistical computing in R that is extremely fast, flexible and
    parsimonious to code with, class-agnostic and programmer friendly.
    It is well integrated with base R, dplyr / (grouped) tibble,
    data.table, plm (panel-series and data frames), sf data frames, and
    non-destructively handles other matrix or data frame based classes (such as
    ts, xts / zoo, timeSeries, tsibble, tibbletime etc.)
    --- Key Features: ---
    (1) Advanced statistical programming: A full set of fast statistical functions
        supporting grouped and weighted computations on vectors, matrices and
        data frames. Fast and programmable grouping, ordering, unique values / rows,
        factor generation and interactions. Fast and flexible functions for data
        manipulation and data object conversions.
    (2) Advanced aggregation: Fast and easy multi-data-type, multi-function,
        weighted, parallelized and fully customized data aggregation.
    (3) Advanced transformations: Fast row / column arithmetic, (grouped) replacing
        and sweeping out of statistics, (grouped, weighted) scaling / standardizing,
        between (averaging) and (quasi-)within (centering / demeaning) transformations,
        higher-dimensional centering (i.e. multiple fixed effects transformations),
        linear prediction / partialling-out, linear model fitting and testing.
    (4) Advanced time-computations: Fast (sequences of) lags / leads, and
        (lagged / leaded, iterated, quasi-, log-) differences, (compounded)
        growth rates, and cumulative sums on (unordered, irregular) time series and
        panel data. Multivariate auto-, partial- and cross-correlation functions for panel data.
        Panel data to (ts-)array conversions.
    (5) List processing: (Recursive) list search / identification, splitting,
        extraction / subsetting, data-apply, and generalized recursive
        row-binding / unlisting in 2D.
    (6) Advanced data exploration: Fast (grouped, weighted, panel-decomposed)
        summary statistics for complex multilevel / panel data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Documentation</a>
</li>
<li>
  <a href="articles/index.html">Vignettes</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li id="bloglink">
  <a href="https://sebkrantz.github.io/Rblog/" target="_blank">Blog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/collapse_R" target="_blank">
    <span class="fa fa-twitter"></span>

  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" target="_blank">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div id="collapse-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#collapse-" class="anchor"></a>collapse <img src="collapse_logo_small.png" width="150px" align="right">
</h1></div>
<!-- badges: start -->

<p><em>collapse</em> is a C/C++ based package for data transformation and statistical computing in R. It’s aims are:</p>
<ul>
<li>To facilitate complex data transformation, exploration and computing tasks in R.</li>
<li>To help make R code fast, flexible, parsimonious and programmer friendly.</li>
</ul>
<p>It further implements a class-agnostic approach to data manipulation in R, supporting base R, <em>dplyr</em> (<em>tibble</em>), <em>data.table</em>, <em>sf</em>, <em>plm</em> classes for panel data (‘pseries’ and ‘pdata.frame’), and non-destructively handling other matrix or data frame based classes (including most time series classes such as ‘ts’, ‘xts’ / ‘zoo’, ‘timeSeries’, ‘tsibble’, ‘tibbletime’, etc.).</p>
<!-- *collapse* thus provides a robust, flexible, class-agnostic and computationally advanced toolkit for data manipulation in R. -->
<!-- Core functions are implicit-type generic and attribute preserving, supporting other matrix or data frame based classes e.g. time series (*ts*, *xts* / *zoo*, *timeSeries* etc.), *sf* data frames etc. -->
<p><strong>Key Features:</strong></p>
<ul>
<li><p><strong>Advanced statistical programming</strong>: A full set of fast statistical functions supporting grouped and weighted computations on vectors, matrices and data frames. Fast and programmable grouping, ordering, unique values / rows, factor generation and interactions. Fast and flexible functions for data manipulation and data object conversions.</p></li>
<li><p><strong>Advanced aggregation</strong>: Fast and easy multi-data-type, multi-function, weighted, parallelized and fully customized data aggregation.</p></li>
<li><p><strong>Advanced transformations</strong>: Fast row / column arithmetic, (grouped) replacing and sweeping out of statistics, (grouped, weighted) scaling / standardizing, between (averaging) and (quasi-)within (centering / demeaning) transformations, higher-dimensional centering (i.e. multiple fixed effects transformations), linear prediction / partialling-out, linear model fitting and testing.</p></li>
<li><p><strong>Advanced time-computations</strong>: Fast (sequences of) lags / leads, and (lagged / leaded, iterated, quasi-, log-) differences, (compounded) growth rates and cumulative sums on (unordered, irregular) time series and panel data. Multivariate auto-, partial- and cross-correlation functions for panel data. Panel data to (ts-)array conversions.</p></li>
<li><p><strong>List processing</strong>: (Recursive) list search / identification, splitting, extraction / subsetting, data-apply, and generalized recursive row-binding / unlisting in 2D.</p></li>
<li><p><strong>Advanced data exploration</strong>: Fast (grouped, weighted, panel-decomposed) summary statistics for complex multilevel / panel data.</p></li>
</ul>
<p><em>collapse</em> is mainly coded in C++ and built with <em>Rcpp</em>, but also uses C/C++ functions from <em>data.table</em>, <em>fixest</em>, <em>weights</em>, <em>RcppArmadillo</em>, <em>RcppEigen</em> and <em>stats</em>. Currently no low-level parallelism is implemented. Effort has been expended to minimize the execution speed of R code employed.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># Install the current version on CRAN</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"collapse"</span><span class="op">)</span>

<span class="co"># Install a previous version from the CRAN Archive (Requires Rtools)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"https://cran.r-project.org/src/contrib/Archive/collapse/collapse_1.5.3.tar.gz"</span>, repos <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span>

<span class="co"># Install a stable development version from Github (Requires Rtools)</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"SebKrantz/collapse"</span><span class="op">)</span></pre></div>
<!--
# install the development version
devtools::install_github("SebKrantz/collapse")
-->
</div>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h2>
<p><em>collapse</em> installs with a built-in structured <a href="https://sebkrantz.github.io/collapse/reference/index.html">documentation</a>, implemented via a set of separate help pages. Calling <code><a href="reference/index.html">help('collapse-documentation')</a></code> from the R console brings up the the top-level documentation page, which provides an overview of the entire functionality of the package and links to all other documentation pages.</p>
<p>In addition, <em>collapse</em> provides 5 vignettes (available online):</p>
<ul>
<li><p><a href="https://sebkrantz.github.io/collapse/articles/collapse_intro.html"><strong>Introduction to <em>collapse</em></strong></a>: Introduces all main features of the package in a structured way.</p></li>
<li><p><a href="https://sebkrantz.github.io/collapse/articles/collapse_and_dplyr.html"><strong><em>collapse</em> and <em>dplyr</em></strong></a>: Demonstrates the integration of <em>collapse</em> with <em>dplyr</em> / <em>tidyverse</em> workflows and associated performance improvements.</p></li>
<li><p><a href="https://sebkrantz.github.io/collapse/articles/collapse_and_plm.html"><strong><em>collapse</em> and <em>plm</em></strong></a>: Demonstrates the integration of <em>collapse</em> with the <em>plm</em> package and provides examples of fast and easy programming with panel data.</p></li>
<li><p><a href="https://sebkrantz.github.io/collapse/articles/collapse_and_data.table.html"><strong><em>collapse</em> and <em>data.table</em></strong></a>: Shows how <em>collapse</em> and <em>data.table</em> may be used together in a harmonious way.</p></li>
<li><p><a href="https://sebkrantz.github.io/collapse/articles/collapse_and_sf.html"><strong><em>collapse</em> and <em>sf</em></strong></a>: Shows how collapse can be used to efficiently manipulate <em>sf</em> data frames.</p></li>
</ul>
<div id="cheatsheet" class="section level3">
<h3 class="hasAnchor">
<a href="#cheatsheet" class="anchor"></a>Cheatsheet</h3>
<p><a href="https://raw.githubusercontent.com/SebKrantz/cheatsheets/master/collapse.pdf"><img src="https://raw.githubusercontent.com/SebKrantz/cheatsheets/master/pngs/collapse.png" width="330" height="227"></a> <!-- 294 --></p>
</div>
</div>
<div id="example-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#example-usage" class="anchor"></a>Example Usage</h2>
<p>This provides a simple set of examples introducing some important features of <em>collapse</em>. It should be easy to follow for readers familiar with R.</p>
<details><p><summary><b><a style="cursor: pointer;">Click here to expand </a></b> </summary></p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sebkrantz.github.io/collapse/">collapse</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span>            <span class="co"># iris dataset in base R</span>
<span class="va">v</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span>  <span class="co"># Vector</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">num_vars</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>     <span class="co"># Saving numeric variables (could also be a matrix, statistical functions are S3 generic)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>       <span class="co"># Grouping variable (could also be a list of variables)</span>

<span class="co">## Advanced Statistical Programming -----------------------------------------------------------------------------</span>

<span class="co"># Simple (column-wise) statistics...</span>
<span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>                       <span class="co"># Vector</span>
<span class="fu"><a href="reference/fvar,%20fsd.html">fsd</a></span><span class="op">(</span><span class="fu"><a href="reference/quick-conversion.html">qM</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span>                       <span class="co"># Matrix (qM is a faster as.matrix)</span>
<span class="fu"><a href="reference/fmode.html">fmode</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>                         <span class="co"># data.frame</span>
<span class="fu"><a href="reference/fmean.html">fmean</a></span><span class="op">(</span><span class="fu"><a href="reference/quick-conversion.html">qM</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>       <span class="co"># Still a matrix</span>
<span class="fu"><a href="reference/fmin,%20fmax.html">fmax</a></span><span class="op">(</span><span class="va">d</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>            <span class="co"># Still a data.frame</span>

<span class="co"># Fast grouped and/or weighted statistics</span>
<span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="reference/small-helper.html">fnrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">d</span>, w <span class="op">=</span> <span class="va">w</span><span class="op">)</span>                 <span class="co"># Simple weighted statistics</span>
<span class="fu"><a href="reference/fnth.html">fnth</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">0.75</span>, <span class="va">g</span><span class="op">)</span>                  <span class="co"># Grouped statistics (grouped third quartile)</span>
<span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span><span class="op">)</span>                  <span class="co"># Groupwise-weighted statistics</span>
<span class="fu"><a href="reference/fvar,%20fsd.html">fsd</a></span><span class="op">(</span><span class="va">v</span>, <span class="va">g</span>, <span class="va">w</span><span class="op">)</span>                      <span class="co"># Similarly for vectors</span>
<span class="fu"><a href="reference/fmode.html">fmode</a></span><span class="op">(</span><span class="fu"><a href="reference/quick-conversion.html">qM</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="va">g</span>, <span class="va">w</span>, ties <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span>  <span class="co"># Or matrices (grouped and weighted maximum mode) ...</span>

<span class="co"># A fast set of data manipulation functions allows complex piped programming at high speeds</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>                            <span class="co"># Pipe operators</span>
<span class="va">iris</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/GRP,%20fgroup_by.html">fgroup_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">fndistinct</span>   <span class="co"># Grouped distinct value counts</span>
<span class="va">iris</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/GRP,%20fgroup_by.html">fgroup_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>   <span class="co"># Weighted group medians </span>
<span class="va">iris</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">add_vars</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">%&gt;%</span>                     <span class="co"># Adding weight vector to dataset</span>
  <span class="fu"><a href="reference/fsubset.html">fsubset</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">&lt;</span> <span class="fu"><a href="reference/fmean.html">fmean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span>, <span class="va">Species</span>, <span class="va">Sepal.Width</span><span class="op">:</span><span class="va">w</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Fast selecting and subsetting</span>
  <span class="fu"><a href="reference/GRP,%20fgroup_by.html">fgroup_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">%&gt;%</span>                     <span class="co"># Grouping (efficiently creates a grouped tibble)</span>
  <span class="fu"><a href="reference/fvar,%20fsd.html">fvar</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">%&gt;%</span>                                <span class="co"># Frequency-weighted group-variance, default (keep.w = TRUE)  </span>
  <span class="fu"><a href="reference/roworder.html">roworder</a></span><span class="op">(</span><span class="va">sum.w</span><span class="op">)</span>                            <span class="co"># also saves group weights in a column called 'sum.w'</span>

<span class="co"># Can also use dplyr (but dplyr manipulation verbs are a lot slower)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">iris</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">add_vars</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">&lt;</span> <span class="fu"><a href="reference/fmean.html">fmean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Species</span>, <span class="va">Sepal.Width</span><span class="op">:</span><span class="va">w</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/fvar,%20fsd.html">fvar</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">sum.w</span><span class="op">)</span>

<span class="co">## Advanced Aggregation -----------------------------------------------------------------------------------------</span>

<span class="fu"><a href="reference/collap.html">collap</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">Sepal.Length</span> <span class="op">+</span> <span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Species</span>, <span class="va">fmean</span><span class="op">)</span>  <span class="co"># Simple aggregation using the mean..</span>
<span class="fu"><a href="reference/collap.html">collap</a></span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">fmean</span>, <span class="va">fmedian</span>, <span class="va">fmode</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Multiple functions applied to each column</span>
<span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">add_vars</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">w</span>                                        <span class="co"># Adding weights, return in long format..</span>
<span class="fu"><a href="reference/collap.html">collap</a></span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">fmean</span>, <span class="va">fmedian</span>, <span class="va">fmode</span><span class="op">)</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">w</span>, return <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span>

<span class="co"># Generate some additional logical data</span>
<span class="fu"><a href="reference/ftransform.html">settransform</a></span><span class="op">(</span><span class="va">iris</span>, AWMSL <span class="op">=</span> <span class="va">Sepal.Length</span> <span class="op">&gt;</span> <span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, w <span class="op">=</span> <span class="va">w</span><span class="op">)</span>,
                   AWMSW <span class="op">=</span> <span class="va">Sepal.Width</span> <span class="op">&gt;</span> <span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">Sepal.Width</span>, w <span class="op">=</span> <span class="va">w</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Multi-type data aggregation: catFUN applies to all categorical columns (here AMWSW)</span>
<span class="fu"><a href="reference/collap.html">collap</a></span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">AWMSL</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">fmean</span>, <span class="va">fmedian</span>, <span class="va">fmode</span><span class="op">)</span>,
       catFUN <span class="op">=</span> <span class="va">fmode</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">w</span>, return <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span>

<span class="co"># Custom aggregation gives the greatest possible flexibility: directly mapping functions to columns</span>
<span class="fu"><a href="reference/collap.html">collap</a></span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">AWMSL</span>,
       custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, fsd <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, fmode <span class="op">=</span> <span class="st">"AWMSL"</span><span class="op">)</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">w</span>,
       wFUN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">fsum</span>, <span class="va">fmin</span>, <span class="va">fmax</span><span class="op">)</span>, <span class="co"># Here also aggregating the weight vector with 3 different functions</span>
       keep.col.order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>        <span class="co"># Column order not maintained -&gt; grouping and weight variables first</span>

<span class="co"># Can also use grouped tibble: weighted median for numeric, weighted mode for categorical columns</span>
<span class="va">iris</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/GRP,%20fgroup_by.html">fgroup_by</a></span><span class="op">(</span><span class="va">Species</span>, <span class="va">AWMSL</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/collap.html">collapg</a></span><span class="op">(</span><span class="va">fmedian</span>, <span class="va">fmode</span>, w <span class="op">=</span> <span class="va">w</span><span class="op">)</span>

<span class="co">## Advanced Transformations -------------------------------------------------------------------------------------</span>

<span class="co"># All Fast Statistical Functions have a TRA argument, supporting 10 different replacing and sweeping operations</span>
<span class="fu"><a href="reference/fmode.html">fmode</a></span><span class="op">(</span><span class="va">d</span>, TRA <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span>     <span class="co"># Replacing values with the mode</span>
<span class="fu"><a href="reference/fvar,%20fsd.html">fsd</a></span><span class="op">(</span><span class="va">v</span>, TRA <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>             <span class="co"># dividing by the overall standard deviation (scaling)</span>
<span class="fu"><a href="reference/fsum.html">fsum</a></span><span class="op">(</span><span class="va">d</span>, TRA <span class="op">=</span> <span class="st">"%"</span><span class="op">)</span>            <span class="co"># Computing percentages</span>
<span class="fu"><a href="reference/fvar,%20fsd.html">fsd</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, TRA <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>          <span class="co"># Grouped scaling</span>
<span class="fu"><a href="reference/fmin,%20fmax.html">fmin</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>         <span class="co"># Setting the minimum value in each species to 0</span>
<span class="fu"><a href="reference/ffirst,%20flast.html">ffirst</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, TRA <span class="op">=</span> <span class="st">"%%"</span><span class="op">)</span>      <span class="co"># Taking modulus of first value in each species</span>
<span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span>, <span class="st">"-"</span><span class="op">)</span>         <span class="co"># Groupwise centering by the weighted median</span>
<span class="fu"><a href="reference/fnth.html">fnth</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">0.95</span>, <span class="va">g</span>, <span class="va">w</span>, <span class="st">"%"</span><span class="op">)</span>      <span class="co"># Expressing data in percentages of the weighted species-wise 95th percentile</span>
<span class="fu"><a href="reference/fmode.html">fmode</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span>, <span class="st">"replace"</span>,     <span class="co"># Replacing data by the species-wise weighted minimum-mode</span>
      ties <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span>

<span class="co"># TRA() can also be called directly to replace or sweep with a matching set of computed statistics</span>
<span class="fu"><a href="reference/TRA.html">TRA</a></span><span class="op">(</span><span class="va">v</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>, <span class="st">"/"</span><span class="op">)</span>                       <span class="co"># Same as fsd(v, TRA = "/")</span>
<span class="fu"><a href="reference/TRA.html">TRA</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="va">g</span><span class="op">)</span>         <span class="co"># Same as fmedian(d, g, w, "-")</span>
<span class="fu"><a href="reference/TRA.html">TRA</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="reference/BY.html">BY</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">quantile</span>, <span class="fl">0.95</span><span class="op">)</span>, <span class="st">"%"</span>, <span class="va">g</span><span class="op">)</span> <span class="co"># Same as fnth(d, 0.95, g, TRA = "%") (apart from quantile algorithm)</span>

<span class="co"># For common uses, there are some faster and more advanced functions</span>
<span class="fu"><a href="reference/fbetween,%20fwithin.html">fbetween</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span><span class="op">)</span>                           <span class="co"># Grouped averaging [same as fmean(d, g, TRA = "replace") but faster]</span>
<span class="fu"><a href="reference/fbetween,%20fwithin.html">fwithin</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span><span class="op">)</span>                            <span class="co"># Grouped centering [same as fmean(d, g, TRA = "-") but faster]</span>
<span class="fu"><a href="reference/fbetween,%20fwithin.html">fwithin</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span><span class="op">)</span>                         <span class="co"># Grouped and weighted centering [same as fmean(d, g, w, "-")]</span>
<span class="fu"><a href="reference/fbetween,%20fwithin.html">fwithin</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span>, theta <span class="op">=</span> <span class="fl">0.76</span><span class="op">)</span>           <span class="co"># Quasi-centering i.e. d - theta*fbetween(d, g, w)</span>
<span class="fu"><a href="reference/fbetween,%20fwithin.html">fwithin</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span>, mean <span class="op">=</span> <span class="st">"overall.mean"</span><span class="op">)</span>  <span class="co"># Preserving the overall weighted mean of the data</span>

<span class="fu"><a href="reference/fscale.html">fscale</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>                                <span class="co"># Scaling and centering (default mean = 0, sd = 1)</span>
<span class="fu"><a href="reference/fscale.html">fscale</a></span><span class="op">(</span><span class="va">d</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>              <span class="co"># Custom scaling and centering</span>
<span class="fu"><a href="reference/fscale.html">fscale</a></span><span class="op">(</span><span class="va">d</span>, mean <span class="op">=</span> <span class="cn">FALSE</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>          <span class="co"># Mean preserving scaling</span>
<span class="fu"><a href="reference/fscale.html">fscale</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span><span class="op">)</span>                          <span class="co"># Grouped and weighted scaling and centering</span>
<span class="fu"><a href="reference/fscale.html">fscale</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">g</span>, <span class="va">w</span>, mean <span class="op">=</span> <span class="st">"overall.mean"</span>,   <span class="co"># Setting group means to overall weighted mean,</span>
       sd <span class="op">=</span> <span class="st">"within.sd"</span><span class="op">)</span>                 <span class="co"># and group sd's to fsd(fwithin(d, g, w), w = w)</span>

<span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">get_vars</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>                      <span class="co"># Use get_vars for fast selecting data.frame columns, gv is shortcut</span>
<span class="fu"><a href="reference/fhdbetween,%20fhdwithin.html">fhdbetween</a></span><span class="op">(</span><span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">gv</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">gv</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="co"># Linear prediction with factors and continuous covariates</span>
<span class="fu"><a href="reference/fhdbetween,%20fhdwithin.html">fhdwithin</a></span><span class="op">(</span><span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">gv</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">gv</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Linear partialling out factors and continuous covariates</span>

<span class="co"># This again opens up new possibilities for data manipulation...</span>
<span class="va">iris</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/ftransform.html">ftransform</a></span><span class="op">(</span>ASWMSL <span class="op">=</span> <span class="va">Sepal.Length</span> <span class="op">&gt;</span> <span class="fu"><a href="reference/fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Species</span>, <span class="va">w</span>, <span class="st">"replace"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/GRP,%20fgroup_by.html">fgroup_by</a></span><span class="op">(</span><span class="va">ASWMSL</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/collap.html">collapg</a></span><span class="op">(</span>w <span class="op">=</span> <span class="va">w</span>, keep.col.order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">iris</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/GRP,%20fgroup_by.html">fgroup_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">num_vars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/fbetween,%20fwithin.html">fwithin</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>  <span class="co"># Weighted demeaning</span>


<span class="co">## Time Series and Panel Series ---------------------------------------------------------------------------------</span>

<span class="fu"><a href="reference/flag.html">flag</a></span><span class="op">(</span><span class="va">AirPassengers</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>                      <span class="co"># A sequence of lags and leads</span>
<span class="va">EuStockMarkets</span> <span class="op">%&gt;%</span>                             <span class="co"># A sequence of first and second seasonal differences</span>
  <span class="fu"><a href="reference/fdiff.html">fdiff</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html">frequency</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="reference/fdiff.html">fdiff</a></span><span class="op">(</span><span class="va">EuStockMarkets</span>, rho <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>              <span class="co"># Quasi-difference [x - rho*flag(x)]</span>
<span class="fu"><a href="reference/fdiff.html">fdiff</a></span><span class="op">(</span><span class="va">EuStockMarkets</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>              <span class="co"># Log-difference [log(x/flag(x))]</span>
<span class="va">EuStockMarkets</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/fgrowth.html">fgrowth</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/time.html">frequency</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ordinary and seasonal growth rate</span>
<span class="va">EuStockMarkets</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/fgrowth.html">fgrowth</a></span><span class="op">(</span>logdiff <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>     <span class="co"># Log-difference growth rate [log(x/flag(x))*100]</span>

<span class="co"># Creating panel data</span>
<span class="va">pdata</span> <span class="op">&lt;-</span> <span class="va">EuStockMarkets</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`A` <span class="op">=</span> <span class="va">.</span>, `B` <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
         <span class="fu"><a href="reference/unlist2d.html">unlist2d</a></span><span class="op">(</span>idcols <span class="op">=</span> <span class="st">"Id"</span>, row.names <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span>

<span class="fu"><a href="reference/flag.html">L</a></span><span class="op">(</span><span class="va">pdata</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">~</span><span class="va">Id</span>, <span class="op">~</span><span class="va">Time</span><span class="op">)</span>                   <span class="co"># Sequence of fully identified panel-lags (L is operator for flag) </span>
<span class="va">pdata</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/GRP,%20fgroup_by.html">fgroup_by</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/flag.html">flag</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">Time</span><span class="op">)</span> <span class="co"># Same thing..</span>

<span class="co"># collapse supports pseries and pdata.frame's, provided by the plm package</span>
<span class="va">pdata</span> <span class="op">&lt;-</span> <span class="fu">plm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pdata.frame.html">pdata.frame</a></span><span class="op">(</span><span class="va">pdata</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Id"</span>, <span class="st">"Time"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/flag.html">L</a></span><span class="op">(</span><span class="va">pdata</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>          <span class="co"># Same as above, ...</span>
<span class="fu"><a href="reference/psacf.html">psacf</a></span><span class="op">(</span><span class="va">pdata</span><span class="op">)</span>            <span class="co"># Multivariate panel-ACF</span>
<span class="fu"><a href="reference/psmat.html">psmat</a></span><span class="op">(</span><span class="va">pdata</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">plot</span>   <span class="co"># 3D-array of time series from panel data + plotting</span>

<span class="fu"><a href="reference/fhdbetween,%20fhdwithin.html">HDW</a></span><span class="op">(</span><span class="va">pdata</span><span class="op">)</span>              <span class="co"># This projects out id and time fixed effects.. (HDW is operator for fhdwithin)</span>
<span class="fu"><a href="reference/fbetween,%20fwithin.html">W</a></span><span class="op">(</span><span class="va">pdata</span>, effect <span class="op">=</span> <span class="st">"Id"</span><span class="op">)</span> <span class="co"># Only Id effects.. (W is operator for fwithin)</span>

<span class="co">## List Processing ----------------------------------------------------------------------------------------------</span>

<span class="co"># Some nested list of heterogenous data objects..</span>
<span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="reference/quick-conversion.html">qM</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span>,                                   <span class="co"># Matrix</span>
          b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>c <span class="op">=</span> <span class="va">mtcars</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>,                             <span class="co"># data.frame</span>
                   d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>e <span class="op">=</span> <span class="va">mtcars</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,
                            f <span class="op">=</span> <span class="fu"><a href="reference/fvar,%20fsd.html">fsd</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>                   <span class="co"># Vector</span>

<span class="fu"><a href="reference/ldepth.html">ldepth</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span>                       <span class="co"># List has 4 levels of nesting (considering that mtcars is a data.frame)</span>
<span class="fu"><a href="reference/is_unlistable.html">is_unlistable</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span>                <span class="co"># Can be unlisted</span>
<span class="fu"><a href="reference/has_elem,%20get_elem.html">has_elem</a></span><span class="op">(</span><span class="va">l</span>, <span class="st">"f"</span><span class="op">)</span>                <span class="co"># Contains an element by the name of "f"</span>
<span class="fu"><a href="reference/has_elem,%20get_elem.html">has_elem</a></span><span class="op">(</span><span class="va">l</span>, <span class="va">is.matrix</span><span class="op">)</span>          <span class="co"># Contains a matrix</span>

<span class="fu"><a href="reference/has_elem,%20get_elem.html">get_elem</a></span><span class="op">(</span><span class="va">l</span>, <span class="st">"f"</span><span class="op">)</span>                <span class="co"># Recursive extraction of elements..</span>
<span class="fu"><a href="reference/has_elem,%20get_elem.html">get_elem</a></span><span class="op">(</span><span class="va">l</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>,<span class="st">"f"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/has_elem,%20get_elem.html">get_elem</a></span><span class="op">(</span><span class="va">l</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>,<span class="st">"f"</span><span class="op">)</span>, keep.tree <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="reference/unlist2d.html">unlist2d</a></span><span class="op">(</span><span class="va">l</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># Intelligent recursive row-binding to data.frame   </span>
<span class="fu"><a href="reference/rapply2d.html">rapply2d</a></span><span class="op">(</span><span class="va">l</span>, <span class="va">fmean</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">unlist2d</span> <span class="co"># Taking the mean of all elements and repeating</span>

<span class="co"># Application: extracting and tidying results from (potentially nested) lists of model objects</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mod1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">carb</span>, <span class="va">mtcars</span><span class="op">)</span>,
     mod2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">carb</span> <span class="op">+</span> <span class="va">hp</span>, <span class="va">mtcars</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">summary</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/has_elem,%20get_elem.html">get_elem</a></span><span class="op">(</span><span class="st">"coef"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># Regular expression search and extraction</span>
  <span class="fu"><a href="reference/unlist2d.html">unlist2d</a></span><span class="op">(</span>idcols <span class="op">=</span> <span class="st">"Model"</span>, row.names <span class="op">=</span> <span class="st">"Predictor"</span><span class="op">)</span>

<span class="co">## Summary Statistics -------------------------------------------------------------------------------------------</span>

<span class="va">irisNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/small-helper.html">na_insert</a></span><span class="op">(</span><span class="va">iris</span>, prop <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>  <span class="co"># Randmonly set 15% missing</span>
<span class="fu"><a href="reference/fnobs.html">fnobs</a></span><span class="op">(</span><span class="va">irisNA</span><span class="op">)</span>                           <span class="co"># Observation count</span>
<span class="fu"><a href="reference/pwcor,%20pwcov,%20pwnobs.html">pwnobs</a></span><span class="op">(</span><span class="va">irisNA</span><span class="op">)</span>                          <span class="co"># Pairwise observation count</span>
<span class="fu"><a href="reference/fnobs.html">fnobs</a></span><span class="op">(</span><span class="va">irisNA</span>, <span class="va">g</span><span class="op">)</span>                        <span class="co"># Grouped observation count</span>
<span class="fu"><a href="reference/fndistinct.html">fndistinct</a></span><span class="op">(</span><span class="va">irisNA</span><span class="op">)</span>                      <span class="co"># Same with distinct values... (default na.rm = TRUE skips NA's)</span>
<span class="fu"><a href="reference/fndistinct.html">fndistinct</a></span><span class="op">(</span><span class="va">irisNA</span>, <span class="va">g</span><span class="op">)</span>

<span class="fu"><a href="reference/descr.html">descr</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>                                   <span class="co"># Detailed statistical description of data</span>

<span class="fu"><a href="reference/varying.html">varying</a></span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span><span class="op">)</span>                      <span class="co"># Show which variables vary within Species</span>
<span class="fu"><a href="reference/varying.html">varying</a></span><span class="op">(</span><span class="va">pdata</span><span class="op">)</span>                                <span class="co"># Which are time-varying ? </span>
<span class="fu"><a href="reference/qsu.html">qsu</a></span><span class="op">(</span><span class="va">iris</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">w</span><span class="op">)</span>                            <span class="co"># Fast (one-pass) summary (with weights)</span>
<span class="fu"><a href="reference/qsu.html">qsu</a></span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">w</span>, higher <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># Grouped summary + higher moments</span>
<span class="fu"><a href="reference/qsu.html">qsu</a></span><span class="op">(</span><span class="va">pdata</span>, higher <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>                     <span class="co"># Panel-data summary (between and within entities)</span>
<span class="fu"><a href="reference/pwcor,%20pwcov,%20pwnobs.html">pwcor</a></span><span class="op">(</span><span class="fu"><a href="reference/fselect,%20get_vars,%20add_vars.html">num_vars</a></span><span class="op">(</span><span class="va">irisNA</span><span class="op">)</span>, N <span class="op">=</span> <span class="cn">TRUE</span>, P <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># Pairwise correlations with p-value and observations</span>
<span class="fu"><a href="reference/pwcor,%20pwcov,%20pwnobs.html">pwcor</a></span><span class="op">(</span><span class="fu"><a href="reference/fbetween,%20fwithin.html">W</a></span><span class="op">(</span><span class="va">pdata</span>, keep.ids <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, P <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># Within-correlations</span></pre></div>
</details><p>
</p>
<p>Evaluated and more extensive sets of examples are provided on the <a href="https://sebkrantz.github.io/collapse/reference/collapse-package.html">package page</a> (also accessible from R by calling <code><a href="https://rdrr.io/r/utils/example.html">example('collapse-package')</a></code>), and further in the <a href="https://sebkrantz.github.io/collapse/articles/index.html">vignettes</a> and <a href="https://sebkrantz.github.io/collapse/reference/index.html">documentation</a>.</p>
</div>
<div id="additional-notes" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-notes" class="anchor"></a>Additional Notes</h2>
<div id="regarding-performance" class="section level3">
<h3 class="hasAnchor">
<a href="#regarding-performance" class="anchor"></a>Regarding Performance</h3>
<p>Some simple benchmarks against <em>dplyr</em>, <em>data.table</em> and <em>plm</em> are provided in <a href="https://sebkrantz.github.io/Rblog/2020/08/31/welcome-to-collapse/">this</a> blog post and in the <a href="https://sebkrantz.github.io/collapse/articles/index.html">vignettes</a>. In general:</p>
<!-- using functions that *data.table* also GeForce optimizes, -->
<ul>
<li><p>For simple aggregations of large data (~ 10 mio. obs) the performance is comparable to <em>data.table</em> (e.g. see <a href="https://sebkrantz.github.io/collapse/reference/fast-statistical-functions.html#benchmark">here</a> and <a href="https://sebkrantz.github.io/Rblog/2020/08/31/welcome-to-collapse/">here</a>)^[Collapse has quite efficient algorithms but no low-level parallelism. Thus huge aggregations with simple functions like <code>mean</code> or <code>sum</code> and meaningful parallel processing power are faster on <em>data.table</em>, whereas <em>collapse</em> can still be faster on 2-core machines.].</p></li>
<li><p>For more complex categorical or weighed aggregations and for data transformations, <em>collapse</em> can be ~10x faster than <em>data.table</em>. Notable are very fast algorithms for (grouped) statistical mode and distinct value counts, variance, various weighted statistics, scaling, centering, panel-lags, differences and growth rates.</p></li>
<li><p>Due to its highly optimized R code, <em>collapse</em> is very efficient for programming. On smaller data a <em>collapse</em> implementation will execute within microseconds, whereas packages like <em>dplyr</em> or <em>data.table</em> will typically evaluate in the millisecond domain (up to ~100x slower).</p></li>
<li><p>This performance extends to grouped and weighted computations on vectors and matrices (<em>collapse</em> provides separate vector, matrix and data.frame methods written in C++, the performance in matrix computations is comparable to <em>Rfast</em> and <em>matrixStats</em>).</p></li>
</ul>
</div>
<div id="regarding-the-integration-with-dplyr-plm-datatable-sf-and-other-classes" class="section level3">
<h3 class="hasAnchor">
<a href="#regarding-the-integration-with-dplyr-plm-datatable-sf-and-other-classes" class="anchor"></a>Regarding the Integration with <em>dplyr</em>, <em>plm</em>, <em>data.table</em>, <em>sf</em> and Other Classes</h3>
<ul>
<li>
<strong><em>collapse</em></strong> <strong>and</strong> <strong><em>dplyr</em></strong>: The <a href="https://sebkrantz.github.io/collapse/reference/fast-statistical-functions.html">Fast Statistical Functions</a> and <a href="https://sebkrantz.github.io/collapse/reference/data-transformations.html">transformation functions and operators</a> provided by <em>collapse</em> have a <em>grouped_df</em> method, allowing them to be seamlessly integrated into <em>dplyr</em> / <em>tidyverse</em> workflows. Doing so facilitates advanced operations in <em>dplyr</em> and provides remarkable performance improvements. In addition, <em>collapse</em> provides some faster replacements for common base R / <em>dplyr</em> verbs (<code>fselect</code>/<code>get_vars</code>, <code>fgroup_by</code>, <code>fsubset</code>, <code>ftransform</code>/<code>TRA</code>, <code>fsummarise</code>, <code>roworder</code>, <code>colorder</code>, <code>frename</code>, <code>funique</code>, <code>na_omit</code>, etc.). See also <a href="https://sebkrantz.github.io/collapse/articles/collapse_and_dplyr.html">this vignette</a>.</li>
</ul>
<!--
, providing further performance improvements for programming with piped expressions and non-standard evaluation
(bringing *dplyr* close to *data.table* on large data aggregations, and making it faster than *data.table* for advanced transformations) --><ul>
<li>
<strong><em>collapse</em></strong> <strong>and</strong> <strong><em>plm</em></strong>: The fast <a href="https://sebkrantz.github.io/collapse/reference/data-transformations.html">transformation functions and operators</a> provided by <em>collapse</em> also have <em>pseries</em> (panel-series) and <em>pdata.frame</em> (panel-data.frame) methods. This integrates them seamlessly into <em>plm</em> workflows and facilitates the manipulation of panel data. For typical panel data operations like between- and within-transformations or panel lags / leads / differences, <em>collapse</em> functions are 20-100x faster than <em>plm</em> equivalents, and provide greater versatility. See also <a href="https://sebkrantz.github.io/collapse/articles/collapse_and_plm.html">this vignette</a>.</li>
</ul>
<!-- (e.g. for applying transformations to multiple variables in a *pdata.frame*) --><ul>
<li><p><strong><em>collapse</em></strong> <strong>and</strong> <strong><em>data.table</em></strong>: All collapse functions can be applied to <em>data.table</em>’s and they will also return a <em>data.table</em> again. The C/C++ programming of <em>collapse</em> was inspired by <em>data.table</em> and directly relies on some <em>data.table</em> C source code (e.g. for grouping and row-binding). The function <code>qDT</code> efficiently converts various R objects to <em>data.table</em>, and several functions (<code>mrtl</code>, <code>mctl</code>, <code>unlist2d</code>, …) have an option to return a <em>data.table</em>. See also <a href="https://sebkrantz.github.io/collapse/articles/collapse_and_data.table.html">this vignette</a>.</p></li>
<li><p><strong><em>collapse</em></strong> <strong>and</strong> <strong><em>sf</em></strong>: <em>collapse</em> now directly supports <em>sf</em> data frames through functions like <code>fselect</code>, <code>fsubset</code>, <code>num_vars</code>, <code>qsu</code>, <code>descr</code>, <code>varying</code>, <code>funique</code>, <code>roworder</code>, <code>rsplit</code>, <code>fcompute</code> etc., which will take along the geometry column even if it is not explicitly selected (mirroring <em>dplyr</em> methods for <em>sf</em> data frames). See also <a href="https://sebkrantz.github.io/collapse/articles/collapse_and_sf.html">this vignette</a>.</p></li>
<li><p><strong>Time series and other classes</strong>: Besides explicit support for <em>dplyr</em> / <em>tibble</em>, <em>data.table</em> and <em>plm</em> panel data classes, <em>collapse</em>’s statistical and transformation functions are S3 generic, with ‘default’, ‘matrix’ and ‘data.frame’ methods which dispatch on the implicit data type. Furthermore, these methods intelligently preserve the attributes of the objects passed. Therefore <em>collapse</em> can handle many other matrix or data frame based classes, including <em>ts</em>, <em>xts</em> / <em>zoo</em>, <em>timeSeries</em>, <em>tsibble</em> and <em>tibbletime</em>. Compatibility is of course limited if manipulating a classed object requires further actions besides preservation of the attributes under modification of ‘names’, ‘dim’, ‘dimnames’ and ‘row.names’.</p></li>
</ul>
<!--

fndistinct(wlddev)
fndistinct(wlddev, wlddev$iso3c)

wlddev %>% fgroup_by(iso3c) %>% fndistinct

collap(wlddev, ~ country + decade, fmean, fmode)

fscale(num_vars(wlddev), wlddec$iso3c)
fwithin(num_vars(wlddev), wlddec$iso3c)

wlddev %>% fgroup_by(country, decade) %>% fselect(PCGDP:ODA) %>% fwithin(ODA)

L(wlddev, -1:1, ~iso3c, ~year, cols = 9:12)

wlddev %>% fgroup_by(country) %>% fselect(PCGDP:ODA, year) %>% flag(-1:1, year)

wlddev %>% fgroup_by(country) %>% fselect(PCGDP:ODA, year) %>% fdiff(-1:1, 1:2, year)
wlddev %>% fgroup_by(country) %>% fselect(PCGDP:ODA, year) %>% fgrowth(1, 1, year)
--><!--
## Contributing
If you want to contribute, please fork and create a pull request for merging with the **development** branch. Presently I am particularly interested in fast algorithms to compute weighted medians and (weighted) quantiles.


settransform(Species.AWMSL = finteraction(Species, AWMSL))



<!-- *collapse* is not limited to programming with data.frames and it is class-secure and attribute-preserving (thus it can be applied to data.table's, tibbles, grouped tibbles etc. and also to special atomic objects like time-series and time-series matrices etc.). -->
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=collapse">https://​cloud.r-project.org/​package=collapse</a>
</li>
<li>Browse source code at <br><a href="https://github.com/SebKrantz/collapse/">https://​github.com/​SebKrantz/​collapse/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/SebKrantz/collapse/issues">https://​github.com/​SebKrantz/​collapse/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2) | file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sebastian Krantz <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=collapse"><img src="https://www.r-pkg.org/badges/version/collapse" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/web/checks/check_results_collapse.html"><img src="https://cranchecks.info/badges/worst/collapse" alt="cran checks"></a></li>
<li><a href="https://github.com/SebKrantz/collapse/actions"><img src="https://github.com/SebKrantz/collapse/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/SebKrantz/collapse?branch=master"><img src="https://codecov.io/gh/SebKrantz/collapse/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://cran.r-project.org/"><img src="https://img.shields.io/badge/R%3E%3D-2.10-6666ff.svg" alt="minimal R version"></a></li>
<li><a href="https://CRAN.R-project.org/package=collapse"><img src="https://tinyverse.netlify.com/badge/collapse" alt="status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="lifecycle"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>




  </body>
</html>
