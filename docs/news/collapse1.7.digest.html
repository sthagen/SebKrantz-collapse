<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><link rel="shortcut icon" href="https://sebkrantz.github.io/collapse/favicon.ico" type="image/x-icon">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Changelog • collapse</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-news">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" class="external-link">Blog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/collapse_R" class="external-link">
    <span class="fa fa-twitter"></span>

  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">

    <br>

<div id="collapse-1.7-news-digest" class="section level1">
<h1><em>collapse</em> 1.7 News Digest</h1>
<div id="c-level-development" class="section level2">
<h2>C-Level Development</h2>
<ul>
<li><p>Multiple assignment <code>massign()</code>, and operator <code>%=%</code>: <code>c(&quot;T&quot;, &quot;K&quot;) %=% dim(EuStockMarkets)</code> or <code>.c(T, K) %=% dim(EuStockMarkets)</code>, also <code>names(iris) %=% iris</code> etc.. Supports all vector types.</p></li>
<li><p>Mathematical operations by reference <code>setop()</code> and operators <code>%+=%</code>, <code>%-=%</code>, <code>%*=%</code>, <code>%/=%</code>, supporting vectors, matrices and data frames / lists. Operators work column-wise (like R’s math): <code>mtcars %+=% mtcars</code>, <code>num_vars(iris) %/=% iris$Sepal.Length</code>, <code>Titanic %/=% sum(Titanic) * 100</code>. <code>setop()</code> also supports <code>rowwise</code> operations: <code>setop(EuStockMarkets, &quot;-&quot;, fmean(EuStockMarkets), rowwise = TRUE)</code> (centering by reference).</p></li>
<li><p>Efficient comparisons of vectors with single values: <code>whichv</code> ( + operators <code>%==%</code> and <code>%!=%</code> and <code>whichNA</code>), <code>anyv</code>, <code>allv</code> (and <code>allNA</code>). Like <code>whichv</code>, <code>%==%</code> and <code>%!=%</code> return indices and are significantly faster than <code>==</code>, e.g. benchmark <code>fsubset(data, col %==% value)</code> against <code>fsubset(data, col == value)</code>. Can also use inside <em>data.table</em>.</p></li>
<li><p>Efficient replacement and copying of values in atomic objects and data frames (complementing <code>data.table::set</code>): <code>setv(mtcars, 0, 2)</code> (replace 0 with 2 everywhere), <code>setv(mtcars$carb, mtcars$cyl %==% 4, mtcars$mpg)</code> (same as <code>qDT(mtcars)[cyl == 4, carb := mpg]</code>, but no need for a <em>data.table</em>), <code>setv(mtcars[5:8], mtcars$cyl %==% 4, df[6:9])</code> (copy rows from equally sized data frames, here just shifting them by one column), etc. There is also <code>copyv</code> to do all this with a deep copy. These functions also benefit <code>replace_NA</code> and friends, which now have an additional <code>set</code> argument.</p></li>
<li><p><code>group()</code> provides access to a new multivariate first-appearance-order grouping algorithm (thanks to Morgan Jacob from the great <em>kit</em> package for providing the hash function). The algorithm now feeds into the package through multiple central functions (including <code>GRP</code> / <code>fgroup_by</code>, <code>collap</code>, <code>funique</code> and <code>qF</code>) when invoked with argument <code>sort = FALSE</code>. More benchmarks need to be run, but in my experience more often than not the gain in grouping performance is striking.</p></li>
<li><p><code>gsplit()</code> very efficiently splits vectors based on <em>collapse</em> grouping objects. It is used as a new backend to <code>rsplit</code> as well as <code>BY</code>, <code>collap</code>, <code>fsummarise</code> and <code>fmutate</code>. Overall this means that, assuming serial execution e.g. on M1 Mac, <em>collapse</em> is competitive with <code>dplyr</code> in operations using base R / user-defined functions (possibly even with <em>data.table</em>, but haven’t explored much), competitive with <em>data.table</em> for aggregations and transformations with the <em>Fast Statistical Functions</em>, and remains fastest for weighted aggregation, computations with panel data and other specialized things.</p></li>
<li><p><code>vlabel(&lt;-)</code> was re-written in C, and user level functions <code>relabel</code> and <code>setrelabel</code> were added, providing consistent and fast support for dealing with variable labels (and further attributes to be distributed across data frame columns) in R. Functions <code>setLabels</code>, <code>namlab</code>, <code>descr</code> and <code>qsu</code> also benefit from this for retrieval of variable labels.</p></li>
<li><p>Functions <code>vlengths()</code> added as faster replacement for <code>lengths</code>, and function <code>vtypes</code> was also rewritten in C. The latter benefits column selection by data type using <code>num_vars</code>, <code>char_vars</code>, <code>fact_vars</code> etc. which is now fully C-based and super fast, especially for high-dimensional data.</p></li>
<li><p><code>qsu</code> has an argument <code>stable.algo = FALSE</code> which gives 2x performance improvement for big data (sacrificing numeric accurancy of the standard deviation, but I use long doubles in C++ to still maximize numeric precision).</p></li>
<li><p>More efficient attribute handling in many functions (using shallow copies only). This also benefits the user-level functions <code>setAttrib</code>, <code>copyAttrib</code> and <code>copyMostAttrib</code>, which now take a shallow copy of lists and also a shallow copy of the attributes list.</p></li>
<li><p><code>setrename</code> now truly renames objects by reference (without creating a shallow copy, except for <em>data.tables</em> where the external pointer needs to be renewed).</p></li>
<li><p><code>na_rm</code> can now also efficiently remove empty or <code>NULL</code> elements from a list.</p></li>
<li><p>Added option <code>ties = &quot;last&quot;</code> to <code>fmode</code>.</p></li>
</ul>
</div>
<div id="r-level-development" class="section level2">
<h2>R-Level Development</h2>
<ul>
<li><p>Fully fledged <code>fmutate</code> function that provides functionality analogous to <code>dplyr::mutate</code> (sequential evaluation of arguments, including arbitrary tagged expressions and <code>across</code> statements). <code>fmutate</code> is optimized to work together with the packages <em>Fast Statistical and Data Transformation Functions</em>, yielding fast, vectorized execution, but also benefits from <code>gsplit</code> for other operations.</p></li>
<li><p><code>across()</code> function implemented for use inside <code>fsummarise</code> and <code>fmutate</code>. It is also optimized for <em>Fast Statistical and Data Transformation Functions</em>, but performs well with other functions too. It has an additional arguments <code>.apply = FALSE</code> which will apply functions to the entire subset of the data instead of individual columns, and thus allows for nesting tibbles and estimating models or correlation matrices by groups etc.. <code>across()</code> also supports an arbitrary number of additional arguments which are split and evaluated by groups if necessary. Multiple <code>across()</code> statements can be combined with tagged vector expressions in a single call to <code>fsummarise</code> or <code>fmutate</code>.</p></li>
<li><p><code>fsummarise</code> is now also fully featured supporting evaluation of arbitrary expressions and <code>across()</code> statements.</p></li>
<li><p>Added option <code>options(&quot;collapse_mask&quot;)</code>, which can be set before loading the package to export copies of selected (or all) functions in the package that start with <code>f</code> removing the leading <code>f</code> e.g. <code>options(collapse_mask = &quot;fsubset&quot;)</code> means both <code>fsubset</code> and <code>subset</code> will be exported. This allows masking base R and <em>dplyr</em> functions (even basic functions such as <code>sum</code>, <code>mean</code>, <code>unique</code> etc. can be masked by <em>collapse</em> fast functions if desired). There are some shorthands e.g. <code>options(collapse_mask = &quot;manip&quot;)</code> exports copies of all data manipulation functions, allowing translation of <em>dplyr</em> codes without much change of syntax, i.e. you can write <code>data %&gt;% group_by(col) %&gt;% summarise(...)</code> instead of <code>data %&gt;% fgroup_by(col) %&gt;% fsummarise(...)</code>. Masking basic statistical functions such as <code>options(collapse_mask = &quot;all&quot;)</code> (mask everything) will also modify internal macros so that <code>sum</code>, <code>mean</code> etc. receive vectorized executions inside data manipulation functions.</p></li>
<li><p><code>fgroup_by</code> is more flexible, supporting computing columns e.g. <code>fgroup_by(GGDC10S, Variable, Decade = floor(Year / 10) * 10)</code> and various programming options e.g. <code>fgroup_by(GGDC10S, 1:3)</code>, <code>fgroup_by(GGDC10S, c(&quot;Variable&quot;, &quot;Country&quot;))</code>, or <code>fgroup_by(GGDC10S, is.character)</code>. You can also use column sequences e.g. <code>fgroup_by(GGDC10S, Country:Variable, Year)</code>, but this should not be mixed with computing columns. Compute expressions may also not include the <code>:</code> function.</p></li>
<li><p>In <code>ftransformv/settransformv</code> and <code>fcomputev</code>, the <code>vars</code> argument is also evaluated inside the data frame environment, allowing NSE specifications using column names e.g. <code>ftransformv(data, c(col1, col2:coln), FUN)</code>.</p></li>
<li><p>Function <code>ss</code> supports both empty <code>i</code> or <code>j</code>.</p></li>
<li><p>The printout of <code>fgroup_by</code> also shows minimum and maximum group size for unbalanced groupings.</p></li>
<li><p><code>qF</code> with option <code>sort = FALSE</code> now generates factors with levels in first-appearance order (instead of a random order assigned by the hash function), and can also be called on an existing factor to recast the levels in first-appearance order. It is also faster with <code>sort = FALSE</code> (thanks to <code>group</code>).</p></li>
<li><p><code>colorder</code> can rename columns on the fly and also has a new mode <code>pos = &quot;after&quot;</code> to place all selected columns after the first selected one, e.g.: <code>colorder(mtcars, cyl, vs_new = vs, am, pos = &quot;after&quot;)</code>. The <code>pos = &quot;after&quot;</code> option was also added to <code>roworderv</code>.</p></li>
<li><p><code>add_stub</code> and <code>rm_stub</code> have an additional <code>cols</code> argument to apply a stub to certain columns only e.g. <code>add_stub(mtcars, &quot;new_&quot;, cols = 6:9)</code>.</p></li>
<li><p><code>namlab</code> has additional arguments <code>N</code> and <code>Ndistinct</code>, allowing to display number of observations and distinct values next to variable names, labels and classes, to get a nice and quick overview of the variables in a large dataset.</p></li>
<li><p>The print methods of <code>pwcor</code> and <code>pwcov</code> now have a <code>return</code> argument, allowing users to obtain the formatted correlation matrix, for exporting purposes.</p></li>
<li><p>Some improvements to the <code>BY</code> function, both in terms of performance and security.</p></li>
<li><p>
  Internally adjusted quite some functions e.g. <code>fwithin</code> etc. to take advantage of the faster grouping by <code>group</code>, wherever ordered grouping is not required.
</p></li>
</ul>
</div>
</div>


</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>






  </body></html>

